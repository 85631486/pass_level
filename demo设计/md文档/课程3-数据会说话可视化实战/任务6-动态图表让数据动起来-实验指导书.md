# 任务6：动态图表——让数据动起来

## 📌 学习目标

通过本任务的学习，你将能够：

1. **知识目标**
   - 理解动态图表的概念和价值
   - 掌握数据验证和切片器的使用
   - 了解OFFSET、INDEX等动态数据函数

2. **技能目标**
   - 能够使用下拉菜单创建可切换的图表
   - 能够使用切片器实现数据筛选
   - 能够向AI学习动态图表的实现方法
   - 能够制作简单的交互式仪表板

3. **素养目标**
   - 培养交互设计思维
   - 建立用户体验意识
   - 形成灵活展示数据的能力

---

## ⏰ 任务时间

- **总时长**：2学时（90分钟）
- **建议分配**：
  - 课程导入与方法讲解：50分钟
  - 实践操作：30分钟
  - 总结与作业布置：10分钟

---

## 🛠️ 准备工作

### 必备工具
- [ ] Excel 2013及以上版本（支持切片器）
- [ ] AI助手账号（ChatGPT/文心一言/通义千问，至少一个）

### 📁 数据文件
**重要：本任务需要数据文件！**

如果老师提供了数据文件，请使用：`任务6-多月份销售数据.csv`

---

## 📋 操作步骤

### 步骤一：动态图表演示（10分钟）

#### 1.1 传统图表的局限

**展示场景：**
```
数据：12个月，5个产品的销售数据
传统做法：做12个图表，每个月一个
问题：占用空间，不便对比
```

#### 1.2 动态图表演示

**展示效果：**
```
一个图表+一个下拉菜单
选择月份：1月、2月、...12月
图表自动更新显示对应月份数据
```

**优势：**
- 节省空间
- 便于对比不同时期
- 用户自主探索数据
- 专业、现代

#### 1.3 学习目标

今天要学会：
- 方法1：下拉菜单+动态图表
- 方法2：切片器+图表筛选
- 方法3（进阶）：动态数据源函数

---

### 步骤二：方法1——下拉菜单+VLOOKUP（25分钟）

#### 2.1 数据准备

**数据结构：**
```
产品    1月  2月  3月  ...  12月
产品A   100  120  110  ...  150
产品B   80   85   90   ...  100
产品C   120  130  125  ...  140
```

**辅助数据区：**
```
选择月份：[下拉菜单]

产品    销售额
产品A   [公式]
产品B   [公式]
产品C   [公式]
```

#### 2.2 创建下拉菜单

**操作步骤：**

**步骤1：创建月份列表**
```
在空白区域列出：
1月
2月
...
12月
```

**步骤2：创建下拉菜单**
```
选中目标单元格（如E2）
数据 → 数据验证 → 验证条件：序列
来源：选择月份列表区域
确定
```

**结果：**
单元格E2显示下拉箭头，可选择月份

#### 2.3 使用公式关联数据

**方法1：VLOOKUP（适合新手）**

```
在辅助数据区"销售额"列：
=VLOOKUP($A行,数据区域,MATCH($E$2,月份行,0),0)

解释：
- MATCH找到选中月份在哪一列
- VLOOKUP根据产品名和列号查找数据
```

**方法2：INDEX+MATCH（更灵活）**

```
=INDEX(数据区域,MATCH(产品名,产品列,0),MATCH($E$2,月份行,0))
```

**学生实践：**
```
任务：设置公式，实现下拉菜单切换时数据自动更新
检查：切换月份，数据是否变化？
```

#### 2.4 创建图表

```
选中辅助数据区（产品名+销售额）
插入 → 柱状图
```

**测试：**
```
切换下拉菜单，图表自动更新！
```

---

### 步骤三：方法2——切片器（20分钟）

#### 3.1 什么是切片器？

**定义：**
- Excel 2013+的筛选工具
- 可视化按钮，点击筛选
- 比下拉菜单更直观

**演示效果：**
```
插入切片器后：
- 显示所有可选项（如12个月份）
- 点击按钮即可筛选
- 支持多选
```

#### 3.2 创建切片器

**前提：数据要整理成表格**

**步骤1：将数据转为表格**
```
选中数据区域
插入 → 表格
勾选"表包含标题"
确定
```

**数据变为带格式的表格，可以筛选**

**步骤2：插入切片器**
```
点击表格内任意单元格
表格工具 → 设计 → 插入切片器
勾选要筛选的字段（如"月份"、"产品类别"）
确定
```

**步骤3：关联图表**
```
创建数据透视表：
插入 → 数据透视表
行：产品
值：销售额
筛选：月份

基于数据透视表创建图表
切片器自动关联图表！
```

#### 3.3 优化切片器

**格式设置：**
```
右键切片器 → 切片器设置
- 列数：设为3（一行显示3个按钮）
- 按钮宽度和高度：调整大小
```

**样式美化：**
```
切片器工具 → 选项 → 切片器样式
选择喜欢的配色方案
```

**多个切片器协调：**
```
可以同时添加"月份"和"产品类别"两个切片器
实现多维筛选
```

---

### 步骤四：方法3（进阶）——动态数据源（20分钟）

#### 4.1 向AI提问学习

**提问：**
```
"Excel中OFFSET函数怎么用？如何创建动态数据源？"
```

**AI回答要点：**
- OFFSET返回相对引用的区域
- 配合下拉菜单实现动态范围
- 需要定义命名范围

#### 4.2 OFFSET函数讲解

**语法：**
```
=OFFSET(起点,向下移动行数,向右移动列数,高度,宽度)
```

**示例：**
```
数据：
A1: 产品A
A2: 产品B
A3: 产品C

B1: 1月销售额
C1: 2月销售额

需求：根据选择的月份，动态返回对应列

公式：
=OFFSET($A$1,0,MATCH($E$2,月份行,0),5,1)

解释：
- 从A1开始
- 向右移动MATCH结果的列数
- 返回5行1列的数据
```

#### 4.3 实际应用

**步骤：**
```
1. 公式 → 定义名称 → 名称：动态数据
2. 引用位置：=OFFSET公式
3. 图表数据源选择"动态数据"
4. 切换下拉菜单，图表自动更新
```

**注意：**
这是高级方法，学有余力的学生尝试。

---

### 步骤五：实践操作（12分钟）

#### 5.1 任务说明

**任务数据：**
```
5个销售员，12个月的业绩数据
```

**任务1：下拉菜单方式（6分钟）**
```
创建"选择销售员"下拉菜单
制作图表显示该销售员12个月业绩
```

**任务2：切片器方式（6分钟）**
```
将数据转为表格
添加"销售员"切片器
创建图表，实现点击切换
```

---

### 步骤六：总结与作业（3分钟）

#### 6.1 知识回顾

**核心要点：**
- 方法1：下拉菜单+公式
- 方法2：切片器（最直观）
- 方法3：动态函数（高级）

#### 6.2 作业布置

**提交物：**

**文件：动态图表作品**
- 方法1或方法2任选
- 实现可切换查看不同维度数据
- 文件命名：`学号_姓名_任务6_动态图表.xlsx`

**提交截止：** 下次上课前

**加分项：**
- 尝试OFFSET函数
- 添加多个切片器

---

## 📚 附录

### 常见问题FAQ

**Q1: 切片器和数据验证（下拉菜单）的区别？**
A: 切片器更直观，支持多选，但需要数据透视表或表格。下拉菜单更灵活，但一次只能选一个。

**Q2: 切片器为什么是灰色的？**
A: 可能是因为没有关联到表格或数据透视表。确保数据是"表格"格式。

**Q3: OFFSET函数太复杂，有替代方案吗？**
A: 可以用INDEX+MATCH组合，或直接用方法1（下拉菜单+VLOOKUP）。

**Q4: 动态图表能在PPT中使用吗？**
A: 复制到PPT后会失去交互性。建议截图或录制演示视频。

### Excel操作技巧

**删除切片器：**
```
选中切片器 → 按Delete键
```

**清除切片器筛选：**
```
点击切片器右上角的"清除筛选"按钮
```

**一个切片器控制多个图表：**
```
右键切片器 → 报表连接 → 勾选要控制的数据透视表
```

**动态图表调试：**
```
如果图表不更新，检查：
1. 公式是否正确
2. 单元格引用是否绝对引用（$）
3. 图表数据源是否指向公式区域
```

### AI提问模板

```
"Excel中OFFSET函数怎么用？如何创建动态数据源？"
"切片器和数据验证的区别是什么？"
"Excel怎么做交互式图表？"
```

---

**祝你学习愉快！** 🎉


