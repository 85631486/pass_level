# 任务4：折线图讲好时间的故事

## 📌 学习目标

通过本任务的学习，你将能够：

1. **知识目标**
   - 理解折线图的特点和适用场景
   - 掌握折线图设计的关键原则
   - 了解面积图和折线图的关系

2. **技能目标**
   - 能够制作清晰的单线和多线折线图
   - 能够在折线图上标注关键事件
   - 能够优化折线图的视觉效果
   - 能够向AI提问学习折线图设计争议

3. **素养目标**
   - 培养用数据讲故事的能力
   - 建立时间序列数据的敏感度
   - 形成关注趋势而非个别数据点的思维

---

## ⏰ 任务时间

- **总时长**：2学时（90分钟）
- **建议分配**：
  - 课程导入与方法讲解：35分钟
  - 实践操作：40分钟
  - 总结与作业布置：15分钟

---

## 🛠️ 准备工作

### 必备工具
- [ ] Excel 2016及以上版本 或 WPS Office
- [ ] AI助手账号（ChatGPT/文心一言/通义千问，至少一个）

### 📁 数据文件
**重要：本任务需要数据文件！**

如果老师提供了数据文件，请使用：`任务4-时间序列数据.csv`

如果没有，可以使用以下示例数据：
```
月份,销售额(万元)
1月,85
2月,78
3月,92
4月,88
5月,95
6月,105
7月,110
8月,108
9月,115
10月,120
11月,118
12月,130
```

---

## 📋 操作步骤

### 步骤一：案例导入——用折线图讲故事（10分钟）

#### 1.1 优秀案例展示

**案例A：疫情感染曲线**
- 展示清晰的趋势
- 关键时间点有标注（如"封城"、"解封"）
- 易于理解疫情发展阶段

**案例B：股票走势图**
- 显示价格波动
- 标注重要事件（如"财报发布"、"政策出台"）
- 帮助投资者理解影响因素

**案例C：个人体重变化曲线**
- 记录减肥过程
- 标注"开始锻炼"、"节食"等节点
- 激励作用

**💭 思考：**
- 这些折线图讲述了什么故事？
- 如果去掉时间轴，这些图还有意义吗？

#### 1.2 对比引入

**对比展示：**

**场景：展示月度销售额**

**图表A：柱状图**
- 可以看出各月数值
- 但趋势不够明显

**图表B：折线图**
- 趋势一目了然
- 容易发现规律（如季节性波动）

**💡 核心观点：**
"折线图是展示时间序列数据的最佳选择！"

#### 1.3 学习目标

今天要学会：
- 制作专业的折线图
- 在折线图上标注关键信息
- 处理多条线的情况
- 用折线图讲出数据背后的故事

---

### 步骤二：AI提问环节——学习折线图设计（10分钟）

#### 2.1 教师示范提问

**示例提问：**
```
"折线图设计有什么注意事项？Y轴一定要从0开始吗？请给出专业建议。"
```

**AI回答示例：**
```
折线图设计注意事项：

1. Y轴起点：
   - 不一定要从0开始（这是折线图和柱状图的关键区别）
   - 如果变化幅度小，从0开始会压缩变化，看不清趋势
   - 但要确保不误导（不能夸大微小变化）

2. 数据点标记：
   - 数据点少（<20个）：显示数据点标记
   - 数据点多（>20个）：不显示标记，避免拥挤

3. 多条线：
   - 不超过5条
   - 使用明显不同的颜色和线型
   - 直接在线的末端标注，而非使用图例

4. 网格线：
   - 淡化或只保留横向网格线
   - 帮助读取数值但不干扰视觉
```

#### 2.2 学生实践提问

**任务：**
向AI提问以下问题（选2-3个）：
1. "折线图和散点图的区别是什么？"
2. "折线图怎么标注关键事件？"
3. "多条折线图怎么做才不混乱？"
4. "面积图和折线图有什么区别？"

#### 2.3 知识汇总

记录AI的回答，提炼关键要点。

---

### 步骤三：折线图设计原则讲解（25分钟）

#### 3.1 原则1：Y轴起点的争议

**核心问题：Y轴要不要从0开始？**

**柱状图 vs 折线图的区别：**

**柱状图：**
- 柱子长度代表数值
- 必须从0开始
- 否则会误导

**折线图：**
- 关注趋势和变化
- 不一定从0开始
- 重点是斜率（上升/下降）

**案例演示：**

**数据：月度销售额（万元）**
```
1月:95, 2月:98, 3月:102, 4月:106, 5月:103, 6月:109
```

**图表A：Y轴从0开始**
```
范围：0-120
效果：线几乎是平的，看不出变化
```

**图表B：Y轴从90开始**
```
范围：90-110
效果：趋势清晰，波动明显
```

**结论：**
- ✓ 变化幅度小（<20%）时，可以不从0开始
- ✓ 但要明确标注Y轴起点
- ✗ 不要刻意夸大微小变化误导观众

**如何判断？**
```
问：去掉Y轴后，观众能理解这是增长了100%还是10%吗？
如果不能，需要明确标注或调整Y轴范围
```

#### 3.2 原则2：数据点标记——看情况使用

**何时显示数据点？**

**显示标记：**
- ✓ 数据点少（<15个）
- ✓ 需要强调精确数值
- ✓ 数据不是连续测量（如每季度一次）

**不显示标记：**
- ✓ 数据点多（>20个）
- ✓ 强调趋势而非个别数值
- ✓ 数据密集，标记会重叠

**操作演示：**
```
添加标记：
图表 → 设计 → 更改图表类型 → 带数据标记的折线图

自定义标记：
选中线 → 设置数据系列格式 → 标记选项 → 选择形状和大小
```

#### 3.3 原则3：处理多条线——保持清晰

**挑战：多条线容易混乱**

**最佳实践：**

**a) 限制数量：不超过5条线**
- 太多线会"意大利面条化"
- 考虑分成多个图表

**b) 使用明显区分的颜色**
```
推荐配色：
线1：深蓝 #1F77B4
线2：橙色 #FF7F0E
线3：绿色 #2CA02C
线4：红色 #D62728
线5：紫色 #9467BD
```

**c) 直接标注，减少图例**
```
传统做法：使用图例
更好做法：在每条线的末端直接标注名称
```

**操作演示：**
```
方法1：手动添加文本框
步骤：插入 → 文本框 → 放置在线的末端 → 输入标签

方法2：使用数据标签
选中线 → 添加数据标签 → 仅显示最后一个点的标签 → 标注系列名称
```

**d) 突出主线，淡化对比线**
```
主线：粗、鲜艳颜色
对比线：细、灰色
```

#### 3.4 原则4：关键事件标注——讲出故事

**为什么要标注？**
- 解释趋势变化的原因
- 帮助观众理解背景
- 让图表更有故事性

**标注方法：**

**方法1：垂直线+文字**
```
在关键时间点画一条垂直线
添加文本说明事件
```

**操作：**
```
插入 → 形状 → 直线 → 垂直拖动
格式：虚线、浅色
添加文本框说明事件
```

**方法2：箭头指向+文字**
```
在关键数据点添加箭头和说明
```

**操作：**
```
插入 → 形状 → 箭头 → 指向关键点
添加文本框
```

**方法3：背景色块**
```
用浅色背景色块标注特殊时期
```

**操作：**
```
插入 → 形状 → 矩形 → 覆盖时间段
格式：浅色填充、无边框、置于底层
```

**案例演示：**
```
数据：2019-2024年销售额
标注：
- 2020年3月："疫情影响，销售下降"
- 2020年10月："线上转型，开始恢复"
- 2022年："创历史新高"
```

---

### 步骤四：实践操作——制作并优化折线图（20分钟）

#### 4.1 任务说明

**数据：某产品月度销售额（2023年全年）**

| 月份 | 销售额(万元) |
|------|------------|
| 1月 | 85 |
| 2月 | 78 |
| 3月 | 92 |
| 4月 | 88 |
| 5月 | 95 |
| 6月 | 105 |
| 7月 | 110 |
| 8月 | 108 |
| 9月 | 115 |
| 10月 | 120 |
| 11月 | 118 |
| 12月 | 130 |

**背景信息：**
- 3月：推出新品
- 6月：618促销
- 11月：双11促销

**任务：**
1. 制作基础折线图
2. 优化设计
3. 标注关键事件

#### 4.2 学生实践

**步骤1：创建基础折线图（2分钟）**
```
选中数据 → 插入 → 折线图 → 带数据标记的折线图
```

**步骤2：调整Y轴范围（2分钟）**
```
右键Y轴 → 设置坐标轴格式 → 边界
最小值：70（不从0开始）
最大值：140
主要刻度单位：10
```

**步骤3：简化图表（3分钟）**
```
- 淡化网格线（浅灰色）
- 删除图表边框
- 调整线条粗细（2磅）
- 选择合适的颜色（如深蓝）
```

**步骤4：标注关键事件（5分钟）**
```
标注1：3月
插入形状 → 直线（虚线） → 放置在3月位置
插入文本框 → "新品上市"

标注2：6月
箭头指向6月峰值 → "618促销"

标注3：11月
背景色块 → 覆盖11-12月 → "年底促销季"
```

**步骤5：完善标题（3分钟）**
```
标题：从描述性改为洞察性
❌ "2023年月度销售额"
✓ "销售额稳步上升，新品和促销效果显著"
```

---

### 步骤五：面积图介绍（10分钟）

#### 5.1 面积图是什么？

**定义：**
- 折线图的变体
- 折线下方填充颜色

**何时使用面积图？**
- 强调数量的累积
- 展示"总量"感觉
- 数据都是正值

**演示制作：**
```
方法1：插入 → 图表 → 面积图
方法2：已有折线图 → 更改图表类型 → 面积图
```

#### 5.2 堆叠面积图

**用途：展示多个组成部分随时间的变化**

**案例：展示三个产品线的销售额**

**操作演示：**
```
数据：
月份  产品A  产品B  产品C
1月    50     30     20
2月    55     32     22
...

插入 → 面积图 → 堆叠面积图
```

**注意事项：**
- 最重要的放最下面（容易读取）
- 颜色要有明显区分
- 不超过4-5个层

#### 5.3 折线图vs面积图选择

**对比：**

| 特点 | 折线图 | 面积图 |
|------|--------|--------|
| 强调 | 趋势变化 | 数量累积 |
| 适用 | 任何时间序列 | 正值数据 |
| 视觉 | 轻盈、清晰 | 厚重、强调量感 |
| 多线 | 容易重叠但仍清晰 | 用堆叠面积图 |

**选择建议：**
- 默认用折线图（更清晰）
- 需要强调"量"时用面积图
- 需要展示构成时用堆叠面积图

---

### 步骤六：向AI学习高级技巧（8分钟）

#### 6.1 学生提问环节

**建议提问：**
1. "Excel怎么在折线图上添加平均线或趋势线？"
2. "折线图怎么处理缺失数据点？"
3. "怎么做双Y轴折线图？（左右Y轴不同量级）"
4. "Excel能做交互式折线图吗？"

#### 6.2 教师演示

**快速演示一个高级技巧：添加趋势线**

```
选中折线 → 添加图表元素 → 趋势线 → 线性
勾选：显示公式、显示R²值
```

**用途：**
- 显示整体趋势
- 预测未来走势
- 判断相关性强度

---

### 步骤七：总结与作业布置（7分钟）

#### 7.1 知识回顾

**折线图四大原则：**
1. Y轴可以不从0开始（但不能误导）
2. 根据数据点数量决定是否显示标记
3. 多线图保持清晰（颜色、标注、限制数量）
4. 标注关键事件讲出故事

**折线图 vs 其他图表：**
- vs 柱状图：折线图强调趋势，柱状图强调对比
- vs 散点图：折线图有时间顺序，散点图没有
- vs 面积图：面积图强调量的累积

#### 7.2 课堂练习

**快速测验：**

**问题1：这个数据适合用折线图吗？**
```
数据：五个城市的人口数量
答案：❌ 不适合（没有时间序列，用柱状图）
```

**问题2：这个Y轴设置合适吗？**
```
数据范围：98-102分
Y轴范围：0-100分
答案：❌ 不合适（变化被压缩，看不出差异）
```

#### 7.3 作业布置

**提交物：**

**文件1：单线折线图+标注**
- 用提供的数据制作优化后的折线图
- 标注至少2个关键事件
- 使用洞察性标题
- 文件命名：`学号_姓名_任务4_折线图.xlsx`

**文件2：多线折线图**
- 用提供的多产品数据制作多线图
- 应用颜色区分和直接标注
- 文件命名：`学号_姓名_任务4_多线图.xlsx`

**提交截止：** 下次上课前

**加分项：**
- 制作一个堆叠面积图
- 向AI学习并添加趋势线
- 用自己的真实数据（如体重、支出等）制作折线图

---

## 📚 附录

### 常见问题FAQ

**Q1: 折线图的线一定要连起来吗？**
A: 是的，折线图用于时间序列或连续数据。如果数据点之间没有连续关系（如不同城市的数据），应该用散点图或柱状图，不应该连线。

**Q2: 数据有缺失值怎么办？**
A: Excel默认会跳过缺失值，导致线段断开。可以：
   - 方法1：保持断开（诚实表达）
   - 方法2：用插值填补（但要标注）
   - 方法3：用NA()函数跳过

**Q3: 怎么做平滑曲线？**
A: 选中折线 → 设置数据系列格式 → 线条 → 勾选"平滑线"。但注意：平滑会失去部分细节，适合数据点多且波动大时。

**Q4: Y轴刻度太密集怎么办？**
A: 右键Y轴 → 设置坐标轴格式 → 刻度单位 → 增大数值（如从1改为5或10）。

**Q5: 折线图能展示负值吗？**
A: 可以！Y轴会自动调整包含负值。这是折线图相比面积图的优势之一。

### Excel操作技巧

**快速切换折线图样式：**
- 图表设计 → 快速布局 → 选择预设样式
- 或使用"图表样式"快速应用配色

**添加数据表格到图表下方：**
- 添加图表元素 → 数据表 → 勾选
- 用途：同时显示图形和精确数值

**锁定X轴位置：**
- 右键Y轴 → 设置坐标轴格式 → 横坐标轴交叉 → 指定数值
- 用途：让X轴始终在底部

**创建组合图表（折线+柱状）：**
- 更改图表类型 → 组合 → 选择每个系列的类型
- 用途：同时显示不同类型的数据

### 折线图设计Checklist

制作完成后检查：
- [ ] 数据是时间序列或连续变量吗？
- [ ] Y轴范围是否合理？（不误导）
- [ ] 是否需要数据点标记？
- [ ] 多条线是否容易区分？
- [ ] 是否标注了关键事件？
- [ ] 标题是否洞察性的？
- [ ] 网格线是否淡化？
- [ ] 整体是否简洁清晰？

### AI提问模板

```
"折线图设计有什么注意事项？Y轴一定要从0开始吗？"
"折线图怎么标注关键事件？"
"Excel怎么在折线图上添加趋势线？"
```

---

**祝你学习愉快！** 🎉


