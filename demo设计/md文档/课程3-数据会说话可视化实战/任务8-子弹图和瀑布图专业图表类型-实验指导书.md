# 任务8：子弹图和瀑布图——专业图表类型

## 📌 学习目标

通过本任务的学习，你将能够：

1. **知识目标**
   - 理解子弹图和瀑布图的概念及用途
   - 掌握这两种专业图表的应用场景
   - 了解商业分析中常用的高级图表类型

2. **技能目标**
   - 能够在Excel中制作子弹图
   - 能够使用Excel内置瀑布图功能
   - 能够向AI学习专业图表的制作方法
   - 能够选择合适的专业图表展示数据

3. **素养目标**
   - 培养专业化数据展示能力
   - 建立商业分析思维
   - 形成追求卓越的可视化标准

---

## ⏰ 任务时间

- **总时长**：2学时（90分钟）
- **建议分配**：
  - 课程导入与方法讲解：45分钟
  - 实践操作：35分钟
  - 总结与作业布置：10分钟

---

## 🛠️ 准备工作

### 必备工具
- [ ] Excel 2016及以上版本（内置瀑布图）
- [ ] AI助手账号（ChatGPT/文心一言/通义千问，至少一个）

### 📁 数据文件
**重要：本任务需要数据文件！**

如果老师提供了数据文件，请使用：`任务8-KPI数据.csv`、`任务8-财务增减数据.csv`

---

## 📋 操作步骤

### 步骤一：专业图表导入（10分钟）

#### 1.1 为什么需要专业图表？

**普通图表的局限：**
```
柱状图：适合对比，但难以同时显示目标和实际
折线图：适合趋势，但难以显示增减构成
```

**专业图表的价值：**
```
子弹图：同时显示实际、目标、优良中差区间
瀑布图：清楚展示从起点到终点的增减过程
```

#### 1.2 案例展示

**案例A：KPI仪表板中的子弹图**
```
销售目标：100万
实际完成：85万
优秀线：120万
及格线：80万

子弹图直观显示：未达目标，但超过及格线
```

**案例B：财务报表中的瀑布图**
```
年初余额：1000万
+收入：500万
-成本：-300万
-费用：-100万
年末余额：1100万

瀑布图清楚展示每个环节的贡献
```

#### 1.3 学习目标

今天要学会：
- 子弹图的制作和应用
- 瀑布图的制作和解读
- 何时使用这些专业图表

---

### 步骤二：AI提问环节（8分钟）

#### 2.1 教师示范提问

**示例提问：**
```
"什么是子弹图？Excel怎么做子弹图？有什么用途？"
```

**AI回答要点：**
- 子弹图（Bullet Chart）由Stephen Few设计
- 用于仪表板，替代仪表盘图表
- 显示实际值相对于目标和区间的位置
- Excel无内置，需要用堆叠条形图模拟

**示例提问：**
```
"瀑布图适合展示什么数据？有什么注意事项？"
```

**AI回答要点：**
- 适合展示增减变化过程
- 常用于财务分析、利润拆解
- Excel 2016+有内置瀑布图

#### 2.2 学生实践提问

**建议问题：**
1. "子弹图和进度条的区别？"
2. "瀑布图的数据怎么准备？"
3. "还有哪些专业的商业图表类型？"

#### 2.3 知识汇总

记录AI的回答，提炼关键要点。

---

### 步骤三：子弹图详解（35分钟）

#### 3.1 子弹图的构成

**组成要素：**
```
1. 背景色块：表示区间（差-中-良-优）
2. 目标线：垂直线，表示目标值
3. 实际值条：粗条形，表示实际完成值
4. 比较值条（可选）：细条形，如去年同期
```

**示例：**
```
销售额KPI：
差区间（0-60）：浅红色
中区间（60-80）：浅黄色
良区间（80-100）：浅绿色
优区间（100-120）：深绿色
目标线：100
实际值：85（橙色粗条）
```

**优势：**
- 比传统仪表盘图节省空间
- 信息密度高
- 易于对比多个指标

#### 3.2 制作方法讲解

**数据准备：**
```
KPI      差  中  良  优  目标  实际
销售额   60  20  20  20  100   85
```

**制作步骤：**

**步骤1：创建堆叠条形图**
```
选中"差-中-良-优"数据
插入 → 条形图 → 堆叠条形图
```

**步骤2：添加实际值系列**
```
选中图表 → 选择数据 → 添加系列
系列名称：实际值
系列值：85
```

**步骤3：调整实际值条的显示**
```
选中"实际值"系列 → 右键 → 设置数据系列格式
系列选项：
☑ 次坐标轴
绘图选项：
系列重叠：100%
间隙宽度：50%
```

**步骤4：添加目标线**
```
方法1：添加误差线（设置为固定值）
方法2：插入形状（垂直线）

推荐方法2：
插入 → 形状 → 直线
拖动到目标位置
格式：粗线、黑色
```

**步骤5：美化背景色块**
```
选中各区间系列，设置颜色：
差：浅红 #FFE6E6
中：浅黄 #FFF4E6
良：浅绿 #E6FFE6
优：深绿 #CCFFCC
```

**步骤6：美化实际值条**
```
颜色：深蓝或橙色
宽度：比背景条粗
```

**步骤7：去除图表垃圾**
```
- 删除网格线
- 删除Y轴（或淡化）
- 删除图例（用直接标注替代）
- 简化X轴
```

#### 3.3 学生实践

**任务数据：**
```
三个KPI：销售额、客户满意度、项目完成率
每个都有：差/中/良/优区间、目标、实际
```

**任务：**
1. 制作单个子弹图（销售额）
2. 制作3个子弹图对比
3. 优化美化

---

### 步骤四：瀑布图详解（30分钟）

#### 4.1 瀑布图的概念

**定义：**
- 也叫桥接图（Bridge Chart）
- 展示从初始值到最终值的逐步变化
- 每个条形代表增加或减少

**典型应用：**
```
财务分析：
年初现金 → +收入 → -成本 → -费用 → 年末现金

利润构成：
营收 → -成本 → -费用 → -税收 → 净利润
```

**视觉特点：**
```
起始值：柱子从0开始
增加：绿色↑浮动柱
减少：红色↓浮动柱
最终值：柱子从0开始（总计）
```

#### 4.2 Excel 2016+内置瀑布图

**数据准备：**
```
项目      金额
年初余额  1000
收入      500
成本      -300
费用      -150
年末余额  1050
```

**制作步骤：**

**步骤1：插入瀑布图**
```
选中数据
插入 → 图表 → 瀑布图
```

**步骤2：设置总计列**
```
右键"年初余额"柱子 → 设为总计
右键"年末余额"柱子 → 设为总计
```

**结果：**
```
年初余额：从0开始的蓝色柱子
收入：绿色上浮柱子
成本：红色下浮柱子
费用：红色下浮柱子
年末余额：从0开始的蓝色柱子
```

**步骤3：美化**
```
颜色设置：
- 增加：绿色
- 减少：红色
- 总计：蓝色

添加数据标签：显示每个柱子的数值
添加连接线：辅助理解增减过程
```

#### 4.3 瀑布图的变体

**水平瀑布图：**
```
适合类别名称较长的情况
旋转90度
```

**分组瀑布图：**
```
展示多个产品线的贡献
每个产品线有自己的增减
```

#### 4.4 学生实践

**任务数据：**
```
公司年度利润构成：
营业收入：5000万
营业成本：-3000万
销售费用：-800万
管理费用：-600万
财务费用：-200万
营业利润：400万
投资收益：100万
营业外收入：50万
所得税：-150万
净利润：400万
```

**任务：**
1. 制作瀑布图
2. 设置起始值（营业收入）和最终值（净利润）为总计
3. 添加数据标签
4. 分析：哪个项目对利润影响最大？

---

### 步骤五：对比与应用场景（5分钟）

#### 5.1 子弹图 vs 瀑布图

| 特点 | 子弹图 | 瀑布图 |
|------|--------|--------|
| 用途 | 目标达成情况 | 增减变化过程 |
| 维度 | 实际vs目标vs区间 | 时间或步骤 |
| 典型场景 | KPI仪表板 | 财务分析 |
| 数据类型 | 单一时间点 | 多个时间点/步骤 |

#### 5.2 何时使用

**何时使用子弹图：**
- 展示KPI完成情况
- 对比实际和目标
- 需要显示绩效区间

**何时使用瀑布图：**
- 展示增减过程
- 分解构成要素
- 追踪变化路径

---

### 步骤六：总结与作业（2分钟）

#### 6.1 知识回顾

**核心要点：**
- 子弹图：实际vs目标vs区间，用于KPI
- 瀑布图：增减变化过程，用于财务分析

#### 6.2 作业布置

**提交物：**

**文件1：子弹图作品**
- 制作至少1个子弹图
- 展示KPI完成情况
- 文件命名：`学号_姓名_任务8_子弹图.xlsx`

**文件2：瀑布图作品**
- 用提供的数据制作瀑布图
- 添加标题和数据标签
- 文件命名：`学号_姓名_任务8_瀑布图.xlsx`

**提交截止：** 下次上课前

**加分项：**
- 制作多KPI对比子弹图
- 向AI学习其他专业图表（桑基图、和弦图等）

---

## 📚 附录

### 常见问题FAQ

**Q1: Excel 2013及以下版本怎么做瀑布图？**
A: 使用堆叠柱状图模拟：
   - 添加"透明"系列作为起点
   - 添加"增加"和"减少"系列
   - 设置透明系列为无填充

**Q2: 子弹图一定要有4个区间吗？**
A: 不一定。可以根据需要设置2-5个区间，常见的是3个（差-中-优）或4个（差-中-良-优）。

**Q3: 瀑布图的数据必须是连续的吗？**
A: 不一定。可以展示任何有逻辑顺序的增减过程，不一定是时间顺序。

**Q4: 子弹图适合展示多个指标吗？**
A: 非常适合！子弹图最大的优势就是节省空间，可以在一个仪表板中展示10+个KPI。

### Excel操作技巧

**子弹图快速制作：**
1. 准备好数据模板
2. 制作一次后保存为模板
3. 以后直接替换数据

**瀑布图颜色自定义：**
```
选中柱子 → 设置数据点格式 → 填充 → 纯色
分别设置增加、减少、总计的颜色
```

**瀑布图添加连接线：**
```
Excel 2016+：
图表工具 → 设计 → 添加图表元素 → 线条 → 连接线
或：手动插入形状-直线
```

### AI提问模板

```
"什么是子弹图？Excel怎么做子弹图？"
"瀑布图适合展示什么数据？有什么注意事项？"
"还有哪些专业的商业图表类型？"
```

---

**祝你学习愉快！** 🎉


