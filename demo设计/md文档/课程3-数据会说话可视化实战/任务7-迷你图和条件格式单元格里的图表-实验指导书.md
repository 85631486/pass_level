# 任务7：迷你图和条件格式——单元格里的图表

## 📌 学习目标

通过本任务的学习，你将能够：

1. **知识目标**
   - 理解迷你图的概念和优势
   - 掌握条件格式的多种应用
   - 了解在表格中嵌入可视化的价值

2. **技能目标**
   - 能够创建折线、柱状、盈亏三种迷你图
   - 能够使用数据条、色阶、图标集
   - 能够自定义条件格式规则
   - 能够制作"自带可视化"的专业表格

3. **素养目标**
   - 培养表格美化意识
   - 建立数据快速识别能力
   - 形成高效数据展示的习惯

---

## ⏰ 任务时间

- **总时长**：2学时（90分钟）
- **建议分配**：
  - 课程导入与方法讲解：48分钟
  - 实践操作：30分钟
  - 总结与作业布置：12分钟

---

## 🛠️ 准备工作

### 必备工具
- [ ] Excel 2010及以上版本（支持迷你图）
- [ ] AI助手账号（ChatGPT/文心一言/通义千问，至少一个）

### 📁 数据文件
**重要：本任务需要数据文件！**

如果老师提供了数据文件，请使用：`任务7-月度数据表.csv`

---

## 📋 操作步骤

### 步骤一：案例导入（8分钟）

#### 1.1 传统表格vs可视化表格

**展示对比：**

**表格A：传统数字表格**
```
销售员  1月  2月  3月  4月  5月  6月
张三    85   92   88   95   90   93
李四    78   82   85   88   92   95
王五    92   88   85   82   80   78
```
效果：需要仔细看数字才能发现趋势

**表格B：带迷你图的表格**
```
销售员  1月-6月数据  趋势图  状态
张三    [数字...]    [📈]   ↑
李四    [数字...]    [📈]   ↑
王五    [数字...]    [📉]   ↓
```
效果：一眼看出每个人的趋势！

#### 1.2 应用场景

**适用场景：**
- 财务报表
- 销售业绩表
- 项目进度表
- KPI仪表板

**优势：**
- 节省空间
- 快速识别模式
- 表格+图表合二为一

#### 1.3 学习目标

今天要学会：
- 迷你图：折线、柱状、盈亏
- 条件格式：数据条、色阶、图标集
- 制作专业的可视化表格

---

### 步骤二：迷你图详解（30分钟）

#### 2.1 什么是迷你图？

**定义：**
- 嵌入单元格中的微型图表
- 由Edward Tufte提出
- Excel 2010+支持

**特点：**
- 极简，无坐标轴
- 突出趋势而非精确数值
- 占用一个单元格空间

#### 2.2 折线迷你图

**用途：展示趋势变化**

**操作演示：**

**数据：**
```
产品A  1月:100  2月:120  3月:115  4月:130
```

**步骤：**
```
步骤1：选中要放置迷你图的单元格（如F2）
步骤2：插入 → 迷你图 → 折线图
步骤3：数据范围：选择B2:E2
步骤4：位置范围：F2
确定
```

**结果：单元格F2显示一条迷你折线**

**优化设置：**
```
选中迷你图 → 迷你图工具 → 设计

勾选选项：
☑ 高点（标记最高点）
☑ 低点（标记最低点）
☑ 首尾点
☑ 负值点

设置颜色：
- 线条：深蓝色
- 高点：绿色
- 低点：红色
```

**批量创建：**
```
选中F2 → 复制 → 粘贴到F3:F10
或：创建时位置范围选择F2:F10，一次创建多个
```

#### 2.3 柱状迷你图

**用途：对比各期数值**

**操作：**
```
插入 → 迷你图 → 柱形图
数据范围：B2:E2
位置范围：G2
```

**效果：显示小柱子，像迷你柱状图**

**何时用柱状而非折线？**
- 期数较少（3-6个）
- 强调每个时期的绝对值
- 数据不是连续的时间序列

**优化：**
```
设置：
- 相同颜色柱子
- 或突出最大最小柱子
```

#### 2.4 盈亏迷你图

**用途：展示正负值（如盈利/亏损）**

**数据：**
```
月份  盈亏(万元)
1月   +5
2月   +8
3月   -3
4月   +10
5月   +6
6月   -2
```

**操作：**
```
插入 → 迷你图 → 盈亏图
数据范围：B2:G2
位置范围：H2
```

**效果：**
```
正值：蓝色（或绿色）向上柱子
负值：红色向下柱子
零值：无柱子或平线
```

**设置：**
```
盈亏图选项：
- 正值颜色：绿色
- 负值颜色：红色
```

**应用场景：**
- 财务盈亏
- 温度变化（正负）
- 库存增减

---

### 步骤三：条件格式详解（30分钟）

#### 3.1 什么是条件格式？

**定义：**
根据单元格数值自动应用格式（颜色、图标等）

**优势：**
- 自动化，数据变化时格式自动更新
- 视觉化，快速识别高低值
- 灵活，可自定义规则

#### 3.2 数据条

**用途：在单元格中显示条形，长度代表数值大小**

**操作演示：**

**数据：销售额**
```
产品A  1500
产品B  2300
产品C  1800
产品D  900
```

**步骤：**
```
步骤1：选中数值单元格（B2:B5）
步骤2：开始 → 条件格式 → 数据条 → 选择颜色
```

**效果：**
```
产品A  1500  [███████]
产品B  2300  [███████████]
产品C  1800  [█████████]
产品D  900   [████]
```

**优化设置：**
```
条件格式 → 管理规则 → 编辑规则

选项：
☑ 仅显示数据条（隐藏数值）
□ 显示条形和数值（默认）

条形方向：从左到右 / 从右到左
颜色：自定义渐变色
```

#### 3.3 色阶

**用途：用颜色深浅表示数值大小**

**操作：**
```
选中单元格
条件格式 → 色阶 → 选择配色方案
```

**常用配色：**
- 三色：红-黄-绿（低-中-高）
- 双色：白-蓝（低-高）

**何时使用？**
- 热力图效果
- 快速识别极值
- 数据分布可视化

**自定义色阶：**
```
色阶 → 其他规则 → 自定义
设置：
最小值：红色
中间值：黄色（50百分位）
最大值：绿色
```

#### 3.4 图标集

**用途：用图标（箭头、符号）表示数值范围**

**操作：**
```
选中单元格
条件格式 → 图标集 → 选择样式
```

**常用图标集：**
- 三向箭头：↑ → ↓
- 交通灯：🔴 🟡 🟢
- 星级：★★★
- 形状：▲ ■ ▼

**默认规则：**
```
> 67%： ↑ （或绿色）
33%-67%： → （或黄色）
< 33%： ↓ （或红色）
```

**自定义规则：**
```
图标集 → 管理规则 → 编辑

设置：
> 90： ↑
60-90： →
< 60： ↓

反转图标顺序：勾选后，数值越大显示↓
仅显示图标：隐藏数值
```

**应用：**
```
销售额  图标
1500    →
2300    ↑
1800    →
900     ↓
```

#### 3.5 自定义公式规则（高级）

**用途：根据复杂条件设置格式**

**案例1：突出高于平均值的单元格**

```
选中单元格 → 条件格式 → 新建规则 → 使用公式

公式：=B2>AVERAGE($B$2:$B$10)
格式：绿色背景
```

**案例2：隔行变色**

```
公式：=MOD(ROW(),2)=0
格式：浅灰色背景
用途：偶数行变色，易于阅读
```

**案例3：突出重复值**

```
公式：=COUNTIF($B$2:$B$10,B2)>1
格式：红色文字
用途：数据验证
```

**学生练习：**
```
任务：设置规则，销售额>2000的单元格背景变绿色
```

---

### 步骤四：综合实践——制作可视化表格（18分钟）

#### 4.1 任务说明

**数据：**
```
销售员  Q1   Q2   Q3   Q4   全年  趋势  状态
张三    85   92   95   98   370
李四    78   82   88   92   340
王五    92   88   85   80   345
赵六    88   90   92   95   365
```

**任务：**
1. 在"趋势"列添加折线迷你图
2. 在"状态"列添加图标集（↑→↓）
3. 在"全年"列添加数据条
4. 用色阶为Q1-Q4数据着色

#### 4.2 操作步骤

**步骤1：添加迷你图**
```
选中G2 → 插入迷你图 → 折线图
数据范围：B2:E2
位置：G2
批量复制到G3:G5
```

**步骤2：添加图标集**
```
选中H2:H5
条件格式 → 图标集 → 三向箭头
```

**步骤3：添加数据条**
```
选中F2:F5
条件格式 → 数据条 → 蓝色
```

**步骤4：添加色阶**
```
选中B2:E5
条件格式 → 色阶 → 绿-黄-红
```

**最终效果：一张自带可视化的专业表格！**

---

### 步骤五：向AI学习技巧（6分钟）

#### 5.1 学生提问

**建议提问：**
1. "Excel条件格式能根据另一列的值设置颜色吗？"
2. "迷你图能显示坐标轴吗？"
3. "条件格式的规则可以复制到其他单元格吗？"

---

### 步骤六：总结与作业（8分钟）

#### 6.1 知识回顾

**迷你图三种类型：**
- 折线：趋势变化
- 柱状：数值对比
- 盈亏：正负值

**条件格式三种主要类型：**
- 数据条：长度代表数值
- 色阶：颜色深浅代表数值
- 图标集：符号代表范围

#### 6.2 作业布置

**提交物：**

**文件：可视化表格**
- 用提供的数据制作包含迷你图和条件格式的表格
- 至少使用3种可视化元素
- 文件命名：`学号_姓名_任务7_可视化表格.xlsx`

**提交截止：** 下次上课前

**加分项：**
- 使用自定义公式规则
- 尝试多种图标集组合

---

## 📚 附录

### 常见问题FAQ

**Q1: 迷你图能单独导出吗？**
A: 不能。迷你图嵌入在单元格中，只能复制整个单元格或截图。

**Q2: 条件格式会影响计算吗？**
A: 不会。条件格式只改变显示效果，不影响单元格的实际值。

**Q3: 一个单元格能应用多个条件格式吗？**
A: 可以，但要注意优先级。后设置的规则优先级更高。

**Q4: 迷你图的数据范围能自动扩展吗？**
A: 不会自动扩展。如果数据增加，需要手动编辑迷你图数据源。

### Excel操作技巧

**快速清除条件格式：**
```
选中单元格 → 条件格式 → 清除规则 → 清除所选单元格的规则
```

**复制条件格式：**
```
格式刷：选中已设置条件格式的单元格 → 格式刷 → 刷到目标单元格
```

**编辑迷你图：**
```
选中迷你图 → 迷你图工具 → 设计 → 编辑数据
```

**删除迷你图：**
```
选中包含迷你图的单元格 → 迷你图工具 → 清除
```

### AI提问模板

```
"Excel条件格式能根据另一列的值设置颜色吗？"
"迷你图能显示坐标轴吗？"
"条件格式的规则可以复制到其他单元格吗？"
```

---

**祝你学习愉快！** 🎉


