# 任务7：格式统一大作战

## 📌 学习目标

通过本任务的学习，你将能够：

1. **知识目标**
   - 理解数据格式不统一的表现形式和危害
   - 掌握常见格式问题的识别方法
   - 了解数据标准化的重要性

2. **技能目标**
   - 能够处理日期格式不统一问题（TEXT、DATEVALUE函数）
   - 能够清理文本中的多余空格（TRIM、CLEAN函数）
   - 能够统一数值格式（VALUE函数，文本转数字）
   - 能够统一大小写和命名规范（UPPER、LOWER、PROPER函数）

3. **素养目标**
   - 培养数据规范意识，认识到"细节决定成败"
   - 养成数据录入和整理的标准化习惯
   - 提升细节观察能力和问题发现能力

---

## ⏰ 任务时间

- **总时长**：2学时（90分钟）
- **建议分配**：
  - 课程导入与方法演示：35分钟
  - 实战练习：30分钟
  - 成果展示与总结：25分钟

---

## 🛠️ 准备工作

### 必备工具
- [ ] Excel 2016及以上版本 或 WPS Office
- [ ] AI助手账号（ChatGPT/文心一言/通义千问，至少一个）

### 📁 数据文件
**重要：请从课程数据文件夹中下载以下文件！**

- `任务7-格式混乱数据.csv`（40条客户订单记录，包含多种格式问题）

---

## 📋 操作步骤

### 步骤一：课程导入（10分钟）

#### 1.1 案例导入

**案例导入：**
"某公司财务报表因日期格式不统一，导致季度汇总出错，损失10万元"

**💭 思考：**
- 你遇到过哪些格式问题？
- 格式不统一会造成什么影响？

#### 1.2 常见格式问题分类

**1. 日期格式混乱**
- 问题：2024/11/20、2024-11-20、20241120
- 危害：无法排序、无法计算日期差

**2. 多余空格**
- 问题：" 张三"、"张三 "、"张  三"
- 危害：查找匹配失败、VLOOKUP找不到

**3. 大小写不统一**
- 问题：Beijing、beijing、BEIJING
- 危害：分类统计时被当作不同值

**4. 数字存储为文本**
- 问题：单元格左上角有绿色小三角
- 危害：SUM求和结果为0、无法排序

**5. 单位不统一**
- 问题：1000元、1千元、1k、1,000
- 危害：无法直接比较大小、无法计算总和

---

### 步骤二：方法演示（25分钟）

#### 2.1 方法一：日期格式统一

**演示步骤：**
```
场景：A列有多种日期格式，需要统一为"YYYY-MM-DD"

步骤1：转换为标准日期
在B列输入: =DATEVALUE(A2)

步骤2：格式化为统一样式
在C列输入: =TEXT(B2,"yyyy-mm-dd")

或直接组合: =TEXT(DATEVALUE(A2),"yyyy-mm-dd")
```

**立即实践：**
- 打开数据文件，统一订单日期格式

#### 2.2 方法二：清除多余空格

**演示步骤：**
```
使用TRIM函数：
=TRIM(A2)
功能：删除前导/尾随空格，多个空格变一个

使用CLEAN函数：
=CLEAN(A2)
功能：删除不可打印的字符

组合使用（最彻底）：
=TRIM(CLEAN(A2))
```

**💡 技巧提示：**
如何发现隐藏的空格？
- 使用LEN函数：=LEN(A2)
- 如果长度比预期长，说明有隐藏空格或字符

**立即实践：**
- 清除客户姓名中的多余空格

#### 2.3 方法三：文本转数字

**演示步骤：**
```
识别特征：
- 单元格左上角有绿色小三角
- 数字左对齐
- SUM求和结果为0

方法1：VALUE函数
=VALUE(A2)

方法2：乘以1
=A2*1

方法3：Excel内置工具
选中单元格 → 点击黄色警告图标 → "转换为数字"
```

**立即实践：**
- 将订单金额从文本转换为数字

#### 2.4 方法四：大小写统一

**演示步骤：**
```
=UPPER(A2)  '转大写:beijing → BEIJING
=LOWER(A2)  '转小写:BEIJING → beijing
=PROPER(A2) '首字母大写:beijing → Beijing
```

**立即实践：**
- 统一城市名称为首字母大写

#### 2.5 方法五：查找替换

**演示步骤：**
```
场景：金额列有"万"字，需要转换为实际数值

方法1：查找替换
Ctrl+H
查找:"万"
替换为:"0000"

方法2：公式替换
=VALUE(SUBSTITUTE(A2,"万",""))*10000

常见应用：
- 删除千分位逗号：查找","替换为""
- 删除货币单位：查找"元"替换为""
```

**立即实践：**
- 统一订单金额格式（处理"1.5万"、"2千"、"1,500元"等）

---

### 步骤三：实战练习（30分钟）

**任务目标：**
打开"任务7-格式混乱数据.csv"，完成以下格式统一：

**数据概况：**
40条客户订单记录，包含订单日期、客户姓名、联系电话、订单金额、收货城市

**具体任务：**
1. 统一订单日期为"YYYY-MM-DD"格式（10分钟）
2. 清除客户姓名中的多余空格（5分钟）
3. 统一订单金额为纯数字（10分钟）
   - 处理："1.5万"、"2千"、"1,500元"等格式
4. 统一电话号码格式为"138-XXXX-XXXX"（可选）
5. 统一城市名称为首字母大写（5分钟）

**任务要求：**
- 不删除原始数据列，在旁边新建列处理
- 每个任务完成后举手请老师检查
- 至少向AI求助1次

---

### 步骤四：成果展示（10分钟）

**展示内容：**
1. 展示格式统一后的数据表
2. 说明使用的函数和方法
3. 分享遇到的最难问题和解决过程
4. 展示格式统一前后的对比

---

### 步骤五：总结提升（5分钟）

**今天学会的格式清理方法：**
1. 日期统一：TEXT + DATEVALUE
2. 清除空格：TRIM + CLEAN
3. 文本转数字：VALUE或*1
4. 大小写统一：UPPER/LOWER/PROPER
5. 批量替换：Ctrl+H查找替换

**格式清理三步法：**
1. 识别：观察对齐方式、使用LEN函数
2. 转换：选择合适的函数或工具
3. 验证：检查结果，测试能否正常使用

**课后任务：**
1. 找一份自己的真实数据检查并处理格式问题
2. 练习6个函数：TRIM、CLEAN、TEXT、DATEVALUE、VALUE、SUBSTITUTE
3. 向AI提问3个关于格式处理的问题

---

## 📚 附录

### 附录1：常见问题FAQ

**Q1: TRIM函数无法删除某些空格怎么办？**
A: 可能是全角空格，解决方法:
```excel
=TRIM(CLEAN(SUBSTITUTE(A1,CHAR(160)," ")))
```

**Q2: 如何批量将日期从"20241120"转为"2024-11-20"?**
A:
```excel
=TEXT(DATE(LEFT(A1,4),MID(A1,5,2),RIGHT(A1,2)),"yyyy-mm-dd")
```

**Q3: 如何处理"1.5万"这种半数字半文本?**
A:
```excel
=VALUE(SUBSTITUTE(A1,"万",""))*10000
```

### 附录2：格式清理函数速查表

| 函数 | 功能 | 示例 | 结果 |
|------|------|------|------|
| TRIM | 删除多余空格 | =TRIM("  张三  ") | "张三" |
| CLEAN | 删除不可打印字符 | =CLEAN(A1) | 清除字符 |
| TEXT | 数字转格式文本 | =TEXT(A1,"0000") | "0123" |
| DATEVALUE | 文本转日期 | =DATEVALUE("2024-11-20") | 日期值 |
| VALUE | 文本转数字 | =VALUE("123") | 123 |
| UPPER | 转大写 | =UPPER("abc") | "ABC" |
| LOWER | 转小写 | =LOWER("ABC") | "abc" |
| PROPER | 首字母大写 | =PROPER("beijing") | "Beijing" |

### 附录3：格式问题诊断速查表

| 问题现象 | 可能原因 | 解决方案 |
|---------|---------|---------|
| SUM求和为0 | 数字存储为文本 | VALUE函数或*1 |
| VLOOKUP找不到 | 有多余空格 | TRIM+CLEAN |
| 日期无法排序 | 日期存储为文本 | DATEVALUE转换 |
| 分类重复 | 大小写不统一 | UPPER/LOWER统一 |
| 无法参与计算 | 带单位或符号 | SUBSTITUTE删除 |

---

**祝你学习愉快！** 🎉

