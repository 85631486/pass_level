# 任务13：趋势与规律发现

## 📌 学习目标

通过本任务的学习，你将能够：

1. **知识目标**
   - 理解时间序列数据的基本概念和四大要素（趋势、季节性、周期性、随机性）
   - 掌握移动平均法的原理和计算方法
   - 理解趋势线类型的选择标准和R²值的解读
   - 理解简单趋势预测的基本原理和局限性

2. **技能目标**
   - 能够使用Excel绘制时间序列折线图并识别基本趋势
   - 能够使用AVERAGE函数计算移动平均
   - 能够为折线图添加不同类型的趋势线并解读公式
   - 能够使用FORECAST函数进行简单的趋势预测
   - 能够识别数据中的季节性规律

3. **素养目标**
   - 培养从时间维度观察和分析问题的思维习惯
   - 树立数据驱动预测的科学态度，不盲目预测未来
   - 提升从历史数据中总结规律的能力

---

## ⏰ 任务时间

- **总时长**：2学时（90分钟）
- **建议分配**：
  - 课程导入与理论讲解：25分钟
  - 方法演示：25分钟
  - 实战练习：30分钟
  - 成果展示与总结：10分钟

---

## 🛠️ 准备工作

### 必备工具
- [ ] Excel 2016及以上版本 或 WPS Office
- [ ] AI助手账号（ChatGPT/文心一言/通义千问，至少一个）

### 📁 数据文件
**重要：请从课程数据文件夹中下载以下文件！**

- `任务13-时间序列数据.csv`（某电商店铺12个月的每日销售数据）

---

## 📋 操作步骤

### 步骤一：课程导入（10分钟）

#### 1.1 案例导入

**展示2020-2024年某公司股价走势图**
- 提问："从过去4年的数据，能看出什么规律？"
- 引出问题："如何从历史数据中发现趋势和规律？"

**💭 思考：**
- 数据随时间变化有什么规律？
- 如何预测未来？

#### 1.2 时间序列的四大要素

1. **趋势（Trend）：** 长期的上升或下降方向
2. **季节性（Seasonality）：** 固定周期的规律性波动
3. **周期性（Cycle）：** 不固定周期的长期波动
4. **随机性（Random）：** 不可预测的随机波动

---

### 步骤二：理论讲解（15分钟）

#### 2.1 时间序列的组成要素

**趋势（Trend）**
- 定义：数据在较长时期内呈现的总体变化方向
- 类型：上升趋势、下降趋势、水平趋势
- 识别：观察折线图整体走向、添加趋势线

**季节性（Seasonality）**
- 定义：在固定周期内重复出现的规律性波动
- 特点：周期固定、可预测、重复性
- 例子：夏天空调销量高、周末餐厅客流多

**周期性vs季节性：**
- 季节性：周期固定（如每年）
- 周期性：周期不固定（如经济周期3-7年）

#### 2.2 移动平均法

**原理：**
通过计算最近N期的平均值来平滑数据，突出趋势

**公式：**
```excel
=AVERAGE(B2:B8)  ; 7日移动平均
向下拖动公式，每次取最近7天
```

**窗口大小选择：**
- 窗口小（如3天）：反应灵敏，但平滑效果弱
- 窗口大（如30天）：平滑效果好，但滞后明显
- 常用：7天（周）、30天（月）、90天（季度）

#### 2.3 趋势线和预测

**趋势线类型：**
1. **线性趋势：** 匀速增长，y = ax + b
2. **指数趋势：** 加速增长，y = a × e^(bx)
3. **多项式趋势：** 有起伏变化，y = ax² + bx + c
4. **对数趋势：** 快速增长后放缓，y = a × ln(x) + b

**选择原则：**
1. 先画图观察形状
2. 尝试不同类型，对比R²值
3. R²越接近1，拟合越好
4. 考虑业务合理性，不只看R²

**FORECAST函数：**
```excel
=FORECAST.LINEAR(新时间点, 历史Y值, 历史X值)
```

**预测的局限性：**
- ⚠ 只能短期预测（1-2个周期）
- ⚠ 假设趋势不变（实际会变）
- ⚠ 无法预测突发事件
- ⚠ 仅供参考，不能盲信

---

### 步骤三：方法演示（25分钟）

#### 3.1 绘制时间序列图（7分钟）

**演示步骤：**
1. 打开"任务13-时间序列数据.csv"
2. 选中日期列和销售额列
3. 插入 → 图表 → 折线图 → 带数据标记的折线图
4. 优化图表：添加标题、坐标轴标签

**初步观察：**
- 整体趋势是上升还是下降？
- 有没有明显的重复规律？
- 哪些点特别高或特别低？

**立即实践：**
- 绘制完整的时间序列图
- 观察并记录初步发现

#### 3.2 计算移动平均（8分钟）

**演示步骤：**
1. 创建7日移动平均列：
   ```excel
   D8单元格: =AVERAGE(C2:C8)
   向下拖动到最后一行
   ```

2. 创建30日移动平均列：
   ```excel
   E31单元格: =AVERAGE(C2:C31)
   向下拖动
   ```

3. 绘制对比图：选中日期、销售额、7日均值、30日均值，插入折线图

**观察平滑效果：**
- 原始数据：波动大，难以看清趋势
- 7日均值：平滑一些，还能看到短期波动
- 30日均值：非常平滑，清晰看到长期趋势

**立即实践：**
- 计算7日、14日、30日移动平均
- 绘制对比图

#### 3.3 添加趋势线和预测（10分钟）

**演示步骤：**
1. 选中销售额折线图
2. 右键点击数据系列 → 添加趋势线
3. 选择类型：线性，勾选"显示公式"和"显示R平方值"
4. 预测：向前预测30个周期

**解读趋势线：**
- 公式：y = 1200x + 50000
  - 斜率1200：每天平均增长1200元
  - R²=0.65：能解释65%的变化

**尝试其他趋势线：**
对比线性、指数、多项式的R²值，选择最优

**使用FORECAST函数：**
```excel
=FORECAST.LINEAR(366, C2:C366, A2:A366)
预测第366天的销售额
```

**立即实践：**
- 添加最合适的趋势线
- 使用FORECAST预测未来7天

---

### 步骤四：实战练习（30分钟）

**任务要求：**
1. 绘制完整的时间序列图（包含原始数据和移动平均）（5分钟）
2. 计算7日、14日、30日移动平均（5分钟）
3. 添加最合适的趋势线，解读公式和R²（5分钟）
4. 识别数据中的季节性规律（如按星期、按月分组）（10分钟）
5. 发现并解释至少3个异常点（3分钟）
6. 使用FORECAST预测未来7天销售额（2分钟）
7. 撰写趋势分析报告（500字）

**教师巡视指导：**
- 检查移动平均公式是否正确
- 趋势线的类型选择是否合理
- 是否能识别季节性规律
- 遇到问题是否会向AI求助

---

### 步骤五：成果展示（10分钟）

**展示内容：**
- 展示时间序列图和移动平均
- 展示趋势线和R²值
- 分享发现的季节性规律
- 解释异常点
- 展示预测结果

**教师点评：**
- 图表质量：表扬折线图清晰、移动平均线正确叠加的同学
- 趋势线选择：强调不要只看R²，要考虑业务合理性
- 季节性发现：表扬能发现周末、月末规律的同学
- 预测合理性：强调预测有风险，仅供参考

---

### 步骤六：总结提升（5分钟）

**知识回顾：**
1. 时间序列四要素：趋势、季节性、周期性、随机性
2. 移动平均法：=AVERAGE(最近N个值)
3. 趋势线选择：先看图形形状，对比R²值，考虑业务合理性
4. 趋势预测：=FORECAST.LINEAR(新X, Y值, X值)

**核心原则：**
- 预测越远，越不准
- 移动平均能平滑但会滞后
- 趋势线只是拟合历史，不是预测未来的水晶球

**课后任务：**
1. 完善趋势分析报告（500-800字）
2. 自选时间序列数据完成完整分析
3. 识别个人数据的季节性规律
4. 向AI提问5个时间序列问题

---

## 📚 附录

### 移动平均窗口选择
- 3日：极短期，高度灵敏
- 7日：周，消除周内波动
- 30日：月，常用
- 90日：季，长期趋势

### 趋势线类型对比

| 类型 | 图形特征 | 适用场景 |
|------|---------|---------|
| 线性 | 直线 | 稳定增长的销售 |
| 指数 | 越来越陡 | 用户增长、疫情 |
| 多项式 | 有峰谷 | 产品生命周期 |
| 对数 | 先快后慢 | 学习曲线、市场饱和 |

### 常用函数

```excel
移动平均: =AVERAGE(区域)
线性预测: =FORECAST.LINEAR(新X, Y区域, X区域)
R²值: =RSQ(Y区域, X区域)
提取月份: =MONTH(日期)
提取星期: =WEEKDAY(日期)
```

### AI提问模板

```
"什么是时间序列的季节性？如何用Excel识别？"
"移动平均法的窗口大小如何选择？"
"Excel趋势线有哪几种类型？分别适用于什么场景？"
"如何判断一个时间序列数据是否适合做预测？"
```

---

**祝你学习愉快！** 🎉

