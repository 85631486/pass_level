# 任务1：网页数据抓取入门

## 📌 学习目标

通过本任务的学习，你将能够：

1. **知识目标**
   - 理解网页数据的基本结构（HTML、表格等）
   - 了解数据抓取的基本原理和合法性问题
   - 掌握Excel中导入网页数据的基本方法
   - 认识常见的数据抓取工具和方式

2. **技能目标**
   - 能够使用Excel的"从Web获取数据"功能导入网页表格
   - 能够从B站、豆瓣等网站手动复制粘贴数据到Excel
   - 能够对抓取的数据进行初步整理

3. **素养目标**
   - 培养数据侦探意识，发现生活中可以获取的数据
   - 树立网络数据抓取的合法合规意识
   - 养成尊重数据来源、注明数据出处的良好习惯
   - 培养遇到问题主动向AI求助的能力

---

## ⏰ 任务时间

- **总时长**：2学时（90分钟）
- **建议分配**：
  - 课程导入与理论讲解：25分钟
  - 方法演示与实践：50分钟
  - 成果展示与总结：15分钟

---

## 🛠️ 准备工作

### 必备工具
- [ ] Excel 2016及以上版本 或 WPS Office
- [ ] 网络连接正常
- [ ] AI助手账号（ChatGPT/文心一言/通义千问，至少一个）
- [ ] 浏览器（Chrome、Edge等）

### 📁 数据文件
**重要：本任务需要从网页抓取数据，也可以使用示例数据！**

如果无法抓取，可以使用老师提供的示例数据：`任务1-B站热门视频数据.csv`

---

## 📋 操作步骤

### 步骤一：了解网页数据抓取（10分钟）

#### 1.1 思考：网页上有哪些数据？

**立即思考：**
- 你平时浏览哪些网站？
- 这些网站上有哪些数据可能对你有用？
- 比如：游戏排行榜、热搜榜、商品价格、视频播放量等

**分享你的想法：**
- 和同学讨论：你想获取什么网页数据？
- 记录：我想获取的数据是：________________

#### 1.2 网页数据的类型

**知识点：网页数据分为三类**

1. **结构化数据**：表格、列表（容易抓取）
   - 例如：排行榜、价格表、数据统计表
   - 特点：有明确的行列结构

2. **半结构化数据**：嵌入在HTML中的文本（需要工具）
   - 例如：新闻标题、评论内容
   - 特点：有规律但需要提取

3. **非结构化数据**：图片、视频（需要专业工具）
   - 例如：图片、视频文件
   - 特点：需要专业工具处理

**💡 提示：** 今天我们主要学习抓取结构化数据（表格）

#### 1.3 数据抓取的三种方式

**方法对比：**

| 方法 | 难度 | 适用场景 | 优点 | 缺点 |
|------|------|----------|------|------|
| 手动复制粘贴 | ⭐ | 少量数据（<50条） | 简单快速，无需工具 | 效率低，容易出错 |
| Excel内置功能 | ⭐⭐ | 网页表格 | 可刷新，自动更新 | 仅限表格结构 |
| 专业工具/编程 | ⭐⭐⭐⭐⭐ | 大量复杂数据 | 功能强大，自动化 | 学习成本高 |

**今天重点学习：方法一和方法二**

#### 1.4 数据抓取的合法性（重要！）

**⚠️ 必须遵守的规则：**

1. **Robots协议**：网站的"禁止抓取"声明
   - 查看方法：在网址后加 `/robots.txt`
   - 例如：https://www.bilibili.com/robots.txt
   - 如果网站禁止抓取，不要违反

2. **法律红线**：
   - ❌ 不能抓取个人隐私数据
   - ❌ 不能抓取商业机密
   - ❌ 不能用于商业用途或恶意目的
   - ✅ 公开数据、统计数据一般可以抓取
   - ✅ 仅用于学习研究，注明数据来源

3. **伦理规范**：
   - 不过度访问（不要频繁请求）
   - 注明数据来源和抓取日期
   - 尊重网站的服务条款

**💡 提示：** 不确定是否可以抓取时，先查看Robots协议，或咨询老师

#### 📝 课堂问答：了解数据抓取

完成上述学习后，请回答以下问题：

**问题1：** 以下哪种数据最容易抓取？

A. 网页中的图片  
B. 网页中的表格数据  
C. 网页中的视频  
D. 网页中的音频

**正确答案：B**

**解析：** 表格数据属于结构化数据，有明确的行列结构，最容易抓取。图片、视频、音频属于非结构化数据，需要专业工具处理。

---

**问题2：** 如何查看一个网站是否允许数据抓取？

A. 直接开始抓取，被抓到再说  
B. 查看网站的Robots协议（网址/robots.txt）  
C. 问网站管理员  
D. 不需要查看，都可以抓取

**正确答案：B**

**解析：** Robots协议是网站声明是否允许抓取的标准方式。在网址后加 `/robots.txt` 可以查看网站的抓取规则。

---

**问题3：** 以下哪种行为是合法的数据抓取？

A. 抓取个人隐私数据用于商业用途  
B. 抓取公开的统计数据用于学习研究，并注明来源  
C. 违反Robots协议抓取数据  
D. 抓取商业机密数据

**正确答案：B**

**解析：** 合法的数据抓取应该遵守Robots协议，仅抓取公开数据，用于学习研究，并注明数据来源。不能抓取个人隐私、商业机密，也不能用于商业用途。

---

### 步骤二：向AI学习数据抓取方法（5分钟）

#### 2.1 向AI提问

**立即动手：打开你的AI助手**

**提问模板：**
```
我想从网页上获取数据到Excel，有哪些方法？请按照难易程度排序，并说明各自的适用场景。
```

**💡 提示：**
- 对比不同AI工具的回答
- 记录AI推荐的方法
- 如果有不懂的地方，继续问AI

#### 2.2 记录AI的回答

**在纸上或Word里记录：**
- AI推荐的方法1：________________
- AI推荐的方法2：________________
- AI推荐的方法3：________________
- 我的疑问：________________

---

### 步骤三：方法一：手动复制粘贴（15分钟）

#### 3.1 实战操作：从B站抓取热门视频数据

**立即动手：**

1. **打开B站首页**
   - 在浏览器中打开：https://www.bilibili.com
   - 找到"热门"或"排行榜"页面

2. **选中数据区域**
   - 用鼠标左键按住，拖动选中视频标题、UP主、播放量等数据
   - 选中的区域会高亮显示

3. **复制数据**
   - 按 `Ctrl+C`（Windows）或 `Cmd+C`（Mac）复制
   - 或者右键点击选中的区域 → 选择"复制"

4. **粘贴到Excel**
   - 打开Excel，新建一个工作簿
   - 点击A1单元格（左上角第一个格子）
   - 按 `Ctrl+V`（Windows）或 `Cmd+V`（Mac）粘贴
   - 数据会粘贴到Excel中

5. **处理格式问题**

**如果粘贴后格式混乱：**
- 方法1：使用"选择性粘贴"
  - 右键点击粘贴的数据 → 选择"选择性粘贴" → 选择"文本"
- 方法2：清除格式
  - 选中数据 → 点击"开始"选项卡 → 点击"清除" → 选择"清除格式"

**如果数据全挤在一列：**
- 选中数据列
- 点击"数据"选项卡 → "分列"
- 选择分隔符（空格、制表符等）
- 完成分列

6. **处理数字单位（如"万"字）**

**如果播放量有"万"字：**
- 方法1：查找替换
  - 按 `Ctrl+H` 打开查找替换对话框
  - 查找："万"，替换为："0000"
  - 注意：1.5万需要手动处理成15000
- 方法2：使用公式
  ```excel
  =VALUE(SUBSTITUTE(A1,"万",""))*10000
  ```

#### 3.2 练习任务

**任务要求：**
- 从B站复制10条热门视频数据到Excel
- 包含字段：视频标题、UP主、播放量
- 整理格式，确保数据清晰
- 时间：5分钟

**💡 提示：**
- 如果B站无法访问，可以用其他网站（如豆瓣电影Top250）
- 或者直接使用老师提供的示例数据

#### 📝 课堂问答：手动复制粘贴

完成上述操作后，请回答以下问题：

**问题1：** 从网页复制数据到Excel后，格式混乱，应该怎么处理？

A. 重新复制  
B. 使用"选择性粘贴-文本"或"清除格式"  
C. 手动一个一个修改  
D. 放弃，不用了

**正确答案：B**

**解析：** 使用"选择性粘贴-文本"可以只粘贴文本内容，不包含格式。或者使用"清除格式"功能清除所有格式，让数据更整洁。

---

**问题2：** 如果播放量数据带有"万"字（如"1.5万"），如何转换成纯数字（15000）？

A. 手动一个一个改  
B. 使用查找替换，将"万"替换为"0000"，但要注意1.5万这种情况  
C. 使用公式：`=VALUE(SUBSTITUTE(A1,"万",""))*10000`  
D. B和C都可以

**正确答案：D**

**解析：** 查找替换和公式都可以处理，但查找替换对于"1.5万"这种小数需要手动处理，公式更准确。

---

### 步骤四：方法二：Excel"从Web获取数据"（20分钟）

#### 4.1 实战操作：从网页导入表格数据

**立即动手：**

1. **打开Excel**
   - 新建一个工作簿

2. **点击"数据"选项卡**
   - 在Excel顶部找到"数据"选项卡
   - 用鼠标左键单击"数据"选项卡

3. **选择"获取数据" → "从Web"**
   - 在"数据"选项卡中，找到"获取数据"或"获取外部数据"区域
   - 点击"从Web"按钮（图标可能是一个地球或网页）
   - 会弹出"从Web"对话框

4. **输入网址**
   - 在对话框中输入网页地址
   - 例如：豆瓣电影Top250的网址
   - 或者老师提供的示例网页地址
   - 点击"确定"或"导入"

5. **选择表格**
   - Excel会自动识别网页中的表格
   - 会显示一个导航器窗口，列出所有找到的表格
   - 点击表格名称，可以预览表格内容
   - 选择需要的表格（勾选复选框）
   - 点击"加载"按钮

6. **数据导入完成**
   - 数据会自动导入到Excel工作表中
   - 数据会以"表"的形式存在，可以刷新更新

**💡 提示：**
- 如果Excel无法识别表格，可能是网页使用了动态加载技术（JavaScript）
- 可以尝试复制网页源代码中的表格部分
- 或者使用方法一（手动复制粘贴）

#### 4.2 刷新数据（可选）

**如果数据需要更新：**
- 右键点击数据表格
- 选择"刷新"
- Excel会重新从网页获取最新数据

#### 4.3 练习任务

**任务要求：**
- 从提供的网页链接中使用"从Web获取数据"功能导入数据
- 或者尝试从其他包含表格的网页导入
- 时间：8分钟

**💡 提示：**
- 如果"从Web获取数据"无法连接，可能是：
  1. 网络连接问题，检查是否能正常打开网页
  2. 网站屏蔽了Excel的访问，尝试其他方法
  3. 网页使用了动态加载技术（JavaScript），Excel无法识别

#### 📝 课堂问答：Excel从Web获取数据

完成上述操作后，请回答以下问题：

**问题1：** Excel"从Web获取数据"功能显示"无法连接"，可能的原因是什么？

A. 网络连接问题  
B. 网站屏蔽了Excel的访问  
C. 网页使用了动态加载技术（JavaScript），Excel无法识别  
D. 以上都可能是原因

**正确答案：D**

**解析：** Excel"从Web获取数据"功能无法连接可能有多种原因，包括网络问题、网站限制、网页技术限制等。需要逐一排查。

---

**问题2：** Excel"从Web获取数据"功能最适合什么场景？

A. 抓取网页中的图片  
B. 抓取网页中的表格数据，且需要定期更新  
C. 抓取网页中的视频  
D. 抓取所有类型的网页数据

**正确答案：B**

**解析：** Excel"从Web获取数据"功能最适合抓取网页中的表格数据，特别是需要定期更新的数据（如股票行情、天气数据等），因为可以设置自动刷新。

---

### 步骤五：实战练习（30分钟）

#### 5.1 实战任务

**任务目标：**
从B站（或其他网站）获取50条热门视频数据，包含以下字段：
- 视频标题
- UP主名称
- 播放量
- 点赞数（可选）
- 投币数（可选）
- 收藏数（可选）
- 评论数（可选）
- 发布时间（可选）

**任务要求：**
1. 至少尝试2种抓取方法（手动复制粘贴 + Excel从Web获取数据）
2. 数据保存到Excel并初步整理
3. 字段名称规范（如"播放量"而不是"play"）
4. 记录数据来源（B站+抓取日期）
5. 在Excel中添加一行说明：数据来源、抓取日期、数据条数

**💡 提示：**
- 如果无法从B站抓取，可以使用其他网站（如豆瓣电影、知乎热榜等）
- 或者使用老师提供的示例数据：`任务1-B站热门视频数据.csv`
- 2人一组，互相讨论和帮助

#### 5.2 向AI求助

**遇到问题时，向AI提问：**

**提问示例：**
```
Excel粘贴数据后格式混乱，有哪些方法可以快速整理？
```

```
B站的播放量数据带有"万"字，如何用Excel公式转换成纯数字？
```

```
Excel"从Web获取数据"功能无法识别网页表格，可能是什么原因？有什么替代方案？
```

**要求：**
- 每个学生至少向AI提问1个实际遇到的问题
- 记录AI的解决方案
- 和同学分享AI的回答

#### 5.3 数据整理

**整理要求：**
1. **规范字段名称**
   - 使用中文命名（如"播放量"而不是"play"）
   - 字段名称清晰易懂

2. **添加数据说明**
   - 在Excel第一行或单独的工作表中添加：
     - 数据来源：________________
     - 抓取日期：________________
     - 数据条数：________________
     - 抓取方法：________________

3. **检查数据质量**
   - 是否有空值？
   - 是否有格式不一致的地方？
   - 是否需要清洗？

---

### 步骤六：成果展示与总结（15分钟）

#### 6.1 分享你的成果

**展示内容：**
1. 展示抓取的数据表格（截图或直接展示）
2. 说明使用的抓取方法和过程
3. 分享遇到的困难和解决方法
4. 分享一个有趣的数据发现（如播放量最高的视频）

**💡 提示：**
- 可以截图数据表格
- 可以分享AI帮助解决的问题
- 可以分享数据中的有趣发现

#### 6.2 知识回顾

**今天学会的3种数据抓取方法：**
1. **手动复制粘贴**：简单快速，适合少量数据（<50条）
2. **Excel"从Web获取数据"**：适合表格数据，可刷新更新
3. **专业工具**：适合大量数据和复杂需求（今天只了解，不要求掌握）

**重要提醒：**
- ✅ 数据抓取要合法合规，尊重Robots协议
- ✅ 抓取的数据要注明来源和日期
- ✅ 遇到问题优先向AI求助
- ❌ 不能抓取个人隐私、商业机密
- ❌ 不能用于商业用途或恶意目的

---

## 📝 作业要求

### 提交内容

**文件1：数据表格**
- Excel文件，包含抓取的50条数据
- 文件命名：`学号_姓名_任务1_数据.xlsx`
- 要求：
  - 至少50条数据
  - 字段名称规范（中文）
  - 包含数据说明（来源、日期、条数）

**文件2：数据来源说明**
- Word文档或文本文件
- 文件命名：`学号_姓名_任务1_说明.docx`
- 内容要求（至少100字）：
  ```
  数据来源：________________
  抓取日期：________________
  抓取方法：________________
  数据条数：________________
  
  抓取过程说明：
  （描述你使用的抓取方法、遇到的困难、如何解决的）
  
  数据发现：
  （分享一个有趣的数据发现，如播放量最高的视频、最受欢迎的UP主等）
  ```

**文件3：AI学习记录（可选，加分项）**
- 截图或文字记录
- 文件命名：`学号_姓名_任务1_AI记录.docx`
- 内容：向AI提问的问题和AI的回答

### 提交方式
- 上传到课程平台指定位置
- 截止时间：下次上课前

### 加分项（可选）
- 向AI提问3个以上关于网页数据抓取的问题
- 尝试使用专业工具（如八爪鱼采集器）抓取数据
- 发现并解决数据抓取中的特殊问题

---

## ❓ 常见问题

### Q1: Excel"从Web获取数据"显示"无法连接"怎么办？
**A:** 可能原因：
1. 网络连接问题，检查是否能正常打开网页
2. 网站屏蔽了Excel的访问，尝试其他方法
3. 网页使用了动态加载技术（JavaScript），Excel无法识别

**解决方法：**
- 检查网络连接
- 尝试其他网页
- 使用方法一（手动复制粘贴）

---

### Q2: 复制粘贴后数据全挤在一列怎么办？
**A:** 使用"数据"选项卡中的"分列"功能：
1. 选中数据列
2. 点击"数据" → "分列"
3. 选择分隔符（空格、制表符等）
4. 完成分列

---

### Q3: 如何处理播放量中的"万"字？
**A:** 方法1：查找替换
- 按 `Ctrl+H`，查找"万"，替换为"0000"
- 注意：1.5万需要手动处理成15000

方法2：使用公式
```excel
=VALUE(SUBSTITUTE(A1,"万",""))*10000
```

---

### Q4: 抓取数据是否侵权？
**A:** 判断标准：
- 查看网站Robots协议（网址/robots.txt）
- 公开数据、统计数据一般可以抓取
- 个人隐私、商业机密不可抓取
- 不能用于商业用途或恶意目的
- 建议：仅用于学习研究，注明数据来源

---

### Q5: 如何查看网站的Robots协议？
**A:** 在网址后加 `/robots.txt`
例如：https://www.bilibili.com/robots.txt

---

### Q6: 网页没有表格，怎么抓取数据？
**A:** 
- 如果网页没有表格结构，Excel"从Web获取数据"可能无法识别
- 可以使用手动复制粘贴
- 或者使用专业工具（如八爪鱼采集器）
- 或者使用老师提供的示例数据

---

## 💡 学习提示

1. **多尝试**：不同的网站、不同的方法，多试试才能找到最适合的
2. **遇到问题问AI**：AI是很好的学习助手，遇到问题先问AI
3. **记录数据来源**：养成注明数据来源的好习惯
4. **遵守规则**：数据抓取要合法合规，不要违反Robots协议

---

## 🎯 自我检查

完成本任务后，请检查：

- [ ] 理解了网页数据的类型和抓取方法
- [ ] 了解了数据抓取的合法性问题
- [ ] 学会了手动复制粘贴网页数据
- [ ] 学会了使用Excel"从Web获取数据"功能
- [ ] 成功抓取了50条数据并整理到Excel
- [ ] 向AI提问了至少1个问题
- [ ] 完成了作业提交（数据表格+说明文档）

---

**完成了吗？恭喜你！你已经学会从网页抓取数据了！** 🎉

**下次课我们会学习如何寻找公开数据集，记得保存好今天抓取的数据！**

