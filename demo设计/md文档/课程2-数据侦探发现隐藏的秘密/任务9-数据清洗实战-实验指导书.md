# 任务9：数据清洗实战

> ### ✅ 快速操作清单
> 1. 复制 `任务9-综合脏数据.csv` → 新建 Excel 工作簿，立刻“另存为”备份。
> 2. 先完成“数据质量诊断表”三件事：统计缺失/异常/重复 + 记录格式问题。
> 3. 画出自己的“清洗顺序 + 方法”迷你流程（可直接用表格），再开始动数据。
> 4. 按“重复→缺失→异常→格式→验证”执行，每完成一步就截图 + 记录。
> 5. 计算保留率、更新质量评分，把诊断表、清洗报告、最终数据一起交。
> 
> `[截图：诊断表+清洗方案+保留率示例（待补充）]`

---

## 📌 学习目标（课程2 · 模块二 · 任务9/9）

通过本任务的学习，你将能够：

1. **知识目标**
   - 理解数据清洗的标准流程
   - 掌握数据质量诊断的方法
   - 理解四大清洗方法的综合应用顺序
   - 掌握数据清洗报告的撰写规范

2. **技能目标**
   - 能够对数据集进行全面的质量诊断
   - 能够制定完整的数据清洗方案
   - 能够综合运用缺失值、异常值、格式、重复值处理方法
   - 能够验证清洗结果，计算数据保留率
   - 能够撰写规范的数据清洗报告

3. **素养目标**
   - 培养对数据质量的敏感度和责任感
   - 树立"垃圾进，垃圾出"的数据质量意识
   - 养成清洗前备份、清洗后验证的习惯
   - 培养流程化、标准化的工作方式

---

## ⏰ 任务时间

- **总时长**：2学时（90分钟）
- **建议分配**：
  - 课程导入与理论讲解：30分钟
  - 方法演示：20分钟
  - 实战练习：30分钟
  - 成果展示与总结：10分钟

---

## 🛠️ 准备工作

### 必备工具
- [ ] Excel 2016及以上版本 或 WPS Office
- [ ] AI助手账号（ChatGPT/文心一言/通义千问，至少一个）

> **AI 速用提醒**：向 AI 说明“我在做数据清洗五步法，现在在第 X 步，遇到 XX 列异常，请按 Excel 步骤指导”，并附表头/截图，它能更快提供可照抄的操作。

### 📁 数据文件
**重要：请从课程数据文件夹中下载以下文件！**

- `任务9-综合脏数据.csv`（80条订单数据，包含多种数据质量问题）

---

## 📋 操作步骤

### 步骤一：课程导入（10分钟）

#### 1.1 案例导入

**案例导入：**
"某电商公司因数据质量问题导致的损失"
- 问题：数据中存在大量重复订单、缺失金额、异常数量
- 后果：分析结果严重失真，营销活动失败，损失50万

**对比展示：**
- 报告A：基于未清洗数据 → 平均订单300元，重复购买率80%
- 报告B：基于清洗后数据 → 平均订单250元，重复购买率35%

#### 1.2 任务发布

**今天你是数据侦探，接到一批问题数据需要清洗**
- 完成数据质量诊断
- 制定并执行清洗方案
- 数据保留率>70%
- 撰写清洗报告

---

### 步骤二：理论讲解（20分钟）

#### 2.1 数据清洗标准流程（五步法）

**步骤1：数据质量诊断**
目的：全面了解数据质量状况

诊断内容：
1. 数据概况：多少行、多少列、字段含义
2. 缺失值诊断：统计缺失数量和占比
3. 异常值诊断：箱线图识别、逻辑检查
4. 格式问题诊断：日期、数值、文本格式
5. 重复值诊断：完全重复、部分重复
6. 生成诊断报告：汇总问题、评估质量

**步骤2：制定清洗方案**
目的：确定每个问题的处理方法和优先级

方案内容：
1. 列出所有问题并分类
2. 确定处理方法（删除/填充/修正/保留）
3. 确定处理顺序（重要！）
4. 预估清洗影响（保留率）

**标准处理顺序：**
```
① 删除完全重复行（最优先）
② 处理缺失值（删除/填充）
③ 处理异常值（删除/修正）
④ 统一格式（标准化）
⑤ 数据验证（最后检查）
```

**步骤3：执行清洗**
目的：按方案执行清洗操作

操作规范：
1. 备份原始数据（必须！）
2. 按顺序执行清洗
3. 每步记录操作

**步骤4：验证和记录**
验证内容：
1. 数据完整性验证：无缺失、逻辑正确
2. 数据准确性验证：无异常、格式统一
3. 统计验证：计算数据保留率
4. 抽样检查：随机抽10-20行人工检查

**步骤5：生成清洗报告**
报告结构：
- 一、原始数据概况
- 二、数据质量问题
- 三、清洗方案
- 四、清洗过程
- 五、清洗结果（保留率+质量评分）
- 六、结论与建议

#### 2.2 数据质量评分标准

**评分维度（5个）：**

1. 完整性 - 20分
   - 缺失值占比<5%: 20分
   - 缺失值占比5-10%: 15分
   - 缺失值占比>20%: 5分

2. 准确性 - 30分
   - 无异常值: 30分
   - 异常值<5%: 25分
   - 异常值>10%: 10分

3. 一致性 - 20分
   - 格式完全统一: 20分
   - 格式基本统一: 15分

4. 唯一性 - 15分
   - 无重复值: 15分
   - 重复<3%: 12分

5. 时效性 - 15分
   - 数据新鲜: 15分
   - 数据较旧: 10分

**总分评级：**
- 90-100分：优秀，无质量问题
- 80-89分：良好，少量问题已清洗
- 70-79分：中等，谨慎使用
- <60分：极差，必须重新收集

**数据保留率计算：**
```
数据保留率 = (清洗后行数 / 原始行数) × 100%

评估标准：
- >90%: 优秀
- 80-90%: 良好
- 70-80%: 合格
- <70%: 警告
```

---

### 步骤三：方法演示（20分钟）

#### 3.1 完整清洗流程演示

**步骤1：数据质量诊断（5分钟）**

1. 查看数据概况
   - Ctrl+End查看范围（80行×10列）
   - 字段：订单号、日期、客户、产品、数量、单价、金额等

2. 统计缺失值
   ```excel
   =COUNTBLANK(B2:B81)
   ```

3. 识别异常值
   - 条件格式高亮负数
   - 逻辑检查：金额 = 单价 × 数量?
   - 箱线图检测极端值

4. 查找重复值
   - 条件格式 → 突出显示重复值

5. 检查格式问题
   - 日期格式不统一
   - 金额包含文本

**生成诊断报告：**
```
原始数据：80行×10列

问题统计：
1. 缺失值：16个（2.0%）
2. 异常值：8个（10%）
3. 重复值：10行（12.5%）
4. 格式问题：日期、金额不统一

质量评分：65分（较差）
```

**步骤2：制定清洗方案（2分钟）**

```
处理顺序和方法：
1. 删除重复值：预计删除10行
2. 处理缺失值：删除关键字段缺失行8行
3. 处理异常值：删除异常3行
4. 统一格式：日期和金额

预计保留率：59/80 = 73.8% ✓
```

**步骤3：执行清洗（10分钟）**

1. 备份数据
2. 删除重复值 → 剩余70行
3. 处理缺失值 → 剩余62行
4. 处理异常值 → 剩余59行
5. 统一格式 → 完成

**步骤4：验证结果（2分钟）**

- 检查缺失值：✓ 无缺失
- 检查异常值：✓ 数量1-500合理
- 检查重复值：✓ 未发现重复
- 检查格式：✓ 统一
- 保留率：73.8% ✓

`[截图：完整五步法操作界面（待补充）]`

---

### 步骤四：实战练习（30分钟）

**任务目标：**
打开"任务9-综合脏数据.csv"（80条订单数据）

**时间分配：**
- 诊断阶段：8分钟
- 制定方案：3分钟
- 执行清洗：12分钟
- 验证记录：5分钟
- 撰写报告：2分钟（课后完善）

**任务要求：**
1. 完成完整的五步清洗流程
2. 填写"数据质量诊断表"
3. 撰写"数据清洗报告"
4. 数据保留率≥70%
5. 数据质量评分≥80分

**提交内容：**
1. 清洗后的数据文件
2. 数据质量诊断表
3. 数据清洗报告

`[截图：数据清洗报告框架封面示例（待补充）]`

---

### 步骤五：成果展示（10分钟）

**展示内容：**
1. 数据质量诊断表（发现了哪些问题）
2. 清洗方案（如何处理的）
3. 清洗前后对比（数据量、关键指标）
4. 数据保留率和质量评分
5. 遇到的最大挑战和解决方法

---

### 步骤六：总结提升（5分钟）

**数据清洗五步流程：**
1. 诊断 → 识别问题
2. 方案 → 确定方法和顺序
3. 执行 → 备份+按序清洗
4. 验证 → 检查+计算保留率
5. 报告 → 记录+总结

**清洗标准顺序：**
```
① 重复值（最优先）
② 缺失值（影响样本量）
③ 异常值（基于完整样本）
④ 格式（最后统一）
⑤ 验证（确保质量）
```

**关键原则：**
1. 备份先行：永远先备份再操作
2. 顺序重要：按标准顺序，避免返工
3. 记录详细：每步都记录
4. 验证充分：清洗后必须验证
5. 权衡平衡：数据量 vs 数据质量

**课后任务：**
1. 完善清洗报告
2. 独立清洗"任务9-练习数据.csv"
3. 总结数据清洗经验（300字）

---

## 📚 附录

### 附录1：数据清洗流程图

```
[原始数据]
    ↓
[步骤1:诊断] → 识别问题 → 生成报告
    ↓
[步骤2:方案] → 确定方法 → 确定顺序
    ↓
[步骤3:执行] → 备份 → 按序清洗 → 记录
    ↓
[步骤4:验证] → 检查质量 → 计算保留率
    ↓
[步骤5:报告] → 撰写报告 → 归档
    ↓
[清洁数据]
```

### 附录2：数据清洗方法速查表

| 问题类型 | 识别方法 | 处理方法 | Excel操作 |
|---------|---------|---------|----------|
| 完全空白 | 筛选→(空白) | 删除行 | 筛选空白→删除 |
| 部分空白 | COUNTBLANK | 填充 | =AVERAGE() |
| 逻辑异常 | 人工检查 | 删除行 | 筛选→删除 |
| 统计异常 | 箱线图 | 标记或删除 | 插入箱线图 |
| 完全重复 | 删除重复项 | 删除 | 数据→删除重复项 |
| 日期不统一 | 人工观察 | 查找替换 | TEXT函数 |
| 数字含文本 | ISNUMBER | 分列或公式 | VALUE函数 |

### 附录3：常见问题FAQ

**Q1: 数据清洗一定要按"重复→缺失→异常→格式"的顺序吗?**
A: 建议按标准顺序，这是经过实践验证的最优顺序。
- 重复值最优先：避免缺失值统计翻倍
- 缺失值第二：删除后样本量确定
- 异常值第三：基于完整样本判断更准确
- 格式最后：前面操作可能改变格式

**Q2: 缺失值占比多少可以填充，多少应该删除?**
A: 没有绝对标准，参考指南：
- <5%：可填充或删除
- 5-20%：优先填充
- >50%：建议放弃该字段

**Q3: 如何判断异常值是错误还是真实极值?**
A: 判断方法：
1. 业务逻辑判断（最重要）
2. 统计方法判断（IQR、3σ）
3. 结合其他字段分析
4. 向AI求助

### 附录4：数据保留率预估

```
原始数据：100行

清洗过程：
- 删除重复值：10行
- 删除缺失值：8行
- 删除异常值：5行

清洗后：77行
保留率 = 77/100 = 77%（合格）
```

---

## 🆘 常见卡点应急
- **诊断时不知道写什么**：把 COUNTBLANK、重复项、条件格式的截图贴进诊断表即可，不必长篇文字。
- **清洗顺序乱了**：在 Excel “任务说明”工作表先列 1-5 步，做完一项就勾掉，防止回头重复劳动。
- **保留率 <70%**：回到处理记录，看看是否某一步删太狠，能否换成填充/修正；必要时向 AI 说明“想提高保留率”请它给替代方案。
- **报告写不动**：直接把课堂的“诊断→方案→执行→验证”截图插进 Word，再为每张图写 1-2 句解释即可。
- **多人协同版本乱**：约定只有“清洗负责人”动原表，其他同学写报告或做 PPT，避免互相覆盖。

---

## 📂 成果示例提示
- Excel：`[截图：工作簿包含“原始/诊断/清洗后/记录”工作表示例（待补充）]`
- Word/PPT 清洗报告：`[截图：目录+关键数据保留率页示例（待补充）]`
- 展示截屏：`[截图：清洗前后对比图示例（待补充）]`

> 老师会选 1 组现场 Demo，提前把“保留率计算单元格 + 质量评分表”标颜色，方便快速展示。

---

**祝你学习愉快！** 🎉