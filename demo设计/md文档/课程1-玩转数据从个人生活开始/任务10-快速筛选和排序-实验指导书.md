# 任务10：快速筛选和排序

## 📌 学习目标

通过本任务的学习，你将能够：

1. **知识目标**
   - 了解数据筛选和排序的基本原理
   - 掌握自动筛选、高级筛选的使用方法
   - 理解多级排序的逻辑

2. **技能目标**
   - 能够使用自动筛选快速查找数据
   - 能够使用高级筛选实现复杂条件
   - 能够进行多级排序和自定义排序

3. **素养目标**
   - 培养数据探索的主动性
   - 建立结构化思维能力
   - 养成数据分析的良好习惯

---

## ⏰ 任务时间

- **总时长**：2学时（90分钟）
- **建议分配**：
  - 认识筛选和排序：10分钟
  - 自动筛选：25分钟
  - 多条件组合筛选：15分钟
  - 排序：20分钟
  - 实用技巧：15分钟
  - 综合实战：5分钟

---

## 🛠️ 准备工作

### 必备工具
- [ ] Excel 2016及以上版本 或 WPS Office
- [ ] 任务1的示例数据文件（任务1-示例网购数据.csv）
- [ ] 课程提供的练习数据（如有）

---

## 📋 操作步骤

### 步骤一：认识筛选和排序（10分钟）

#### 1.1 场景导入

**常见需求场景：**

```
场景1：你想找出所有在"Apple官方旗舰店"购买的订单
场景2：你想看看消费最高的前10笔订单
场景3：你想找出1月份金额大于500元的所有订单
场景4：你想按店铺分类，每个店铺内再按金额排序

怎么做？一条一条找？太慢了！
用筛选和排序，几秒搞定！
```

**思考：** 你在分析数据时，遇到过这些需求吗？

#### 1.2 基本概念

**筛选（Filter）：**
```
目的：从数据中找出符合条件的记录
特点：隐藏不符合的行，只显示需要的
原则：不改变数据位置，可随时取消
结果：只显示符合条件的行
```

**排序（Sort）：**
```
目的：按照一定规则重新排列数据
特点：改变行的顺序
原则：操作后难以恢复原顺序（需要添加序号列）
结果：数据按指定规则重新排列
```

**两者结合使用：**
```
先筛选 → 再排序 → 得到精准结果

示例：
1. 筛选出Apple店铺的订单
2. 按金额降序排列
3. 结果：Apple店铺最贵的商品
```

**你的任务：**
1. 理解筛选和排序的区别
2. 思考：什么时候用筛选？什么时候用排序？

---

### 步骤二：自动筛选（25分钟）

#### 2.1 开启筛选

**方法1：菜单操作**
```
步骤：
1. 点击数据区域任意单元格
   - 将鼠标指针移动到数据区域的任意一个单元格上（例如A2、B3等）
   - 用鼠标左键单击该单元格
   - 确保选中的单元格在数据区域内（不是空白区域）

2. 点击"数据"选项卡
   - 在Excel窗口顶部找到"数据"选项卡（在"开始"、"插入"等选项卡的右边）
   - 用鼠标左键单击"数据"选项卡
   - 选项卡下方的工具栏会显示数据相关的功能按钮

3. 点击"筛选"按钮
   - 在"数据"选项卡的工具栏中找到"筛选"按钮（图标是一个漏斗形状）
   - 用鼠标左键单击"筛选"按钮
   - 按钮会变成高亮状态（表示已启用）

4. 标题行出现下拉箭头 ✓
   - 第一行（标题行）的每个列标题右边会出现一个下拉箭头（小三角形）
   - 这表示筛选功能已成功开启
```

**方法2：快捷键**
```
步骤：
1. 点击数据区域任意单元格（确保光标在数据区域内）

2. 同时按下键盘上的三个键：
   - 先按住Ctrl键（不要松开）
   - 再按住Shift键（不要松开）
   - 最后按L键
   - 然后同时松开三个键

3. 标题行会出现下拉箭头，表示筛选已开启
   - 再次按Ctrl+Shift+L可以关闭筛选
```

**关闭筛选：**
```
方法1：再次点击"筛选"按钮
步骤：
1. 点击"数据"选项卡
2. 再次点击"筛选"按钮（按钮会取消高亮状态）
3. 标题行的下拉箭头会消失

方法2：再次按快捷键
步骤：
1. 确保光标在数据区域内
2. 再次按Ctrl+Shift+L
3. 筛选功能会关闭，下拉箭头消失
```

**注意事项：**
- ✅ 确保第一行是标题行
- ✅ 数据中间不能有完全空白的行列
- ✅ 建议先冻结首行（视图 → 冻结窗格）

**你的任务：**
1. 打开你的消费数据文件
2. 开启筛选功能
3. 观察标题行的下拉箭头

#### 📝 课堂问答：自动筛选

完成上述操作后，请回答以下问题：

**问题1：** 在Excel中，开启筛选功能的快捷键是什么？

A. Ctrl+F  
B. Ctrl+Shift+L  
C. Ctrl+S  
D. Ctrl+A

**正确答案：B**

**解析：** 在Excel中，按Ctrl+Shift+L可以快速开启或关闭筛选功能。也可以点击"数据"选项卡 → "筛选"按钮来开启筛选。

---

**问题2：** 开启筛选功能时，需要注意什么？

A. 确保第一行是标题行，数据中间不能有完全空白的行列  
B. 没有要求  
C. 数据必须排序  
D. 数据必须格式化

**正确答案：A**

**解析：** 开启筛选功能时，需要确保第一行是标题行（筛选会在标题行显示下拉箭头），数据中间不能有完全空白的行列（空白行列会中断数据区域）。建议先冻结首行，方便查看标题。

---

**问题3：** 筛选和排序的区别是什么？

A. 筛选是隐藏不符合条件的数据，排序是重新排列数据顺序  
B. 两者功能相同  
C. 筛选是排序的一种  
D. 排序是筛选的一种

**正确答案：A**

**解析：** 筛选是隐藏不符合条件的数据，只显示符合条件的数据，不改变数据的顺序；排序是重新排列数据的顺序（升序或降序），显示所有数据。两者功能不同，用途也不同。

---

#### 2.2 文本筛选

**场景1：筛选特定店铺**

**任务：** 找出所有"Apple官方旗舰店"的订单

**操作步骤：**
```
步骤：
1. 点击"店铺"列的下拉箭头
   - 找到"店铺"列（列标题是"店铺"）
   - 在列标题右边找到下拉箭头（小三角形）
   - 用鼠标左键单击该下拉箭头
   - 会弹出一个筛选菜单

2. 取消"全选"（点击取消勾选）
   - 在筛选菜单顶部，找到"全选"选项
   - "全选"前面有一个方框，里面有一个勾（✓）
   - 用鼠标左键单击这个方框，取消勾选
   - 所有店铺的勾选都会被取消

3. 只勾选"Apple官方旗舰店"
   - 在筛选菜单的列表中，找到"Apple官方旗舰店"选项
   - 用鼠标左键单击"Apple官方旗舰店"前面的方框，打上勾（✓）
   - 只有这一个选项被勾选

4. 点击"确定"
   - 在筛选菜单底部找到"确定"按钮
   - 用鼠标左键单击"确定"按钮
   - 菜单会关闭，筛选生效
```

**结果：** 只显示该店铺的订单，其他行被隐藏
- 工作表中只显示"Apple官方旗舰店"的订单
- 其他店铺的订单行会被隐藏（不是删除，只是不显示）
- 行号会变成蓝色，表示有数据被隐藏

**取消筛选：**
```
方法1：清除筛选
步骤：
1. 点击"店铺"列的下拉箭头
2. 在筛选菜单中找到"从[店铺]中清除筛选"选项
3. 用鼠标左键单击该选项
4. 筛选会被清除，所有数据重新显示

方法2：全选
步骤：
1. 点击"店铺"列的下拉箭头
2. 在筛选菜单顶部，点击"全选"方框（打上勾）
3. 点击"确定"按钮
4. 所有数据重新显示
```

**场景2：文本筛选（模糊匹配）**

**任务：** 筛选商品名称包含"手机"的记录

**操作步骤：**
```
1. 点击"商品名称"列的下拉箭头
2. 选择"文本筛选"
3. 选择"包含"
4. 输入"手机"
5. 点击"确定"
```

**文本筛选选项：**
```
- 等于：完全匹配
- 不等于：排除指定值
- 包含：模糊匹配（最常用）
- 不包含：排除包含某文本的记录
- 开始于：以某文本开头
- 结束于：以某文本结尾
```

**你的任务：**
1. 筛选出某一个店铺的所有订单
2. 筛选商品名称包含"衣服"的记录
3. 筛选店铺名称以"官方"开头的记录
4. 向AI提问：文本筛选的各个选项有什么区别？

**向AI提问模板：**
```
"Excel的文本筛选中，'等于'、'包含'、'开始于'有什么区别？
什么时候用哪个？"
```

#### 2.3 数字筛选

**场景1：筛选大于某值的记录**

**任务：** 找出金额大于500元的订单

**操作步骤：**
```
1. 点击"金额"列的下拉箭头
2. 选择"数字筛选"
3. 选择"大于"
4. 输入500
5. 点击"确定"
```

**数字筛选选项：**
```
- 等于：完全匹配
- 不等于：排除指定值
- 大于：大于某值
- 大于或等于：≥某值
- 小于：小于某值
- 小于或等于：≤某值
- 介于：在范围内
- 前10项：Top N（最常用）
```

**场景2：筛选范围**

**任务：** 找出金额在500-1000之间的订单

**操作步骤：**
```
1. 金额列下拉 → 数字筛选 → 介于
2. 输入最小值：500
3. 输入最大值：1000
4. 点击"确定"
```

**场景3：筛选前N项**

**任务：** 找出金额最高的前10项

**操作步骤：**
```
1. 金额列下拉 → 数字筛选 → 前10项
2. 选择"最大"（或"最小"）
3. 输入数量：10
4. 选择"项"（或"百分比"）
5. 点击"确定"
```

**你的任务：**
1. 筛选金额大于平均值的订单
   - 提示：先用AVERAGE函数计算平均值
   - 然后筛选大于该值的记录
2. 筛选金额在100-300之间的订单
3. 筛选金额最高的前10项
4. 筛选金额最低的5项

#### 2.4 日期筛选

**场景1：筛选特定月份**

**任务：** 找出1月份的所有订单

**方法1：直接勾选（简单）**
```
1. 日期列下拉
2. 展开年份（点击年份前的+）
3. 展开月份（点击月份前的+）
4. 只勾选1月的日期
5. 确定
```

**方法2：日期筛选（推荐）**
```
1. 日期列下拉 → 日期筛选
2. 选择预设条件：
   - 今天
   - 昨天
   - 本周
   - 上周
   - 本月
   - 上月
   - 本季度
   - 上季度
   - 今年
   - 去年
```

**方法3：自定义日期范围**
```
1. 日期筛选 → 自定义筛选
2. 选择"介于"
3. 输入起始日期：2024-01-01
4. 输入结束日期：2024-01-31
5. 确定
```

**你的任务：**
1. 筛选出最近一周的订单
2. 筛选1月份的所有订单
3. 筛选某个日期之后的所有订单
4. 筛选某个日期范围内的订单

---

### 步骤三：多条件组合筛选（15分钟）

#### 3.1 AND逻辑（同时满足）

**场景：** 找出1月份且金额大于500的订单

**操作步骤：**
```
1. 先筛选日期：1月份
2. 再筛选金额：>500
3. 结果：同时满足两个条件的记录
```

**逻辑：** 条件1 AND 条件2（两个条件都要满足）

**你的任务：**
1. 找出"Apple店铺"且"金额大于1000"的订单
2. 找出"某个月"且"某类商品"的订单
3. 尝试组合3个条件

#### 3.2 OR逻辑（满足其一）

**场景1：多个值选择**

**任务：** 找出Apple店铺或Samsung店铺的订单

**操作步骤：**
```
1. 店铺列下拉
2. 勾选"Apple官方旗舰店"
3. 勾选"Samsung旗舰店"
4. 确定

结果：显示两个店铺的订单
```

**逻辑：** 条件1 OR 条件2（满足其中一个即可）

**场景2：复杂OR逻辑**

**任务：** 找出金额<100 或 >1000的订单（排除100-1000）

**操作步骤：**
```
1. 金额列下拉 → 数字筛选 → 自定义筛选
2. 第一行：小于 100
3. 选择"或"（不是"与"）
4. 第二行：大于 1000
5. 确定
```

**你的任务：**
1. 筛选出多个店铺的订单（OR逻辑）
2. 筛选出金额小于50或大于500的订单
3. 尝试组合AND和OR逻辑

#### 3.3 高级筛选（选学）

**场景：** 复杂条件（金额>500 且店铺=Apple）或（金额>1000）

**操作步骤：**

**步骤1：建立条件区域**
```
在数据区域上方建立条件区域：

A1: 金额    B1: 店铺      （标题行，必须与数据列名一致）
A2: >500   B2: Apple     （条件1：同一行表示AND）
A3: >1000                （条件2：不同行表示OR）
```

**步骤2：执行高级筛选**
```
1. 选中数据区域（包含标题行）
2. 数据 → 高级筛选
3. 列表区域：选择数据区域（如A10:D100）
4. 条件区域：选择条件区域（如A1:B3）
5. 选择"在原有区域显示筛选结果"或"将筛选结果复制到其他位置"
6. 确定
```

**逻辑说明：**
- 同一行的条件：AND（同时满足）
- 不同行的条件：OR（满足其一）

**你的任务：**
1. 了解高级筛选的基本用法
2. 尝试设置一个简单的条件区域
3. 向AI提问：高级筛选的条件区域如何设置？

**向AI提问：**
```
"Excel的高级筛选中，如何设置条件区域？
同一行的条件和不同行的条件有什么区别？"
```

---

### 步骤四：排序（20分钟）

#### 4.1 单列排序

**场景：** 按金额排序，找出最贵的订单

**方法1：快速排序（推荐）**
```
步骤：
1. 点击金额列任意单元格
   - 找到"金额"列（或"实付款"列）
   - 用鼠标左键单击该列的任意一个数据单元格（例如C2、C3等，不要点击标题行）
   - 确保选中的单元格在数据区域内

2. 点击"数据"选项卡 → 升序/降序按钮
   - 在Excel窗口顶部找到"数据"选项卡，用鼠标左键单击
   - 在"数据"选项卡的工具栏中，找到"升序"或"降序"按钮
     * "升序"按钮：图标是A→Z，从小到大排列
     * "降序"按钮：图标是Z→A，从大到小排列
   - 用鼠标左键单击相应的按钮
   - 数据会立即按选择的顺序重新排列

或者使用右键菜单：
   - 用鼠标右键单击金额列的任意单元格
   - 在右键菜单中找到"排序"选项，用鼠标左键悬停（不要点击）
   - 会弹出子菜单，选择"升序"或"降序"
   - 用鼠标左键单击选择

注意：会影响整行数据（Excel会自动扩展选择）
   - Excel会自动识别数据区域，整行数据会一起移动
   - 不会只排序金额列，其他列不动（这样数据不会错乱）
```

**方法2：自定义排序**
```
步骤：
1. 选中整个数据区域（包含标题行）
   - 将鼠标指针移动到数据区域的第一个单元格（通常是A1）
   - 按住鼠标左键，拖动到数据区域的最后一个单元格
   - 松开鼠标左键，整个数据区域会被选中（显示为蓝色背景）

2. 点击"数据"选项卡 → "排序"
   - 在Excel窗口顶部找到"数据"选项卡，用鼠标左键单击
   - 在"数据"选项卡的工具栏中找到"排序"按钮
   - 用鼠标左键单击"排序"按钮
   - 会弹出"排序"对话框

3. 设置排序条件
   - 在"主要关键字"下拉菜单中，点击下拉箭头
   - 在列表中找到"金额"（或"实付款"），用鼠标左键单击选择
   - 在"排序依据"下拉菜单中，选择"数值"（用鼠标左键单击）
   - 在"次序"下拉菜单中，选择"降序"（从大到小）或"升序"（从小到大）
   - 用鼠标左键单击选择

4. 点击"确定"按钮
   - 在对话框右下角找到"确定"按钮
   - 用鼠标左键单击"确定"按钮
   - 对话框会关闭，数据会按设置的条件重新排列
```

**排序选项：**
```
- 升序：从小到大（A→Z，1→9，早→晚）
- 降序：从大到小（Z→A，9→1，晚→早）
```

**⚠️ 重要提示：**
排序会改变数据顺序，难以恢复！
建议排序前先添加"序号"列（1,2,3...），需要时按序号排序即可恢复原顺序。

**你的任务：**
1. 按金额降序排列，找出最贵的订单
2. 按日期升序排列，看最早的订单
3. 按店铺名称排序（文本排序）
4. 添加序号列，然后排序，再恢复原顺序

#### 4.2 多级排序

**场景：** 先按店铺分组，再按金额排序

**需求：** 同一店铺的订单放在一起，每个店铺内按金额降序

**操作步骤：**
```
1. 数据 → 排序
2. 主要关键字：店铺（升序）
3. 点击"添加条件"
4. 次要关键字：金额（降序）
5. 确定
```

**结果示例：**
```
店铺A
  - 1500元订单
  - 800元订单
  - 200元订单
店铺B
  - 2000元订单
  - 500元订单
...
```

**三级排序示例：**

**需求：** 按月份 → 店铺 → 金额 三级排序

**操作步骤：**
```
1. 添加辅助列提取月份（如使用MONTH函数）
2. 数据 → 排序
3. 主要关键字：月份（升序）
4. 添加条件 → 次要关键字：店铺（升序）
5. 添加条件 → 第三关键字：金额（降序）
6. 确定
```

**排序逻辑：**
```
1. 先按主要关键字分组
2. 组内按次要关键字排序
3. 如果次要关键字相同，按第三关键字排序
```

**你的任务：**
1. 按"日期+金额"两级排序
2. 按"店铺+日期+金额"三级排序
3. 向AI提问：如何设计合理的排序逻辑？

**向AI提问：**
```
"我想对数据进行多级排序：
- 先按店铺分组
- 每个店铺内按日期排序
- 同一天的订单按金额排序

应该如何设置排序的关键字顺序？"
```

---

### 步骤五：实用技巧（15分钟）

#### 5.1 复制筛选结果

**场景：** 把筛选出的数据复制到新表

**方法1：直接复制（可能包含隐藏行）**
```
1. 完成筛选
2. 选中数据（Ctrl+A或手动选择）
3. 复制（Ctrl+C）
4. 切换到新工作表
5. 粘贴（Ctrl+V）

⚠️ 注意：可能包含隐藏行的数据
```

**方法2：定位可见单元格（推荐）**
```
1. 完成筛选
2. 选中筛选结果区域
3. 按Ctrl+G打开"定位"对话框
4. 点击"定位条件"
5. 选择"可见单元格"
6. 确定
7. 复制（Ctrl+C）
8. 粘贴到新位置

✅ 只复制可见的行
```

**快捷键：**
```
Alt+;  （定位可见单元格）
```

**你的任务：**
1. 筛选出某类数据
2. 使用定位可见单元格复制
3. 粘贴到新工作表
4. 对比两种方法的区别

#### 5.2 统计筛选结果

**方法1：状态栏查看（最简单）**
```
1. 完成筛选
2. 选中筛选后的数值列
3. 查看状态栏（Excel底部）：
   - 计数：显示多少条记录
   - 求和：显示总金额
   - 平均值：显示平均金额

✅ 自动更新，无需公式
```

**方法2：使用SUBTOTAL函数（推荐）**
```
=SUBTOTAL(9,C2:C100)  求和（忽略隐藏行）
=SUBTOTAL(1,C2:C100)  平均值
=SUBTOTAL(2,C2:C100)  计数（数字）
=SUBTOTAL(103,C2:C100) 计数（非空，忽略隐藏）

优势：筛选改变时，结果自动更新
```

**SUBTOTAL常用参数：**
```
109：求和（忽略隐藏）
103：计数（忽略隐藏）
101：平均值（忽略隐藏）
```

**你的任务：**
1. 筛选数据后，查看状态栏统计
2. 使用SUBTOTAL函数统计筛选结果
3. 改变筛选条件，观察统计结果的变化

#### 5.3 保存筛选视图（Excel 365/2019）

**需求：** 保存常用的筛选条件，随时切换

**操作步骤：**
```
1. 设置好筛选条件
2. 数据 → 排序和筛选 → 筛选器视图 → 保存当前筛选器
3. 命名：如"1月份大额订单"
4. 确定

使用：
随时切换到不同的筛选视图
```

**旧版本替代方案：**
- 手动记录筛选条件
- 或使用宏录制筛选过程

**你的任务：**
1. 如果使用Excel 365/2019，尝试保存筛选视图
2. 创建2-3个常用的筛选视图
3. 练习切换不同的视图

---

### 步骤六：综合实战（5分钟）

**实战任务：**

**任务1：消费分析**
```
1. 找出你消费最多的前5家店铺
   （提示：筛选 → 统计 → 排序）

2. 找出单笔消费超过500元的所有订单
   （提示：数字筛选）

3. 找出某个月的消费明细
   （提示：日期筛选）
```

**任务2：数据探索**
```
1. 按店铺分组，每组内按金额排序，找出各店铺最贵的商品
   （提示：多级排序）

2. 筛选出某类商品（如服装），统计总消费
   （提示：文本筛选 + SUBTOTAL）

3. 找出异常订单（金额特别高或特别低）
   （提示：数字筛选 > 或 <）
```

**任务3：综合查询**
```
使用筛选和排序，回答：
1. 你在哪个店铺消费次数最多？
   （筛选每个店铺 → 统计次数）

2. 哪个月消费金额最高？
   （筛选每个月 → 统计金额）

3. 你购买最多的商品类别是什么？
   （筛选每个类别 → 统计数量）
```

**你的任务：**
1. 选择2-3个任务完成
2. 记录操作步骤
3. 记录发现的结果

---

## 📝 作业要求

### 提交内容

**实践任务：**

**任务1：数据探索报告（必做）**
使用筛选和排序，分析你的消费数据，回答：

1. 你最常购买的店铺是哪个？（筛选统计）
2. 消费金额最高的5笔订单是什么？（排序）
3. 每个月的订单数量和总金额？（筛选+SUBTOTAL）
4. 你的消费有什么规律？（自由探索）

**任务2：技巧总结（必做）**
总结5个筛选排序技巧，每个包含：
- 应用场景
- 操作步骤
- 注意事项

**提交内容：**

**Excel文件：**
- 原始数据表
- 各种筛选结果表（至少5个）
- 统计汇总表（使用SUBTOTAL）

**Word文档（800字）：**
```
一、数据探索发现
   - 问题1：[筛选条件] → [发现]
     示例：筛选"Apple店铺" → 发现共15笔订单，总金额5000元
   
   - 问题2：[排序方法] → [发现]
     示例：按金额降序 → 发现最高单笔消费2000元
   
   - 问题3：[筛选+统计] → [发现]
     示例：筛选1月份 → 统计发现该月消费3000元，共20笔
   
   - 问题4：[自由探索] → [发现]
     示例：按店铺分组排序 → 发现消费集中在3家店铺

二、操作技巧
   - 技巧1：[场景+步骤+注意事项]
     示例：
     场景：筛选包含某文本的记录
     步骤：文本筛选 → 包含 → 输入文本
     注意：区分大小写，可以使用通配符
   
   - 技巧2：[场景+步骤+注意事项]
   - 技巧3：[场景+步骤+注意事项]
   - 技巧4：[场景+步骤+注意事项]
   - 技巧5：[场景+步骤+注意事项]

三、心得体会
   - 筛选排序的价值：[说明筛选排序在数据分析中的作用]
   - 遇到的问题和解决：[描述遇到的问题及解决方法]
   - AI的帮助：[AI提供了哪些帮助]
   - 学习收获：[学到了什么，有什么启发]
```

**文件命名：**
- `学号_姓名_任务10_筛选排序.xlsx`
- `学号_姓名_任务10_筛选排序.docx`

**提交截止：**下次上课前

### 加分项（可选）
- 使用高级筛选解决复杂问题
- 创建可复用的筛选模板
- 制作筛选技巧视频教程
- 帮助同学解决筛选排序问题

---

## ❓ 常见问题

### Q1: 筛选后复制粘贴，为什么包含了隐藏行？
**A:** 
- 需要使用"定位可见单元格"功能
- 按Alt+; 或 Ctrl+G → 定位条件 → 可见单元格
- 然后再复制粘贴

### Q2: 排序后如何恢复原顺序？
**A:** 
- 排序前先添加"序号"列（1,2,3...）
- 需要恢复时，按序号列排序即可
- 或使用"撤销"（Ctrl+Z），但只能撤销最近一次操作

### Q3: 筛选按钮消失了怎么办？
**A:** 
- 检查是否误删了标题行
- 重新设置筛选：数据 → 筛选
- 确保第一行是标题行

### Q4: 为什么筛选不到某些数据？
**A:** 
- 可能是格式问题（文本vs数字）
- 可能有不可见字符
- 先清洗数据（使用任务9的方法）
- 检查筛选条件是否正确

### Q5: 多级排序的顺序怎么理解？
**A:** 
- 先按主要关键字分组
- 组内再按次要关键字排序
- 如果次要关键字相同，按第三关键字排序
- 就像：先分班级，班级内按成绩排序

### Q6: SUBTOTAL和SUM有什么区别？
**A:** 
- SUM：计算所有值（包括隐藏行）
- SUBTOTAL：只计算可见行的值
- 筛选数据时，应该用SUBTOTAL

---

## 💡 学习提示

1. **先筛选再排序**：通常先筛选出需要的数据，再排序
2. **备份数据**：排序会改变顺序，建议先备份或添加序号列
3. **善用快捷键**：Ctrl+Shift+L开启筛选，Alt+;定位可见单元格
4. **验证结果**：筛选排序后，检查结果是否符合预期
5. **记录技巧**：把常用的筛选条件记录下来，方便下次使用

---

## 📚 筛选排序快捷键

| 操作 | 快捷键 | 说明 |
|------|--------|------|
| 开启/关闭筛选 | Ctrl+Shift+L | 切换筛选按钮 |
| 升序排序 | Alt+A+S+A | 快速升序 |
| 降序排序 | Alt+A+S+D | 快速降序 |
| 定位可见单元格 | Alt+; | 只选中可见行 |
| 清除筛选 | Alt+A+C | 清除所有筛选 |

---

## 📚 SUBTOTAL函数参数

| 参数 | 功能 | 包含隐藏值 | 忽略隐藏值 |
|------|------|------------|------------|
| AVERAGE | 平均值 | 1 | 101 |
| COUNT | 计数（数字） | 2 | 102 |
| COUNTA | 计数（非空） | 3 | 103 |
| MAX | 最大值 | 4 | 104 |
| MIN | 最小值 | 5 | 105 |
| SUM | 求和 | 9 | 109 |

**推荐使用：**
```
=SUBTOTAL(109,C2:C100)  求和（忽略隐藏）
=SUBTOTAL(103,A2:A100)  计数（忽略隐藏）
=SUBTOTAL(101,C2:C100)  平均值（忽略隐藏）
```

---

## 📚 筛选技巧集锦

**技巧1：快速清除单列筛选**
```
点击该列筛选箭头 → 从[列名]中清除筛选
```

**技巧2：筛选唯一值**
```
高级筛选 → 勾选"选择不重复的记录"
```

**技巧3：筛选颜色**
```
按单元格颜色筛选 → 选择指定颜色
适用于条件格式标注的数据
```

**技巧4：按选定内容筛选**
```
右键某单元格 → 筛选 → 按所选单元格的值筛选
```

**技巧5：通配符筛选**
```
文本筛选 → 包含
输入：手机*  （以"手机"开头）
输入：*旗舰店 （以"旗舰店"结尾）
输入：*手机*  （包含"手机"）
```

---

## 🎯 自我检查

完成本任务后，请检查：

- [ ] 能够开启和关闭筛选功能
- [ ] 能够进行文本筛选（等于、包含、开始于等）
- [ ] 能够进行数字筛选（大于、小于、介于、前N项等）
- [ ] 能够进行日期筛选（本月、上月、自定义范围等）
- [ ] 能够组合多个条件筛选（AND/OR逻辑）
- [ ] 能够进行单列排序（升序/降序）
- [ ] 能够进行多级排序
- [ ] 能够复制筛选结果（使用定位可见单元格）
- [ ] 能够统计筛选结果（使用SUBTOTAL）
- [ ] 完成了作业提交

---

**祝你学习顺利！** 🎉

