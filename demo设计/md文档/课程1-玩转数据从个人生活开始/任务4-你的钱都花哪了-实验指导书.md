# 任务4：你的钱都花哪了

## 📌 学习目标

通过本任务的学习，你将能够：

1. **知识目标**
   - 理解数据分类的概念和意义
   - 掌握SUMIF条件求和函数的用法
   - 了解数据透视表的基本概念

2. **技能目标**
   - 能够对数据进行手动分类标注
   - 能够使用SUMIF函数按类别统计金额
   - 能够创建简单的数据透视表
   - 能够通过分类统计发现消费规律

3. **素养目标**
   - 培养数据分类和整理的思维
   - 建立通过数据发现问题的意识
   - 学会从数据中获得行动指导

---

## ⏰ 任务时间

- **总时长**：2学时（90分钟）
- **建议分配**：
  - 问题导入与分类原则：15分钟
  - 数据分类实操：20分钟
  - SUMIF函数学习：25分钟
  - 数据透视表入门：25分钟
  - 数据分析与发现：3分钟
  - 作业完成：2分钟

---

## 🛠️ 准备工作

### 必备工具
- [ ] Excel 2016及以上版本 或 WPS Office
- [ ] 任务1的示例数据文件（任务1-示例网购数据.csv）
- [ ] AI助手账号（可选）

---

## 📋 操作步骤

### 步骤一：理解分类的意义（10分钟）

#### 1.1 问题思考

**回顾上节课：**
- 你算出了总消费和平均消费
- 但你知道这钱都花在哪了吗？

**新问题：**
```
小明的消费统计：
总消费：2000元
订单数：40单

问题：这2000元都花哪了？
- 吃的花了多少？
- 穿的花了多少？
- 学习用品花了多少？
```

**为什么要分类？**
- 不知道钱花在哪里，就很难知道怎么省钱
- 分类统计能帮你发现"吞金兽"类别
- 数据分类是数据分析的基础技能

#### 1.2 分类的基本原则

**原则1：互斥性**
- 每个商品只能属于一个类别
- 不能既是"零食"又是"日用品"

**原则2：完整性**
- 所有商品都要有类别
- 实在不知道的归入"其他"

**原则3：适度性**
- 不能太细：分100个类别太复杂
- 不能太粗：只分2个类别看不出规律
- **建议：5-8个大类**

#### 📝 课堂问答：理解分类的意义

完成上述操作后，请回答以下问题：

**问题1：** 数据分类的基本原则中，"互斥性"是什么意思？

A. 每个商品可以属于多个类别  
B. 每个商品只能属于一个类别  
C. 所有商品必须属于同一类别  
D. 商品可以不分类

**正确答案：B**

**解析：** 互斥性是指每个商品只能属于一个类别，不能同时属于多个类别。例如一个商品不能既是"零食"又是"日用品"，必须明确归入一个类别。

---

**问题2：** 数据分类时，建议分为多少个类别比较合适？

A. 2-3个类别  
B. 5-8个大类  
C. 20-30个类别  
D. 越多越好

**正确答案：B**

**解析：** 分类数量要适度，太少（2-3个）看不出规律，太多（20-30个）太复杂难以管理。建议分为5-8个大类，既能看出规律又不会太复杂。

---

**问题3：** 为什么要对消费数据进行分类？

A. 分类是数据分析的基础，能发现"吞金兽"类别  
B. 分类没有实际意义  
C. 只是为了好看  
D. 分类会降低数据准确性

**正确答案：A**

**解析：** 对消费数据进行分类是数据分析的基础，可以帮助我们发现哪些类别花钱最多（"吞金兽"），从而有针对性地控制消费，这是数据分析的重要应用。

---

### 步骤二：设计分类方案（10分钟）

#### 2.1 推荐分类方案

**常见分类：**
```
1. 食品零食（零食、饮料、水果等）
2. 服装鞋包（衣服、鞋子、包包等）
3. 学习用品（书、文具、电子学习设备等）
4. 日用品（洗护、纸巾、家居等）
5. 数码电子（手机配件、耳机等）
6. 娱乐休闲（游戏、玩具、运动器材等）
7. 其他
```

#### 2.2 向AI咨询分类方案

**提问模板：**
```
"我有网购数据需要分类，商品包括[列出你的商品类型]，
请帮我设计一个合理的分类方案，不超过8个类别。"
```

**示例提问：**
```
"我有网购数据需要分类，商品包括零食、衣服、耳机、笔、化妆品等，
请帮我设计一个合理的分类方案，不超过8个类别。"
```

**AI回答示例：**
```
建议分类方案：
1. 食品饮料
2. 服饰美妆
3. 数码电子
4. 文具图书
5. 生活用品
6. 运动户外
7. 其他
```

**你的任务：**
1. 向AI描述你的数据特点
2. 获取个性化的分类建议
3. 确定自己的分类方案（5-8个类别）

---

### 步骤三：给数据添加分类（20分钟）

#### 3.1 添加分类列

**操作步骤：**
```
步骤1：在数据表最右侧添加新列
列名："商品类别"

步骤2：手动给数据分类
- 找到"商品名称"列
- 判断商品属于哪个类别
- 在"商品类别"列填写类别名称
```

**示例：**
```
商品名称            → 商品类别
三只松鼠坚果        → 食品零食
无线蓝牙耳机        → 数码电子
晨光中性笔          → 学习用品
```

#### 3.2 分类技巧

**技巧1：先分类前20条**
- 不要一次性分类所有数据
- 先分类前20条，熟悉分类标准

**技巧2：保持一致性**
- "零食"和"食品"要统一
- 建议统一使用一个名称（如都用"食品零食"）

**技巧3：不确定的归"其他"**
- 遇到难以分类的商品，先归入"其他"
- 后续可以再细分

**你的任务：**
1. 在数据表添加"商品类别"列
2. 给前20条数据手动分类
3. 确保每个类别至少有2-3条数据（便于后续统计）

#### 📝 课堂问答：给数据添加分类

完成上述操作后，请回答以下问题：

**问题1：** 在Excel中给数据添加分类列时，应该在哪里添加？

A. 在数据表最左侧  
B. 在数据表最右侧  
C. 在数据表中间  
D. 在另一个工作表

**正确答案：B**

**解析：** 添加新列时，通常放在数据表的最右侧，这样不会影响原有数据的结构，也方便查看和操作。添加后记得给新列命名（如"商品类别"）。

---

**问题2：** 手动分类数据时，如果遇到难以分类的商品，应该怎么办？

A. 跳过不分类  
B. 随便分一个类别  
C. 先归入"其他"类别，后续可以再细分  
D. 删除这条数据

**正确答案：C**

**解析：** 遇到难以分类的商品时，可以先归入"其他"类别，确保所有数据都有分类。后续如果发现"其他"类别中有规律，可以再细分或调整分类方案。

---

**问题3：** 分类时，为什么要保持类别名称的一致性？

A. 为了美观  
B. 为了后续使用SUMIF等函数时能正确匹配  
C. 没有要求  
D. 为了减少输入

**正确答案：B**

**解析：** 保持类别名称一致性非常重要，因为后续使用SUMIF函数或数据透视表时，需要精确匹配类别名称。如果同一类别用了不同名称（如"零食"和"食品"），统计时会被当作不同类别，导致结果不准确。

---

### 步骤四：学习SUMIF函数（25分钟）

#### 4.1 理解SUMIF函数

**问题：**
"现在有了类别，怎么算每个类别花了多少钱？"

**方法对比：**
- 方法1：手动筛选+SUM（费时，每个类别都要操作一次）
- 方法2：SUMIF函数（一次性解决）

#### 4.2 SUMIF函数语法

**函数结构：**
```
=SUMIF(条件范围, 条件, 求和范围)
       ↓         ↓       ↓
    在哪找   找什么    加哪列
```

**详细解释：**
```
=SUMIF(E2:E21, "食品零食", D2:D21)
        ↑         ↑         ↑
    类别列   要统计的类别  金额列

意思：在E2:E21中找到"食品零食"，把对应的D2:D21的金额加起来
```

**图示理解：**
```
    D列(金额)  E列(类别)
2   50.00     食品零食    ← 符合条件,加入
3   120.00    服装鞋包
4   30.00     食品零食    ← 符合条件,加入
5   200.00    数码电子
...

结果：50 + 30 + ... = XXX元
```

#### 4.3 实际操作

**创建分类统计表：**

```
步骤1：在新的区域创建统计表
     A列        B列
1   类别      金额
2   食品零食   =SUMIF($E$2:$E$21,"食品零食",$D$2:$D$21)
3   服装鞋包   =SUMIF($E$2:$E$21,"服装鞋包",$D$2:$D$21)
4   学习用品   =SUMIF($E$2:$E$21,"学习用品",$D$2:$D$21)
...

详细操作步骤：
1. 在数据表右侧或下方找一个空白区域（例如G1和H1）
   - 用鼠标左键单击G1单元格
   - 输入文字：类别
   - 按Tab键或右箭头键，移动到H1单元格
   - 输入文字：金额
   - 按Enter键确认

2. 在G2单元格输入第一个类别名称
   - 用鼠标左键单击G2单元格
   - 输入：食品零食
   - 按Enter键确认

3. 在H2单元格输入SUMIF公式
   - 用鼠标左键单击H2单元格
   - 输入：=SUMIF($E$2:$E$21,"食品零食",$D$2:$D$21)
   - 也可以分步输入：
     a. 先输入：=SUMIF(
     b. 用鼠标拖动选择E2:E21区域（条件范围）
     c. 按F4键，将引用改为绝对引用（$E$2:$E$21）
     d. 输入逗号：,
     e. 输入引号和条件："食品零食"
     f. 输入逗号：,
     g. 用鼠标拖动选择D2:D21区域（求和范围）
     h. 按F4键，将引用改为绝对引用（$D$2:$D$21）
     i. 输入右括号：)
   - 按Enter键确认
   - 单元格会显示"食品零食"类别的金额总和

4. 重复步骤2-3，为其他类别创建公式
   - 在G3输入：服装鞋包
   - 在H3输入：=SUMIF($E$2:$E$21,"服装鞋包",$D$2:$D$21)
   - 在G4输入：学习用品
   - 在H4输入：=SUMIF($E$2:$E$21,"学习用品",$D$2:$D$21)
   - 以此类推，为所有类别创建统计公式
```

**优化：使用单元格引用**

```
更灵活的写法：
     A列        B列
2   食品零食   =SUMIF($E$2:$E$21,A2,$D$2:$D$21)
3   服装鞋包   =SUMIF($E$2:$E$21,A3,$D$2:$D$21)

好处：修改A列的类别名称,公式自动适应
复制公式时更方便
```

**关键点：绝对引用$的使用**
- `$E$2:$E$21` - 绝对引用，复制公式时不变
- `A2` - 相对引用，复制时自动变成A3, A4...

#### 4.4 常见错误避免

**错误1：条件范围和求和范围行数不一致**
```
错误：=SUMIF(E2:E21, "零食", D2:D100)
正确：=SUMIF(E2:E21, "零食", D2:D21)
```

**错误2：条件忘记加引号**
```
错误：=SUMIF(E2:E21, 零食, D2:D21)
正确：=SUMIF(E2:E21, "零食", D2:D21)
```

**错误3：类别名称不一致**
```
数据中是"食品零食"
公式写成"零食" → 找不到，结果为0
```

**你的任务：**
1. 在新工作表创建分类统计表
2. 列出你的所有类别
3. 使用SUMIF函数计算每个类别的金额
4. 验证：所有类别金额之和 = 总消费

#### 📝 课堂问答：学习SUMIF函数

完成上述操作后，请回答以下问题：

**问题1：** SUMIF函数的语法是什么？

A. =SUMIF(条件范围, 条件, 求和范围)  
B. =SUMIF(求和范围, 条件, 条件范围)  
C. =SUMIF(条件, 条件范围, 求和范围)  
D. =SUMIF(求和范围, 条件范围, 条件)

**正确答案：A**

**解析：** SUMIF函数的语法是=SUMIF(条件范围, 条件, 求和范围)。第一个参数是在哪里找条件，第二个参数是找什么条件，第三个参数是对哪一列求和。

---

**问题2：** 在SUMIF函数中，如果条件是文本（如"食品零食"），应该怎么写？

A. =SUMIF(E2:E21, 食品零食, D2:D21)  
B. =SUMIF(E2:E21, "食品零食", D2:D21)  
C. =SUMIF(E2:E21, '食品零食', D2:D21)  
D. =SUMIF(E2:E21, [食品零食], D2:D21)

**正确答案：B**

**解析：** 在SUMIF函数中，如果条件是文本，必须用英文双引号括起来，如"食品零食"。如果不加引号，Excel会将其当作变量名，导致错误。

---

**问题3：** 在SUMIF函数中，使用$符号（如$E$2:$E$21）的作用是什么？

A. 表示绝对引用，复制公式时范围不变  
B. 表示相对引用，复制公式时范围会变  
C. 表示货币格式  
D. 没有特殊作用

**正确答案：A**

**解析：** $符号表示绝对引用，$E$2:$E$21表示无论公式复制到哪里，这个范围都不会改变。这在复制公式时非常有用，可以确保条件范围和求和范围始终正确。

---

### 步骤五：学习数据透视表（25分钟）

#### 5.1 什么是数据透视表？

**数据透视表是什么？**
- Excel的强大工具，自动完成分类统计
- 不需要写公式，拖拖拽拽就能分析数据
- 可以快速切换统计维度

**对比：**
- SUMIF：需要写公式，灵活但需要技巧
- 数据透视表：可视化操作，简单但需要理解逻辑

#### 5.2 创建数据透视表

**演示步骤：**

```
步骤1：选中数据区域（包含标题行）
- 点击数据区域任意单元格
  * 用鼠标左键单击数据表中的任意一个单元格（例如A2、B5等）
  * 不需要选中整个表格，只需要点击表格内的任意单元格即可
  * Excel会自动识别整个数据表
- 或选中整个数据表
  * 将鼠标指针移动到数据表左上角（通常是A1单元格）
  * 按住鼠标左键不松开
  * 拖动鼠标到数据表右下角（最后一个有数据的单元格）
  * 松开鼠标左键
  * 此时整个数据表被选中（显示为蓝色背景）

步骤2：插入数据透视表
- 点击"插入"选项卡
  * 在Excel顶部找到"插入"选项卡（在"开始"选项卡的右边）
  * 用鼠标左键单击"插入"选项卡
- 点击"数据透视表"
  * 在"插入"选项卡的工具栏中找到"数据透视表"按钮
  * 这个按钮通常在工具栏的左侧，可能在"表格"组中
  * 用鼠标左键单击"数据透视表"按钮
  * 会弹出一个对话框："创建数据透视表"
- 选择"新工作表"
  * 在对话框中，找到"选择放置数据透视表的位置"
  * 选择"新工作表"选项（用鼠标左键单击前面的圆圈）
  * 这样数据透视表会创建在一个新的工作表中
- 点击"确定"
  * 在对话框右下角找到"确定"按钮
  * 用鼠标左键单击"确定"按钮
  * Excel会自动创建一个新的工作表，并显示数据透视表的界面

步骤3：配置数据透视表
右侧出现字段列表：
- 把"商品类别"拖到"行"区域
  * 在右侧的字段列表中，找到"商品类别"字段
  * 将鼠标指针移动到"商品类别"字段上
  * 按住鼠标左键不松开
  * 拖动鼠标到下方的"行"区域（通常显示为"将行字段拖至此处"）
  * 松开鼠标左键
  * "商品类别"字段会出现在"行"区域中
- 把"实付款"拖到"值"区域
  * 在字段列表中，找到"实付款"字段（或"金额"字段）
  * 将鼠标指针移动到"实付款"字段上
  * 按住鼠标左键不松开
  * 拖动鼠标到下方的"值"区域（通常显示为"将值字段拖至此处"）
  * 松开鼠标左键
  * "实付款"字段会出现在"值"区域中
- 自动显示每个类别的金额总和
  * 数据透视表会自动更新
  * 左侧会显示一个表格，列出每个商品类别及其对应的金额总和
  * 例如：食品零食 800、服装鞋包 600、学习用品 400

步骤4：美化和调整
- 调整列宽
  * 将鼠标指针移动到列标题之间的分隔线上（例如"类别"列和"求和:金额"列之间）
  * 鼠标指针会变成双向箭头（↔）
  * 按住鼠标左键不松开，向左或向右拖动
  * 松开鼠标左键，列宽会调整
  * 或者双击分隔线，Excel会自动调整列宽以适应内容
- 修改值字段为"求和"（如果不是）
  * 在右侧的"值"区域中，找到"实付款"字段
  * 用鼠标左键单击"实付款"字段
  * 会弹出一个菜单，选择"值字段设置"
  * 在对话框中，确保"汇总方式"选择的是"求和"
  * 如果不是，用鼠标左键单击下拉菜单，选择"求和"
  * 点击"确定"按钮
- 添加总计行
  * 数据透视表默认会显示总计行
  * 如果看不到总计，可以右键单击数据透视表
  * 选择"数据透视表选项"
  * 在"汇总和筛选"选项卡中，勾选"显示行总计"和"显示列总计"
  * 点击"确定"
```

**可视化演示：**
```
字段列表              数据透视表结果
┌──────────┐         ┌────────┬────────┐
│☐ 商品名称 │         │ 类别   │求和:金额│
│☐ 实付款   │    →   ├────────┼────────┤
│☑ 商品类别 │         │食品零食│  800   │
└──────────┘         │服装鞋包│  600   │
                     │学习用品│  400   │
拖到"行"区域          └────────┴────────┘
把"实付款"拖到"值"
```

#### 5.3 探索更多功能

**任务1：创建基本数据透视表**
1. 选中带有类别的数据
2. 插入数据透视表
3. 配置：类别→行,金额→值
4. 查看统计结果

**任务2：探索更多功能**
- 尝试把类别拖到"列"区域，观察变化
- 尝试添加"计数"（看每个类别有多少条）
- 尝试添加筛选器

#### 📝 课堂问答：学习数据透视表

完成上述操作后，请回答以下问题：

**问题1：** 在Excel中，数据透视表的主要作用是什么？

A. 美化表格  
B. 自动完成分类统计，不需要写公式  
C. 删除数据  
D. 复制数据

**正确答案：B**

**解析：** 数据透视表是Excel的强大工具，可以通过拖拽字段的方式自动完成分类统计，不需要写公式。它比SUMIF函数更直观，适合快速分析数据。

---

**问题2：** 创建数据透视表时，应该在哪里操作？

A. "开始"选项卡 → "数据透视表"  
B. "插入"选项卡 → "数据透视表"  
C. "数据"选项卡 → "数据透视表"  
D. "视图"选项卡 → "数据透视表"

**正确答案：B**

**解析：** 创建数据透视表需要在"插入"选项卡中找到"数据透视表"按钮。点击后会弹出对话框，可以选择数据源和放置位置。

---

**问题3：** 在数据透视表中，要把"商品类别"作为分类依据，"实付款"作为统计值，应该怎么操作？

A. 把"商品类别"拖到"行"区域，把"实付款"拖到"值"区域  
B. 把"商品类别"拖到"值"区域，把"实付款"拖到"行"区域  
C. 把两者都拖到"行"区域  
D. 把两者都拖到"值"区域

**正确答案：A**

**解析：** 在数据透视表中，"行"区域用于放置分类字段（如商品类别），"值"区域用于放置要统计的数值字段（如实付款）。这样数据透视表会按类别统计金额总和。

---

**SUMIF vs 数据透视表**

| 特点 | SUMIF | 数据透视表 |
|------|-------|-----------|
| 难度 | 需要理解函数 | 可视化操作 |
| 灵活性 | 可嵌入其他表格 | 独立区域 |
| 更新 | 自动更新 | 需要刷新 |
| 适用场景 | 简单统计 | 复杂多维分析 |

**建议：**
- 简单统计：用SUMIF
- 复杂探索性分析：用数据透视表

---

### 步骤六：数据分析与发现（8分钟）

#### 6.1 找出"吞金兽"

**问题1：哪个类别花费最多？**
- 查看统计结果
- 找出金额最大的类别
- 这个结果出乎意料吗？

#### 6.2 计算占比

**问题2：占比分析**
- 最大类别占总消费的百分比是多少？
- 计算方法：类别金额 ÷ 总消费 × 100%

**示例：**
```
总消费：2000元
食品零食：800元
占比：800 ÷ 2000 × 100% = 40%
```

#### 6.3 向AI提问分析建议

**示例提问：**
```
"我的消费分类统计结果是：零食40%、服装30%、学习20%、其他10%，
你觉得这个消费结构合理吗？有什么建议？"
```

**AI可能的回答：**
```
"作为学生，零食占40%比例较高，建议：
1. 适当控制零食开支
2. 学习用品占比合理
3. 可以设定每月零食预算上限
..."
```

---

## 📝 作业要求

### 提交内容

**文件1：分类统计结果截图**

要求：
1. **截图1**：包含"商品类别"列的数据表（至少20条已分类）
2. **截图2**：使用SUMIF的分类统计表 或 数据透视表结果

**文件2：分析文字**（100字左右）

内容：
- 你的"吞金兽"类别是什么？
- 占比多少？
- 有什么发现或反思？

**文件命名：**
- `学号_姓名_任务4_分类统计.docx`

**提交截止：**下次上课前

### 加分项（可选）
- 同时完成SUMIF和数据透视表两种方法
- 计算每个类别的占比百分比
- 制作简单的分类占比图表（柱状图或饼图）

---

## ❓ 常见问题

### Q1: SUMIF函数报错#VALUE!是什么意思？
**A:** 条件范围和求和范围行数不一致，或数据类型不匹配。检查两个范围的行数是否相同。

### Q2: 为什么SUMIF结果是0？
**A:** 可能原因：
- 类别名称不一致（如数据中是"食品零食"，公式写成"零食"）
- 条件范围选错了
- 数据格式问题

### Q3: 数据透视表怎么刷新？
**A:** 原始数据改变后，右键数据透视表 → 刷新

### Q4: 数据透视表的值字段怎么改成"求和"？
**A:** 点击"值"区域的字段 → 值字段设置 → 选择"求和"

### Q5: 分类太细了怎么办？
**A:** 可以合并相似类别，或者把不重要的归入"其他"。

---

## 💡 学习提示

1. **分类标准要一致**：确保相同类型的商品使用相同的类别名称
2. **先小范围测试**：先分类20条数据，熟悉后再分类全部
3. **两种方法都要会**：SUMIF和数据透视表各有优势
4. **验证结果**：所有类别金额之和应该等于总消费

---

## 📚 SUMIF函数速查表

| 函数 | 语法 | 作用 | 示例 |
|------|------|------|------|
| SUMIF | =SUMIF(条件范围, 条件, 求和范围) | 单条件求和 | =SUMIF(E:E,"食品",D:D) |
| SUMIFS | =SUMIFS(求和范围, 条件范围1, 条件1, ...) | 多条件求和 | =SUMIFS(D:D,E:E,"食品",C:C,">100") |

---

## 🎯 自我检查

完成本任务后，请检查：

- [ ] 理解了数据分类的原则
- [ ] 给数据添加了分类列（至少20条）
- [ ] 能够使用SUMIF函数按类别统计
- [ ] 能够创建数据透视表
- [ ] 找出了"吞金兽"类别并计算了占比
- [ ] 完成了作业提交

---

**祝你学习顺利！** 🎉

