# 任务15：个人消费分析报告-图表制作

## 📌 学习目标

通过本任务的学习，你将能够：

1. **知识目标**
   - 了解常见图表类型及适用场景
   - 掌握Excel图表制作的基本方法
   - 理解数据可视化的基本原则

2. **技能目标**
   - 能够制作折线图、柱状图、饼图
   - 能够美化和优化图表
   - 能够选择合适的图表类型

3. **素养目标**
   - 培养数据可视化思维
   - 建立"让数据说话"的意识
   - 养成美观简洁的设计习惯

---

## ⏰ 任务时间

- **总时长**：2学时（90分钟）
- **建议分配**：
  - 认识数据可视化：10分钟
  - 折线图制作：20分钟
  - 柱状图制作：20分钟
  - 饼图制作：15分钟
  - 组合图制作：15分钟
  - 图表美化：10分钟

---

## 🛠️ 准备工作

### 必备工具
- [ ] Excel 2016及以上版本 或 WPS Office
- [ ] 完成任务14的数据准备
- [ ] 数据透视表技能（回顾任务12）
- [ ] AI助手账号

---

## 📋 操作步骤

### 步骤一：认识数据可视化（10分钟）

#### 1.1 数字 vs 图表

**数字呈现：**
```
1月消费：2500元
2月消费：3200元
3月消费：2800元
4月消费：3500元
5月消费：4000元
6月消费：3800元
```

**图表呈现：**
- 折线图显示上升趋势，直观看出5月是高峰

**优势对比：**
- 数字：精确但枯燥，难以发现规律
- 图表：直观形象，一眼看出趋势和模式

#### 1.2 图表类型与用途

| 图表类型 | 主要用途 | 适用数据 | 示例 |
|----------|----------|----------|------|
| 折线图 | 显示趋势变化 | 时间序列 | 每月消费趋势 |
| 柱状图 | 对比数值大小 | 分类数据 | 各类别消费对比 |
| 饼图 | 显示占比结构 | 构成数据 | 消费类别占比 |
| 条形图 | 横向对比排名 | 排序数据 | TOP10店铺 |
| 散点图 | 显示相关性 | 双变量 | 订单数vs金额 |
| 组合图 | 多维度对比 | 复合数据 | 金额+占比 |

**你的任务：**
1. 理解不同图表类型的用途
2. 思考你的数据适合哪些图表类型

---

### 步骤二：折线图-趋势分析（20分钟）

#### 2.1 制作月度消费趋势图

**数据准备：**

**步骤1：创建数据透视表**
```
1. 选中数据区域
2. 插入 → 数据透视表
3. 设置：
   - 行：年月
   - 值：求和-金额
4. 排序：按年月升序
```

**步骤2：制作折线图**
```
1. 选中数据透视表的数据区域（年月列+金额列）
   - 在数据透视表中，找到"年月"列和"金额"列
   - 将鼠标指针移动到"年月"列的第一个数据单元格
   - 按住鼠标左键不松开
   - 拖动鼠标，选中"年月"列和"金额"列的所有数据（不包括标题行）
   - 松开鼠标左键
   - 选中的区域会显示为蓝色背景

2. 插入 → 图表 → 折线图 → 带数据标记的折线图
   - 在Excel顶部找到"插入"选项卡
   - 用鼠标左键单击"插入"选项卡
   - 在"插入"选项卡的工具栏中，找到"图表"组
   - 在"图表"组中，找到"插入折线图或面积图"按钮（可能显示为折线图图标）
   - 用鼠标左键单击"插入折线图或面积图"按钮
   - 会弹出一个菜单，显示不同类型的折线图
   - 在菜单中找到"带数据标记的折线图"选项（通常显示为带有圆点的折线图图标）
   - 用鼠标左键单击"带数据标记的折线图"选项

3. 图表自动生成
   - Excel会自动在工作表中插入一个折线图
   - 图表会显示年月和金额的关系
   - 图表周围会有边框，表示已选中
```

**步骤3：美化图表**

**添加标题：**
```
1. 点击图表标题
   - 在图表顶部，找到"图表标题"文字（通常显示为"图表标题"或默认标题）
   - 用鼠标左键单击"图表标题"文字
   - 标题会被选中（显示为文本框，周围有边框）

2. 修改为：2024年月度消费趋势
   - 用鼠标左键双击标题文字，或者选中标题文字后直接输入
   - 用键盘删除原有文字
   - 输入新标题：2024年月度消费趋势
   - 按Enter键确认
   - 标题会更新为新文字
```

**添加坐标轴标题：**
```
1. 图表工具 → 添加图表元素 → 坐标轴标题
   - 确保图表已被选中（图表周围有边框）
   - 在Excel顶部会出现"图表工具"选项卡（包含"设计"和"格式"两个子选项卡）
   - 用鼠标左键单击"设计"选项卡（在"图表工具"下）
   - 在"设计"选项卡的工具栏中，找到"添加图表元素"按钮
   - 用鼠标左键单击"添加图表元素"按钮
   - 会弹出一个菜单
   - 在菜单中找到"坐标轴标题"选项
   - 将鼠标指针移动到"坐标轴标题"上
   - 会弹出子菜单，选择"主要纵坐标轴"或"主要横坐标轴"

2. 主要纵坐标轴：消费金额（元）
   - 在子菜单中，用鼠标左键单击"主要纵坐标轴"选项
   - 图表左侧（纵坐标轴）会出现"坐标轴标题"文字
   - 用鼠标左键单击"坐标轴标题"文字
   - 用键盘输入：消费金额（元）
   - 按Enter键确认

3. 主要横坐标轴：月份
   - 再次点击"添加图表元素" → "坐标轴标题"
   - 在子菜单中，用鼠标左键单击"主要横坐标轴"选项
   - 图表底部（横坐标轴）会出现"坐标轴标题"文字
   - 用鼠标左键单击"坐标轴标题"文字
   - 用键盘输入：月份
   - 按Enter键确认
```

**添加数据标签：**
```
1. 右键点击折线
   - 在图表中，找到折线（连接数据点的线条）
   - 用鼠标右键单击折线上的任意一个数据点（圆点）
   - 会弹出一个菜单

2. 添加数据标签
   - 在菜单中找到"添加数据标签"选项
   - 用鼠标左键单击"添加数据标签"选项
   - 图表上会显示每个数据点的具体数值

3. 显示具体数值
   - 数据标签会显示在每个数据点旁边
   - 如果数据标签位置不合适，可以用鼠标左键单击数据标签
   - 拖动数据标签到合适的位置
```

**修改样式：**
```
1. 右键点击折线 → 设置数据系列格式
   - 在图表中，找到折线
   - 用鼠标右键单击折线上的任意一个数据点（圆点）
   - 会弹出一个菜单
   - 在菜单中找到"设置数据系列格式"选项
   - 用鼠标左键单击"设置数据系列格式"选项
   - 会在右侧弹出一个设置面板

2. 修改颜色（如：蓝色 #4472C4）
   - 在设置面板中，找到"填充"或"线条"选项
   - 用鼠标左键单击"填充"或"线条"选项
   - 找到"颜色"选项
   - 用鼠标左键单击"颜色"下拉菜单
   - 选择颜色，或者输入颜色代码：#4472C4
   - 折线的颜色会立即更新

3. 修改标记样式
   - 在设置面板中，找到"标记"选项
   - 用鼠标左键单击"标记"选项
   - 找到"标记选项"，选择"内置"
   - 在"类型"下拉菜单中选择标记样式（如圆形、方形、三角形等）
   - 在"大小"输入框中输入标记大小（如8）

4. 调整线条粗细
   - 在设置面板中，找到"线条"选项
   - 用鼠标左键单击"线条"选项
   - 找到"宽度"输入框
   - 用键盘输入线条宽度（如2.5磅）
   - 折线的粗细会立即更新
```

**删除网格线（可选）：**
```
1. 点击网格线
   - 在图表中，找到网格线（图表背景中的横线或竖线）
   - 用鼠标左键单击任意一条网格线
   - 所有网格线会被选中（显示为选中状态）

2. 按Delete删除
   - 按键盘上的Delete键（删除键）
   - 所有网格线会被删除
   - 图表背景会变得更简洁
```

**调整图表大小：**
```
1. 拖动图表边框
   - 用鼠标左键单击图表区域（图表周围的空白区域）
   - 图表会被选中（图表周围会出现边框，边框上有8个小方块）
   - 将鼠标指针移动到图表边框的任意一个小方块上
   - 鼠标指针会变成双向箭头（↔或↕）
   - 按住鼠标左键不松开
   - 拖动鼠标，调整图表大小
   - 松开鼠标左键

2. 建议宽度：12-14厘米
   - 调整图表宽度，使其在12-14厘米之间
   - 可以在"格式"选项卡中查看和设置精确尺寸

3. 高度：6-8厘米
   - 调整图表高度，使其在6-8厘米之间
   - 保持图表的宽高比例协调
```

**高级技巧：**

**添加趋势线：**
```
1. 右键点击折线
2. 添加趋势线
3. 显示总体走势
```

**添加平均线：**
```
1. 在数据源添加一列"平均值"
2. 使用公式：=AVERAGE($金额列)
3. 添加为新的数据系列
4. 设置为虚线
```

**突出最大/最小值：**
```
1. 手动标注最大/最小值点
2. 使用不同颜色
3. 添加说明文字
```

**你的任务：**
1. 制作自己的月度消费趋势图
2. 完成所有美化步骤
3. 向AI提问：如何让折线图更美观？

**向AI提问：**
```
"我制作了月度消费趋势折线图，
请给出美化建议，包括颜色、布局、标签等。"
```

#### 2.2 多系列折线图

**场景：对比工作日和周末消费**

**数据准备：**
```
数据透视表：
行：年月
列：是否周末
值：求和-金额
```

**制作：**
```
1. 选中数据区域
2. 插入 → 折线图
3. 结果：两条线
   - 蓝线：工作日消费
   - 橙线：周末消费
```

**洞察：**
- 可以看出哪个时段消费更多
- 发现消费模式差异

**你的任务：**
1. 制作工作日/周末对比折线图（可选）
2. 分析消费模式差异

---

### 步骤三：柱状图-分类对比（20分钟）

#### 3.1 简单柱状图

**场景：各类别消费金额对比**

**数据准备：**
```
数据透视表：
行：消费类别
值：求和-金额
排序：按金额降序
```

**制作：**
```
1. 选中数据（类别列+金额列）
2. 插入 → 图表 → 柱状图 → 簇状柱形图
3. 图表标题：各类别消费金额对比
4. 添加数据标签
5. 调整柱子颜色
```

**美化技巧：**
```
1. 修改柱子颜色（使用主题色）
2. 添加数据标签（显示金额）
3. 调整柱子间距（右键 → 设置数据系列格式）
4. 删除网格线（可选）
5. 添加坐标轴标题
```

**变体：条形图**
```
插入 → 条形图 → 簇状条形图
适合类别多且名称长的情况
```

**你的任务：**
1. 制作类别消费对比图
2. 使用条形图展示TOP10店铺（可选）

#### 3.2 堆积柱状图

**场景：每月各类别消费构成**

**数据准备：**
```
数据透视表：
行：年月
列：消费类别
值：求和-金额
```

**制作：**
```
插入 → 柱状图 → 堆积柱形图

效果：
- 每个月一根柱子
- 柱子内不同颜色代表不同类别
- 可以看出每月总额和构成变化
```

**100%堆积柱形图：**
```
显示占比而非金额
每根柱子高度相同（100%）
清晰显示结构变化

制作：
1. 右键点击图表
2. 更改图表类型
3. 选择：100%堆积柱形图
```

**你的任务：**
1. 制作月度类别构成图（堆积）
2. 尝试100%堆积图（可选）

#### 3.3 簇状柱形图

**场景：对比不同维度**

**示例：工作日vs周末各类别消费**
```
数据透视表：
行：消费类别
列：是否周末
值：求和-金额

插入 → 簇状柱形图

效果：每个类别两根柱子并排
- 蓝色：工作日
- 橙色：周末
```

**你的任务：**
1. 制作对比分析图（可选）
2. 分析工作日和周末的消费差异

---

### 步骤四：饼图-占比结构（15分钟）

#### 4.1 基础饼图

**场景：消费类别占比**

**数据准备：**
```
数据透视表：
行：消费类别
值：求和-金额
```

**制作：**
```
1. 选中数据
2. 插入 → 图表 → 饼图 → 饼图
3. 添加数据标签：
   - 显示类别名称
   - 显示百分比
   - 显示引导线
4. 突出显示最大扇区（分离）
5. 调整颜色
```

**美化技巧：**

**爆炸型饼图：**
```
1. 右键点击饼图
2. 设置数据系列格式
3. 调整"饼图分离"百分比
4. 突出某个扇区
```

**修改起始角度：**
```
1. 设置数据系列格式
2. 调整"第一扇区起始角度"
3. 重要类别放在顶部
```

**使用对比色：**
```
1. 选择配色方案
2. 确保区分度高
3. 不超过7个主要颜色
```

**扇区数量：**
```
- 建议不超过7个扇区
- 太多会混乱
- 小扇区可以合并为"其他"
```

**你的任务：**
1. 制作消费类别占比饼图
2. 完成美化（颜色、标签）
3. 向AI提问：如何让饼图更专业？

#### 4.2 圆环图

**制作：**
```
插入 → 饼图 → 圆环图

优势：
- 中间可以放总金额等信息
- 视觉更现代
```

**添加中心文字：**
```
1. 插入 → 文本框
2. 输入"总消费: XX元"
3. 放置在圆环中心
4. 调整字体大小和颜色
5. 设置文本框无填充、无边框
```

**你的任务：**
1. 尝试制作圆环图（可选）
2. 添加中心总金额信息

---

### 步骤五：组合图-多维分析（15分钟）

#### 5.1 柱状图+折线图组合

**场景：每月消费金额和订单数**

**数据准备：**
```
数据透视表：
行：年月
值1：求和-金额
值2：计数-订单号（或序号）
```

**制作：**
```
1. 选中数据
2. 插入 → 图表 → 组合图 → 簇状柱形图-折线图
3. 设置系列：
   - 系列1(金额)：柱形图，主坐标轴
   - 系列2(订单数)：折线图，次坐标轴
4. 添加两个纵轴标题
5. 添加图例
```

**为什么用双轴：**
```
金额范围：1000-5000元
订单数范围：5-20笔

如果用同一轴，订单数的线会很平，看不出变化
用双轴，两个指标都能清晰显示
```

**洞察：**
- 可以发现金额和订单数是否同步变化
- 平均每单金额的变化
- 消费频次与金额的关系

**你的任务：**
1. 制作月度金额+订单数组合图
2. 分析金额和订单数的关系

**向AI提问：**
```
"如何在Excel中制作双轴组合图？
左轴显示金额，右轴显示数量。"
```

---

### 步骤六：图表美化原则（10分钟）

#### 6.1 设计原则

**原则1：简洁优先**
```
✅ 保留关键信息
❌ 删除多余元素（不必要的网格线、边框）
✅ 留白适当
❌ 不要填满整个空间
```

**原则2：突出重点**
```
✅ 用颜色突出关键数据
✅ 用大小强调重要信息
✅ 用标注说明特殊点
```

**原则3：配色和谐**
```
✅ 使用主题配色或专业配色方案
❌ 避免过于鲜艳的颜色
✅ 保持同类图表配色一致
❌ 不超过5种主要颜色
```

**原则4：易于理解**
```
✅ 标题清晰说明内容
✅ 坐标轴有单位
✅ 数据标签清晰
✅ 图例位置合理
```

#### 6.2 常见错误

**错误1：3D效果**
```
❌ 3D饼图、3D柱状图
问题：扭曲数据视觉，难以比较
建议：使用2D图表
```

**错误2：颜色混乱**
```
❌ 每个数据点不同颜色
建议：同类数据用同一颜色或渐变色
```

**错误3：过度装饰**
```
❌ 花哨的背景、边框、阴影
建议：简洁为美
```

**错误4：数据标签过多**
```
❌ 所有数据点都标注
建议：只标注关键点或提供悬停查看
```

**你的任务：**
1. 检查自己的图表是否符合原则
2. 修正发现的错误
3. 向AI提问：如何让图表更专业？

---

### 步骤七：综合实践（10分钟）

#### 7.1 制作完整的图表集

**必做图表（至少5个）：**
1. 月度消费趋势折线图
2. 类别消费对比柱状图
3. 类别占比饼图
4. TOP10店铺条形图
5. 月度金额+订单数组合图

**可选图表：**
6. 工作日vs周末对比图
7. 各月类别构成堆积图
8. 消费等级分布图
9. 季度对比图
10. 品牌偏好图

**组织方式：**
```
每个图表单独一个工作表
工作表命名：图表1-月度趋势、图表2-类别对比等
```

**你的任务：**
1. 制作至少5个图表
2. 每个图表都要美化
3. 向AI咨询美化建议

**向AI提问模板：**
```
"我制作了[图表类型]，
数据是[数据描述]，
请给出美化建议，包括颜色、布局、标签等。"
```

---

## 📝 作业要求

### 提交内容

**实践任务：**

**任务1：制作图表集（必做）**
1. 制作至少5个不同类型的图表
2. 每个图表都要美化
3. 图表清晰、美观、专业

**任务2：图表说明文档（必做）**
记录每个图表的制作过程

**提交内容：**

**Excel文件：**
- 包含所有制作的图表
- 每个图表单独一个工作表
- 图表命名清晰
- 文件命名：`学号_姓名_任务15_图表制作.xlsx`

**Word文档（300字）：**
```
一、图表清单
   - 图表1：[名称] - [类型] - [用途]
   - 图表2：[名称] - [类型] - [用途]
   - ...

二、制作过程
   - 数据准备：[如何准备数据]
   - 图表制作：[制作步骤]
   - 美化处理：[美化方法]

三、遇到的难点
   - 难点1：[描述]
   - 解决方法：[如何解决]
   - AI的帮助：[AI提供了哪些帮助]

四、心得体会
   - 学到了什么
   - 图表选择的经验
   - 美化的技巧
```

**文件命名：**
- `学号_姓名_任务15_图表制作.xlsx`
- `学号_姓名_任务15_图表说明.docx`

**提交截止：**下次上课前

### 评分标准
- 图表数量（20分）：至少5个
- 图表类型选择（20分）：是否合适
- 图表准确性（20分）：数据正确
- 图表美观度（30分）：设计和配色
- 标题和标注（10分）：是否清晰

### 加分项（可选）
- 制作更多图表（超过5个）
- 使用高级图表类型
- 创新的可视化方式
- 精美的配色方案

---

## ❓ 常见问题

### Q1: 图表数据不显示或显示错误？
**A:** 
- 检查数据源是否正确
- 检查数据格式（数字vs文本）
- 检查数据透视表是否正确

### Q2: 如何选择合适的图表类型？
**A:** 
- 趋势数据用折线图
- 对比数据用柱状图
- 占比数据用饼图
- 或向AI提问：我想展示[数据]，应该用什么图表？

### Q3: 图表颜色如何搭配？
**A:** 
- 使用Excel内置配色方案
- 或选择2-3个主色
- 或向AI提问：请推荐专业的图表配色方案

### Q4: 如何制作双轴图表？
**A:** 
- 使用组合图
- 设置不同系列使用不同坐标轴
- 或向AI提问：如何制作双轴组合图？

### Q5: 图表美化有什么技巧？
**A:** 
- 删除不必要的元素
- 统一配色
- 添加清晰的标题和标签
- 或向AI提问：如何让图表更专业？

---

## 💡 学习提示

1. **数据准备是关键**：先做好数据透视表，再制作图表
2. **选择合适的类型**：根据数据特点选择图表类型
3. **简洁为美**：不要过度装饰
4. **统一风格**：同类图表保持一致的配色和样式
5. **善用AI**：遇到问题及时向AI求助

---

## 📚 图表制作速查表

| 图表类型 | 适用场景 | 制作步骤 |
|----------|----------|----------|
| 折线图 | 趋势分析 | 插入→折线图→美化 |
| 柱状图 | 分类对比 | 插入→柱状图→美化 |
| 饼图 | 占比分析 | 插入→饼图→美化 |
| 条形图 | 排名对比 | 插入→条形图→美化 |
| 组合图 | 多维分析 | 插入→组合图→设置双轴 |

---

## 🎯 自我检查

完成本任务后，请检查：

- [ ] 制作了至少5个图表
- [ ] 每个图表都有清晰的标题
- [ ] 图表数据准确无误
- [ ] 图表美观专业
- [ ] 配色统一协调
- [ ] 完成了作业提交

---

**祝你学习顺利！** 🎉

