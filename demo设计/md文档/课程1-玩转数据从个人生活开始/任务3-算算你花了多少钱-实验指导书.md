# 任务3：算算你花了多少钱

## 📌 学习目标

通过本任务的学习，你将能够：

1. **知识目标**
   - 理解Excel函数的概念和基本语法
   - 掌握SUM函数和AVERAGE函数的用法
   - 了解COUNT、MAX、MIN等常用统计函数

2. **技能目标**
   - 能够使用SUM函数计算一列数字的总和
   - 能够使用AVERAGE函数计算平均值
   - 能够向AI询问并学会其他统计函数
   - 能够正确选择函数的参数范围

3. **素养目标**
   - 培养数据统计分析意识
   - 建立通过数据认识自我的习惯
   - 体会函数自动计算的效率优势

---

## ⏰ 任务时间

- **总时长**：2学时（90分钟）
- **建议分配**：
  - 问题导入：10分钟
  - SUM函数学习：20分钟
  - AVERAGE函数学习：15分钟
  - 其他统计函数：20分钟
  - 实际应用分析：15分钟
  - AI答疑：8分钟
  - 作业完成：2分钟

---

## 🛠️ 准备工作

### 必备工具
- [ ] Excel 2016及以上版本 或 WPS Office
- [ ] 任务1的示例数据文件（任务1-示例网购数据.csv）
- [ ] AI助手账号（可选）

---

## 📋 操作步骤

### 步骤一：理解函数概念（10分钟）

#### 1.1 生活场景思考

**问题：**
- "大家知道自己过去半年网购花了多少钱吗？"
- "如果有100条订单，怎么算总金额？"

**传统方法的问题：**
- 用计算器一个一个加（太慢）
- 用手机计算器（容易出错）

**Excel函数的优势：**
- 快速：一秒得出结果
- 准确：不会算错
- 灵活：数据改变自动更新

#### 1.2 Excel函数基本语法

**函数的基本结构：**
```
=函数名(参数1, 参数2, ...)

示例：
=SUM(A1:A10)
  ↑    ↑
函数名  参数（求和范围）
```

**关键要素：**
- 必须以`=`开头
- 函数名大小写不敏感（SUM、sum、Sum都可以）
- 参数用括号包裹
- 范围用冒号表示（A1:A10表示从A1到A10）

#### 📝 课堂问答：理解函数概念

完成上述操作后，请回答以下问题：

**问题1：** Excel函数必须以什么符号开头？

A. +  
B. =  
C. -  
D. *

**正确答案：B**

**解析：** Excel函数必须以等号`=`开头，这是Excel识别公式和函数的标志。如果不加等号，Excel会将其当作普通文本处理。

---

**问题2：** 在Excel中，A1:A10表示什么？

A. 单元格A1和A10  
B. 从A1到A10的所有单元格（连续区域）  
C. 第1行到第10行  
D. 第A列

**正确答案：B**

**解析：** 冒号`:`在Excel中表示连续区域，A1:A10表示从A1单元格到A10单元格的所有单元格（包括A1和A10之间的所有单元格）。

---

**问题3：** Excel函数名的大小写有要求吗？

A. 必须大写  
B. 必须小写  
C. 大小写不敏感（都可以）  
D. 必须首字母大写

**正确答案：C**

**解析：** Excel函数名大小写不敏感，SUM、sum、Sum都可以，Excel会自动识别。但通常习惯使用大写，这样更容易识别。

---

### 步骤二：学习SUM函数（20分钟）

#### 2.1 找到数据列

**立即动手：**

1. 打开任务1的示例数据文件
2. 找到"金额"或"实付款"列（看第1行，找到金额那一列）
3. 记住这一列的字母（比如D列、E列）
4. 数一数数据有多少行（看最后一行是第几行，比如第101行）
5. 数据范围：从第2行到第101行（不包括第1行标题）

#### 2.2 使用SUM函数计算总消费

**方法1：手动输入公式**
```
步骤1：在空白单元格（如D102）输入公式
=SUM(D2:D101)

解释：
- D2是第一个金额（不包括标题行）
- D101是最后一个金额
- 冒号表示"到"

步骤2：按Enter键，得出结果

步骤3：查看结果，惊叹"原来花了这么多！"
```

**方法2：用鼠标选择范围**
```
步骤：
1. 在单元格输入 =SUM(
   - 用鼠标左键单击一个空白单元格（例如D102）
   - 在单元格中输入：=SUM(
   - 注意：等号（=）和SUM必须输入，左括号（(）也要输入
   - 此时单元格会显示：=SUM(

2. 用鼠标拖动选择D2:D101
   - 将鼠标指针移动到D2单元格（第一个金额数据）
   - 按住鼠标左键不松开
   - 向下拖动鼠标，直到D101单元格（最后一个金额数据）
   - 拖动时会看到选中的区域被蓝色边框包围
   - 拖动时会看到单元格中自动显示：=SUM(D2:D101
   - 松开鼠标左键

3. 输入右括号 )
   - 在键盘上找到右括号键（通常在数字0的右边）
   - 按一下右括号键
   - 此时单元格会显示：=SUM(D2:D101)

4. 按Enter
   - 按键盘上的Enter键（回车键）
   - Excel会自动计算并显示结果
   - 单元格会显示计算出的总金额数字

注意：如果输入公式后单元格显示的是公式本身而不是结果，说明公式输入有误，检查是否忘记输入等号。
```

**方法3：自动求和按钮**
```
步骤：
1. 选中D2:D101
   - 将鼠标指针移动到D2单元格（第一个金额数据）
   - 按住鼠标左键不松开
   - 向下拖动鼠标，直到D101单元格（最后一个金额数据）
   - 拖动时会看到选中的区域被蓝色边框包围
   - 松开鼠标左键
   - 此时D2到D101的所有单元格都被选中（显示为蓝色背景）

2. 点击"开始"选项卡的"自动求和"按钮（Σ）
   - 在Excel顶部找到"开始"选项卡（通常在"文件"选项卡的右边）
   - 用鼠标左键单击"开始"选项卡
   - 在"开始"选项卡的工具栏中找到"自动求和"按钮
   - "自动求和"按钮上有一个符号：Σ（希腊字母，读作"西格玛"）
   - 这个按钮通常在工具栏的右侧，可能在"编辑"组中
   - 用鼠标左键单击"自动求和"按钮（Σ）

3. 结果自动显示在下方
   - Excel会自动在选中区域的下方（D102单元格）显示计算结果
   - 如果D102单元格有内容，结果会显示在D102
   - 如果下方是空的，Excel会自动在下方第一个空单元格显示结果
   - 单元格中会显示计算出的总金额数字

注意：如果点击"自动求和"按钮后没有反应，检查是否已经选中了数据区域。
```

#### 2.3 常见错误避免

**错误1：忘记等号**
```
错误：SUM(D2:D101)
正确：=SUM(D2:D101)
```

**错误2：选错范围**
```
错误：=SUM(D1:D101)  ← 包含了标题行
正确：=SUM(D2:D101)
```

**错误3：括号不匹配**
```
错误：=SUM(D2:D101
正确：=SUM(D2:D101)
```

**练习任务：**
1. 使用SUM函数计算你的总消费
2. 截图保存结果

#### 📝 课堂问答：学习SUM函数

完成上述操作后，请回答以下问题：

**问题1：** 使用SUM函数计算总消费时，如果数据从第2行到第101行（第1行是标题），正确的公式是什么？

A. =SUM(D1:D101)  
B. =SUM(D2:D101)  
C. =SUM(D1:D100)  
D. =SUM(D2:D100)

**正确答案：B**

**解析：** 第1行是标题行，不应该包含在计算范围内。数据从第2行开始到第101行，所以应该使用=SUM(D2:D101)，不包括标题行。

---

**问题2：** 如果输入公式时忘记加等号，会出现什么情况？

A. Excel会自动添加等号  
B. Excel会报错  
C. Excel会将其当作普通文本显示  
D. Excel会自动计算

**正确答案：C**

**解析：** 如果忘记加等号，Excel会将公式当作普通文本处理，直接显示在单元格中，不会进行计算。例如输入"SUM(D2:D101)"会直接显示为文本，而不是计算结果。

---

**问题3：** 使用SUM函数时，以下哪个范围表示正确？

A. D2:D101（从D2到D101的连续区域）  
B. D2,D101（只有D2和D101两个单元格）  
C. D2;D101（错误的分隔符）  
D. D2-D101（错误的连接符）

**正确答案：A**

**解析：** SUM函数中，连续区域用冒号`:`表示，如D2:D101表示从D2到D101的所有单元格。逗号`,`用于分隔不连续的单元格，如D2,D5,D10。

---

### 步骤三：学习AVERAGE函数（15分钟）

#### 3.1 计算平均每单消费

**问题：**
"知道总消费后，你想不想知道平均每单花多少？"

**函数语法：**
```
=AVERAGE(范围)

示例：
=AVERAGE(D2:D101)
```

**操作步骤：**
```
步骤1：在SUM结果下方的单元格（如D103）输入
=AVERAGE(D2:D101)
   - 用鼠标左键单击D103单元格（或SUM结果下方的任意空白单元格）
   - 在单元格中输入：=AVERAGE(D2:D101)
   - 也可以先输入：=AVERAGE(
   - 然后用鼠标拖动选择D2:D101区域（方法同SUM函数）
   - 再输入右括号：)
   - 此时单元格会显示：=AVERAGE(D2:D101)

步骤2：按Enter，得出平均值
   - 按键盘上的Enter键（回车键）
   - Excel会自动计算并显示结果
   - 单元格会显示计算出的平均金额数字
   - 例如：如果总消费是10000，订单数是100，平均值会显示100

步骤3：观察结果，思考：
- 平均每单花多少钱？
- 这个金额符合你的预期吗？
- 总消费 ÷ 订单数 = 平均每单消费
- 这个数字表示平均每笔订单的消费金额
```

#### 3.2 美化统计结果

**创建统计表：**
```
在单元格旁边添加说明文字：
C102: 总消费：
D102: =SUM(D2:D101)

C103: 平均每单：
D103: =AVERAGE(D2:D101)

C104: 订单数量：
D104: =COUNT(D2:D101)  ← 顺便介绍COUNT函数
```

**格式美化：**
- 加粗标签文字
- 设置金额为货币格式（¥符号、千分位、保留2位小数）
- 添加边框

**练习任务：**
1. 创建完整的统计表
2. 美化格式

#### 📝 课堂问答：学习AVERAGE函数

完成上述操作后，请回答以下问题：

**问题1：** AVERAGE函数的作用是什么？

A. 计算总和  
B. 计算平均值  
C. 找出最大值  
D. 计算数量

**正确答案：B**

**解析：** AVERAGE函数用于计算一组数字的平均值。例如=AVERAGE(D2:D101)会计算D2到D101单元格中所有数字的平均值。

---

**问题2：** 如果使用AVERAGE函数计算平均值，但范围内包含空单元格，会怎样？

A. 报错  
B. 空单元格会被忽略，只计算有数值的单元格  
C. 空单元格会被当作0计算  
D. 无法计算

**正确答案：B**

**解析：** AVERAGE函数会自动忽略空单元格和文本单元格，只计算范围内的数字单元格。例如范围中有10个单元格，但只有8个有数值，AVERAGE会计算这8个数值的平均值。

---

**问题3：** COUNT函数和AVERAGE函数的区别是什么？

A. COUNT计算平均值，AVERAGE计算数量  
B. COUNT计算数量，AVERAGE计算平均值  
C. 两者功能相同  
D. COUNT计算总和，AVERAGE计算平均值

**正确答案：B**

**解析：** COUNT函数用于统计范围内数字单元格的数量，AVERAGE函数用于计算范围内数字的平均值。例如COUNT(D2:D101)会统计有多少个数字单元格，AVERAGE(D2:D101)会计算这些数字的平均值。

---

### 步骤四：学习其他统计函数（20分钟）

#### 4.1 向AI提问获取函数清单

**提问模板：**
```
Excel中常用的统计函数有哪些？我想分析消费数据，请推荐5个最有用的函数。
```

**AI可能推荐的函数：**
- SUM - 总和
- AVERAGE - 平均值
- MAX - 最大值
- MIN - 最小值
- COUNT - 计数
- MEDIAN - 中位数

#### 4.2 学习MAX和MIN函数

**MAX函数 - 找出最大值**
```
=MAX(D2:D101)

作用：找出你买过最贵的东西
示例结果：最大消费 = 299.00元
```

**MIN函数 - 找出最小值**
```
=MIN(D2:D101)

作用：找出最便宜的一单
示例结果：最小消费 = 9.90元
```

#### 4.3 学习COUNT函数

**COUNT函数 - 计算数量**
```
=COUNT(D2:D101)

作用：统计有多少条订单（数字单元格数量）
示例结果：订单数量 = 87
```

#### 4.4 学习MEDIAN函数

**MEDIAN函数 - 中位数**
```
=MEDIAN(D2:D101)

作用：找出消费的中位数（排序后中间的值）
用途：对比平均值和中位数，判断是否有极端值
```

#### 4.5 制作综合统计表

**任务：制作个人消费统计表**

```
┌────────────────┬──────────────┐
│   统计项       │    数值      │
├────────────────┼──────────────┤
│ 总消费         │ =SUM(...)    │
│ 平均每单       │ =AVERAGE(...)│
│ 最大单笔消费   │ =MAX(...)    │
│ 最小单笔消费   │ =MIN(...)    │
│ 订单数量       │ =COUNT(...)  │
│ 中位数消费     │ =MEDIAN(...) │
└────────────────┴──────────────┘
```

**练习任务：**
1. 在新的工作表创建上述统计表
2. 填写所有函数公式
3. 美化表格（颜色、边框、对齐）

#### 📝 课堂问答：学习其他统计函数

完成上述操作后，请回答以下问题：

**问题1：** MAX函数和MIN函数分别用于什么？

A. MAX计算最大值，MIN计算最小值  
B. MAX计算最小值，MIN计算最大值  
C. MAX计算平均值，MIN计算总和  
D. 两者功能相同

**正确答案：A**

**解析：** MAX函数用于找出一组数字中的最大值，MIN函数用于找出最小值。例如=MAX(D2:D101)会找出消费金额中的最大值，=MIN(D2:D101)会找出最小值。

---

**问题2：** MEDIAN函数（中位数）和AVERAGE函数（平均值）的区别是什么？

A. 中位数是排序后中间的值，平均值是所有数值的总和除以数量  
B. 两者计算结果相同  
C. 中位数总是大于平均值  
D. 平均值总是大于中位数

**正确答案：A**

**解析：** 中位数是将数据排序后位于中间的值，不受极端值影响；平均值是所有数值的总和除以数量，受极端值影响较大。如果数据中有特别大或特别小的值，平均值会被拉高或拉低，但中位数相对稳定。

---

**问题3：** 如果一组数据的平均值明显大于中位数，说明什么？

A. 数据分布均匀  
B. 有一些较大的值拉高了平均值  
C. 数据有错误  
D. 平均值计算错误

**正确答案：B**

**解析：** 当平均值明显大于中位数时，说明数据中有一些较大的值（极端值）拉高了平均值。中位数不受极端值影响，更能反映数据的典型水平。

---

### 步骤五：数据分析与思考（15分钟）

#### 5.1 数据观察与思考

**问题1：总消费和预期的差距**
- "你觉得自己半年花了多少？实际花了多少？"
- "差距大吗？为什么会有差距？"

**问题2：平均消费的意义**
- "平均每单XX元，这个金额高还是低？"
- "和同学对比是什么水平？"

**问题3：极值的发现**
- "最大消费是什么？为什么这么贵？"
- "最小消费是什么？"

**问题4：平均数 vs 中位数**
```
如果平均数 > 中位数 → 有一些大额消费拉高了平均值
如果平均数 ≈ 中位数 → 消费比较均匀
```

#### 5.2 向AI提问分析建议

**示例提问：**
```
"我半年网购消费3000元，平均每单35元，最大消费200元，这个消费水平合理吗？有什么建议？"
```

---

## 📝 作业要求

### 提交内容

**文件1：消费统计表截图**

要求：
1. 截图你的消费统计表（包含至少SUM、AVERAGE、MAX、MIN）
2. 确保格式美观，有标签说明

**文件2：分析文字**（50-100字）

内容：
- 总消费多少？
- 平均每单多少？
- 有什么发现或感想？

**文件命名：**
- `学号_姓名_任务3_消费统计.png`
- `学号_姓名_任务3_分析.txt`

**提交截止：**下次上课前

### 加分项（可选）
- 使用MEDIAN函数并解释平均数和中位数的差异
- 向AI提问一个关于数据的问题并分享答案

---

## ❓ 常见问题

### Q1: 函数报错#VALUE!是什么意思？
**A:** 范围内包含非数字内容（如文本）。检查数据，删除或排除文本单元格。

### Q2: 函数报错#DIV/0!是什么意思？
**A:** 除数为0（AVERAGE时范围为空）。检查选择的范围是否正确。

### Q3: 函数报错#NAME?是什么意思？
**A:** 函数名拼写错误。检查函数名是否正确（如SUM不是SUMS）。

### Q4: 结果为0怎么办？
**A:** 可能选择的范围不对，或数据是文本格式。重新选择范围，或转换数据格式。

### Q5: 怎么设置数字显示为货币格式？
**A:** 
1. 选中单元格
2. 右键 → 设置单元格格式
3. 选择"货币"或"会计专用"
4. 设置小数位数和货币符号

---

## 💡 学习提示

1. **函数语法**：记住必须以`=`开头
2. **范围选择**：注意不要包含标题行
3. **多练习**：每个函数都要亲自尝试
4. **善用AI**：遇到不会的函数，随时问AI

---

## 📚 常用统计函数速查表

| 函数 | 语法 | 作用 | 示例 |
|------|------|------|------|
| SUM | =SUM(范围) | 求和 | =SUM(A1:A10) |
| AVERAGE | =AVERAGE(范围) | 平均值 | =AVERAGE(A1:A10) |
| MAX | =MAX(范围) | 最大值 | =MAX(A1:A10) |
| MIN | =MIN(范围) | 最小值 | =MIN(A1:A10) |
| COUNT | =COUNT(范围) | 计数（数字） | =COUNT(A1:A10) |
| MEDIAN | =MEDIAN(范围) | 中位数 | =MEDIAN(A1:A10) |

---

## 🎯 自我检查

完成本任务后，请检查：

- [ ] 理解了Excel函数的基本语法
- [ ] 能够使用SUM函数计算总和
- [ ] 能够使用AVERAGE函数计算平均值
- [ ] 学会了MAX、MIN、COUNT等函数
- [ ] 完成了综合统计表
- [ ] 完成了作业提交

---

**祝你学习顺利！** 🎉


