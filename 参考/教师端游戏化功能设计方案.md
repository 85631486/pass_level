## 1. 设计背景与目标

- **背景**：学生端已具备闯关地图、角色成长、道具、排行榜等游戏化体验；教师端需提供与之匹配的教学编排与运营工具。  
- **目标**：帮助教师以“游戏主理人”身份，高效设计任务、调节奖励、监控学生表现、开展活动并实时干预，确保游戏化机制服务教学目标。  
- **范围**：教师端 Web/H5，覆盖课程管理、任务设计、激励运营、课堂指挥、数据分析与社交互动管理。

## 2. 用户角色与职责

| 角色 | 职责 | 说明 |
| --- | --- | --- |
| 课程教师 | 建课、编排任务、配置奖励、发布与监控、反馈学生 | 核心使用者 |
| 助教/班主任 | 协助批改、发放奖励、维护小队、公会 | 权限受控 |
| 游戏运营教师（可选） | 策划活动、副本、赛季规则 | 高级权限 |

## 3. 功能结构总览

- **课程与任务工坊**：课程管理、关卡地图编排、资源上传、任务脚本与 BOSS 设计。  
- **激励与经济系统**：经验/积分公式、奖励池、道具/宝箱、技能树配置、赛季管理。  
- **社交与协作管理**：小队、公会审核，助攻中心，导师 NPC 配置。  
- **课堂直播面板**：实时排行榜、地图热力、学生进度、弹幕互动、临时加戏（加分、限时挑战）。  
- **运营活动**：副本、主题周、每日任务、成长任务、实体奖励。  
- **评价与反馈**: 主观题批改、战报点评、个性化推送建议。  
- **数据与预警**：学习/游戏化指标看板、学生画像、异常提醒。  
- **系统设置**：权限、模板、资源审核、接口与日志。

## 4. 功能详细设计

### 4.1 课程与任务工坊

1. **关卡视图建课**  
   - 提供“地图编辑器”模式，教师拖拽任务节点组成章节路线，设置前置关系、隐藏副本。  
   - 可从模板导入基础地图，再自定义剧情描述、BOSS 形象、首通奖励。  
   - 与功能设计 3.1 的课程列表/班级绑定保持一致：地图编辑界面可直接选择班级范围、学期标签，并展示完成率、活跃度等数据。
2. **任务脚本化配置**  
   - 图形化脚本面板：剧情文本、过场动画、NPC 对话、提示语。  
   - BOSS 战参数：题目组、阶段、血量/护盾（映射题数/分值）、时间限制、失败惩罚。  
   - 嵌入小游戏触发条件（如观看视频进度达到 80% 弹出答题）。  
   - 兼容功能设计 3.2 的提交项/考题配置：在脚本面板中嵌入“提交步骤”与“考题组”组件，可直接引用题库。
3. **资源管理**  
   - 视频/指导书上传带版本管理与审批流程。  
   - 资源与任务节点关联，支持多人协作编辑，提供引用统计。  
   - 与系统模板中心打通，可一键复制历史任务或公共模板。
4. **预览与测试**  
   - 教师可以“试玩”任务，以学生视角体验全流程。  
   - 支持生成“试玩链接”给助教或资深学生进行测试并反馈。

### 4.2 激励与经济系统

1. **奖励公式配置**  
   - 图形化界面调整经验、技能点、金币、星级公式参数，实时预览对学生的影响。  
   - 支持按任务/章节设定加成或衰减。  
   - 与功能设计 3.6 中的经验/积分/徽章保持一致，允许一键套用平台默认模版或导入 Excel。
2. **道具与宝箱管理**  
   - 创建和配置道具：类型（提示、时间、复活、助力）、效果、冷却、可见范围。  
   - 宝箱掉落表：权重配置、触发条件（首通、连续满星、助攻次数）。  
   - 与任务模块联动：在发布任务时可指定宝箱掉落包，系统自动同步到学生端奖励预告。
3. **技能树与战斗力**  
   - 维护技能节点、解锁关系、描述文案；可按课程定制或引用公共模板。  
   - 配置战斗力指数各指标权重，关联排行榜展示。  
   - 支持导出技能成长表，方便与教务成绩挂钩。
4. **赛季与积分商城**  
   - 设定赛季时长、主题、赛季任务与奖励，支持赛季重置与荣誉保留。  
   - 积分商城可配置虚拟物品或课堂特权，控制库存与兑换条件。
   - 赛季规则与课堂活动计划联动，发布后自动同步至班级大厅与学生端每日任务。

### 4.3 社交与协作管理

1. **小队/公会**  
   - 审核、解散、调整队伍；设置队伍任务与 Buff（如经验加成）。  
   - 查看队伍贡献榜，及时表扬或调整。  
2. **助攻中心**  
   - 实时查看求助列表，指派导师或优秀学生跟进。  
   - 批量发放助攻奖励、徽章。  
3. **导师/NPC 配置**  
   - 为任务节点配置导师人物形象、语音/文字提示。  
   - 可安排真人（教师、助教、学长）负责某些节点的答疑。  
4. **班级大厅管理**  
   - 发布公告、置顶优秀战报、管理评论与互动内容。

### 4.4 课堂直播面板

1. **实时地图热力**：显示当前各节点进度、卡点学生数量。  
2. **排行榜墙**：实时展示个人/小队榜，支持投屏。  
3. **弹幕与互动**：教师可发送鼓励、提示、随机掉落道具；学生可发弹幕（可控）。  
4. **即时干预**：  
   - 一键开启“限时挑战”“暴击模式”提升奖励。  
   - 对落后学生发起定向提示或加倍经验。  
5. **课堂战报**：实时生成关键事件（首通、满星、小队完成）供课堂展示。
6. **同步任务发布**：与功能设计 3.3 对齐，教师可在直播面板直接发布/撤回任务、设置截止提醒并推送到站内信/企业微信，实现“边讲边发关卡”。

### 4.5 运营活动与任务

1. **活动策划器**：可视化配置活动类型（副本、主题周、打卡赛）、规则、奖励。  
2. **每日/成长任务**：设定任务列表、刷新机制、自动通知。  
3. **实体奖励联动**：记录实物奖品库存、兑换、发放状态。  
4. **任务创作大赛**：教师发起活动，学生提交创意任务，由教师审核后可加入课程任务库。
5. **任务模板复用**：与功能设计 3.1/3.2 的模板中心联动，可将活动任务沉淀为模板，一键复制到新课程或跨班活动。  
6. **发布流程**：活动上线前支持草稿、审核、定时发布状态，与通知系统联动推送。

### 4.6 评价与反馈

1. **多维评分**：过程提交批注、Rubric打分、语音评价。  
2. **战报点评**：对学生战报加入评语、推荐至班级大厅。  
3. **个性化建议**：系统根据数据给出建议，教师可一键发送给学生或全队。  
4. **错题与技能分析**：帮助教师提炼薄弱知识点，定向布置补充任务。  
5. **评分流程与功能设计 3.4/3.7 对齐**：客观题自动评分后，教师在此模块完成主观题批改、发布成绩，并可关联奖励或惩罚（扣星、发放助攻点）。

### 4.7 数据与预警

1. **教学+游戏化综合仪表盘**：完成率、平均用时、技能增长、助攻活跃度、道具消耗、地图热力、赛季参与度。  
2. **学生画像**：学习能力、协作度、活跃度、风险等级，支持过滤和导出。  
3. **预警策略**：多维触发（未登录、连续失败、战斗力下滑、助攻无响应），支持自动提醒和人工跟进。  
4. **AB 测试**：教师可对不同班级试验不同奖励策略并比较效果。  
5. **指标映射**：与功能详细设计 3.7 的仪表盘共享同一指标源，确保课堂看板、活动策划器与学生端反馈保持一致。

### 4.8 系统设置与模板

- 课程模板、任务模板、剧情模板管理。  
- 权限与协作：给助教、运营设置细粒度权限。  
- 日志与审计：记录奖励调整、活动配置变更。  
- 接口与集成：对接教务系统、消息渠道（短信/企业微信）。

### 4.9 业务流程映射（与功能详细设计对齐）

1. **建课流程**：课程列表 → 班级绑定 → 地图编辑器创建章节 → 关联任务模板 → 保存草稿/发布。  
2. **任务发布流程**：任务脚本配置完成后，进入发布面板设置可见范围/时间 → 通知学生 → 课堂直播面板实时监控。  
3. **闯关监控流程**：学生闯关数据回传 → 课堂面板、数据仪表盘同步刷新 → 触发奖励/预警 → 教师即时干预。  
4. **评分反馈流程**：客观题自动判分 → 教师在评价模块批改主观题、给出战报点评 → 生成学生报告与奖励记录。  
5. **运营活动流程**：活动策划器创建活动 → 审核发布 → 与每日任务/赛季联动 → 数据分析评估 → 沉淀模板。

## 5. 关键页面与交互示意

| 页面 | 功能重点 | 游戏化特性 |
| --- | --- | --- |
| 课程地图编辑器 | 拖拽节点、配置剧情、预览地图 | 游戏策划体验 |
| 奖励公式面板 | 图形调参、实时预览 | 直观看到奖励策略影响 |
| 课堂直播面板 | 实时排行榜、弹幕、加成按钮 | 现场操控感 |
| 活动策划器 | 副本/赛季配置、奖励表 | 运营化管理 |
| 助攻中心 | 求助列表、指派、奖励 | 强化协作 |

## 6. 数据与接口要点

- **核心数据**：课程、任务、地图节点、剧情脚本、奖励公式、道具、技能树、赛季、活动、助攻、战报。  
- **关键接口示例**：  
  - `GET/PUT /teachers/{id}/courses/{courseId}/map` 地图结构；  
  - `POST /tasks/{id}/boss-config` BOSS 战配置；  
  - `POST /rewards/formula` / `GET /rewards/items`；  
  - `POST /teams/{id}/buff` 设置队伍加成；  
  - `GET /live-dashboard?courseId=` 课堂实时数据；  
  - `POST /events`/`PUT /events/{id}` 活动管理；  
  - `POST /alerts/{id}/notify` 推送预警。  
- **权限控制**：按课程与功能模块控制，关键操作需二次确认与日志。

## 7. 运营与安全要求

- 配置变更提供“演练环境”与发布审批，防止游戏化参数误调。  
- 重要奖励/道具调整需支持回滚与追踪。  
- 对外公告/弹幕内容需过滤，防止不当信息。  
- 数据可视化支持打点下载，用于教研汇报。  
- 与学生端保持实时同步（WebSocket / 推送），确保教师操作即时生效。

## 8. 推进建议

1. 基于本方案绘制教师端原型（地图编辑、奖励面板、直播仪表盘、活动策划器）。  
2. 与学生端接口对齐，明确地图/奖励/道具数据结构。  
3. 规划 MVP：优先上线课程地图 + 奖励调参 + 课堂直播面板，随后迭代活动与助攻中心。  
4. 开展用户测试，收集教师对操作复杂度、数据展示、课堂互动的反馈，持续优化。


