## 1. 文档说明

- **名称**：过关斩将-游戏教学平台功能详细设计  
- **目标**：在概要设计基础上，对平台核心功能展开可执行的产品/需求说明，指导原型、交互和开发。  
- **读者**：产品经理、交互设计、研发、测试、教学教务方。

## 2. 角色与权限矩阵

| 角色 | 核心权限 | 备注 |
| --- | --- | --- |
| 教师 | 课程管理、任务编排、任务发布、查看数据、批改主观题、发放奖励 | 支持课程级管理 |
| 学生 | 查看任务、学习资源、提交材料、答题闯关、查看奖励与成绩 | 支持移动端 |
| 教务/运营 | 课程审核、题库模板维护、数据监控、账号管理 | 可由管理员兼任 |
| 系统管理员 | 全局配置、权限分配、资源审核、系统监控 | 具备最高权限 |

权限控制建议按“角色 + 课程范围”两级：教师只能管理自己创建或被授予的课程；学生仅能访问已加入班级。

## 3. 功能模块详细设计

### 3.1 课程管理（教师端）

**目标**：帮助教师高效创建/维护课程内容并绑定班级。

**功能点**  
1. 课程列表：按学期、状态过滤，显示任务数量、学生数、完成率概览。  
2. 新建/编辑课程：包含基础信息、学期、班级、课程封面、难度标签。  
3. 班级绑定：可搜索学校班级、导入名单、生成课程邀请码或二维码。  
4. 任务库管理：展示课程内所有任务的草稿/已发布状态，支持复制、排序、批量删除。  
5. 模板中心：导入官方模板或复制历史课程，一键生成任务骨架。  
6. 课程共享：可指定同学院教师协作编辑并设置权限（编辑/只读）。

**数据要求**  
- 课程实体需保存创建者、所属学院、可视范围、状态（草稿/进行中/结课）。  
- 班级与学生关系表支持批量导入、状态变更（在读/退课）。

### 3.2 任务编排

**目标**：对单个任务的资源、提交要求、过关考题进行完整配置。

**功能点**  
1. 任务基本信息：名称、章节、难度、预计时长、教学目标、前置任务、关联知识点。  
2. 资源上传：支持视频（点播链接、上传文件）、作业指导书（PDF/Doc/在线文档链接）；可设置观看进度要求。  
3. 任务步骤与提交项：  
   - 多步骤编排，每步含说明、参考材料、提交要求。  
   - 提交类型：文本、图片、附件、链接、代码仓库、表单。  
   - 可设必交/选交、格式校验、文件大小限制。  
4. 过关考题配置：  
   - 选择题库题/新建题，可多题型混合。  
   - 设置题量、分值、随机顺序、题目提示。  
   - 通过条件（分数线/全部正确/关键题必对）、重试次数、冷却时间。  
5. 评分与权重：定义任务总分构成（过程提交/考题/课堂表现），用于成绩计算。  
6. 预览模式：以学生视角预览任务流程，确保逻辑正确。  
7. 版本控制：编辑历史可回滚，方便教师在不同学期复用。

### 3.3 发布与通知

**目标**：支持教师在上课前或课上灵活发放任务并通知学生。

**功能点**  
1. 发布方式：立即发布、定时发布、按班级/分组发布。  
2. 可见性设置：允许设置任务开放/截止时间、截止提醒、超时策略（允许迟交/扣分/不计分）。  
3. 推送通知：站内信、邮件、短信、企业微信/钉钉/QQ 群机器人。  
4. 课堂同步：实时展示当前闯关人数、完成率、榜单，用于课堂互动。  
5. 撤回与变更：发布后可撤回或更新内容（需记录通知与变更日志）。

### 3.4 学生任务中心

**目标**：为学生提供清晰的待办视图与友好闯关体验。

**功能点**  
1. 待办/已完成任务列表：按课程、截止时间排序，显示奖励与进度条。  
2. 任务详情页：包含资源播放、步骤说明、提交入口、过关卡入口、奖励预告。  
3. 资源学习体验：  
   - 视频播放器支持倍速、弹题、完成度记录。  
   - 文档阅读支持在线预览、重点标记。  
4. 过程提交：支持草稿保存、分步上传、附件多文件、在线编辑（富文本/表格）。  
5. 过关答题：计时器、题目导航、即时反馈，错题可查看解析（由教师配置是否开放）。  
6. 奖励与成果：闯关成功动画、获得经验值/徽章提示；任务详情显示星级与奖励历史。  
7. 复盘中心：汇总错题、未过关任务、教师点评；支持导出 PDF。

### 3.5 题库与判题

**目标**：提供可复用的题目资源与自动化评分能力。

**功能点**  
1. 题库结构：按课程、知识点、难度、题型管理；支持标签与版本。  
2. 题目编辑：图文混排、数学公式、代码高亮、附件题干；支持引用素材。  
3. 题目导入导出：Excel/Word 模板、QTI 标准；导出支持筛选。  
4. 判题引擎：  
   - 客观题自动判分即刻反馈。  
   - B/S 架构编程题评测（可选），支持样例/多语言。  
   - 主观题提供评分 Rubric、批注、语音评价、AI 辅助建议（可选）。  
5. 题目分析：统计正确率、区分度、难度系数，反哺教师优化。  
6. 题目引用跟踪：显示题目被哪些任务使用，修改需评估影响。

### 3.6 激励系统

**目标**：通过多层奖励机制提升学生参与度。

**功能点**  
1. 经验与等级：任务完成获得经验，根据难度和表现动态计算；等级解锁称号或皮肤。  
2. 积分与商城（可选）：积分可兑换虚拟物品、课堂特权（免答一次等）。  
3. 徽章体系：按行为（准时提交、助人、满分等）自动颁发，可配置规则。  
4. 关卡星级：依据完成质量/用时判定 1-3 星，影响章节宝箱。  
5. 排行榜：  
   - 个人榜：按积分/经验/星级等指标；可按班级或课程。  
   - 小组榜：支持团队积分累计。  
6. 成就故事线：在课程主页展示学生闯关旅程，增强沉浸感。  
7. 奖励管理后台：教师可调节奖励权重、设置活动（限时加成、节日活动）。

### 3.7 数据分析

**目标**：帮助教师与管理者掌握过程数据并做出干预。

**功能点**  
1. 仪表盘：课程级完成率、平均用时、任务热力、知识点薄弱排名。  
2. 班级画像：学生参与度分布、成绩分层、预警名单（未登录、未交、低分）。  
3. 任务漏斗：浏览 → 提交 → 过关各阶段转化率。  
4. 题目表现：正确率、平均得分、错答TOPN。  
5. 学生个人报告：时间轴、成绩趋势、奖励记录、老师反馈。  
6. 导出与 API：支持 CSV/Excel 导出、对接学校 BI。  
7. 告警策略：达到触发条件（如超过 48h 未提交）自动推送提醒。

### 3.8 系统管理

**目标**：保障平台安全、稳定、可运维。

**功能点**  
1. 用户与角色管理：创建账号、分配角色、设置课程访问范围。  
2. 权限策略：细粒度接口权限、数据访问控制、审核流程。  
3. 资源审核：教学资源（视频/文档）上线前的审核流程。  
4. 题库模板维护：公共题库配置、审核、发布。  
5. SSO 与第三方集成：配置校园统一认证、教务课表同步、消息网关。  
6. 日志与监控：操作日志、系统告警、审计报表。  
7. 参数配置：奖励系数、系统文案、公告位、活动配置。

## 4. 关键业务流程

1. **教师建课与任务规划流程**  
   - 新建课程 → 绑定班级 → 创建任务（配置资源、提交项、考题）→ 预览 → 保存为草稿/模板。  
2. **任务发布与课堂执行流程**  
   - 在“任务发布”面板选择任务 → 设置发布时间与可见范围 → 推送通知 → 学生收到待办并执行 → 教师实时查看课堂仪表盘。  
3. **学生闯关流程**  
   - 进入任务详情 → 学习资源（系统记录进度）→ 按步骤提交材料（可多次保存）→ 进入过关题 → 即时判分/重试 → 获得奖励 → 留存复盘。  
4. **评分与反馈流程**  
   - 客观题系统判分 → 主观题教师批改 → 系统合成总分 → 发布成绩及反馈 → 学生收到通知并查看点评。  
5. **数据与预警流程**  
   - 数据埋点 → 指标计算 → 仪表盘展示 → 告警触发（如连续两次不过关）→ 教师收到提醒并跟进。

## 5. 数据结构与接口要点（概要）

- **核心表**：课程、班级、课程班级关系、任务、任务步骤、任务资源、任务提交、任务考题、考题题干、题目解析、学生任务记录、奖励记录、经验等级、排行榜快照。  
- **接口示例**：  
  - `POST /courses` 创建课程；`PUT /courses/{id}` 更新；`GET /courses/{id}/tasks` 获取任务。  
  - `POST /tasks/{id}/publish` 发布任务；`POST /tasks/{id}/submissions` 提交过程材料。  
  - `POST /assessments/grade` 判题评分；`GET /students/{id}/reports` 学生报告。  
- **数据一致性**：任务发布需事务处理（任务状态、通知、可见范围同步）；奖励发放与经验计算需幂等处理。

## 6. 体验与可用性要求

- UI 保持“闯关”主题视觉，色彩活泼但不干扰教学；支持深色模式。  
- 学生端支持移动端 H5，关键操作（提交、答题）需断点续传、防止误关闭。  
- 视频与文档加载提供占位提示，失败时给出重试与联系老师渠道。  
- 所有关键节点（提交、判题、奖励）提供清晰反馈和操作日志。

## 7. 非功能性补充

- **性能**：课堂集中访问场景支持至少 500+ 并发学生，关键接口响应 < 2s。  
- **可用性**：任务数据与提交物提供 7×24 小时可用保障；支持定期备份与版本留存。  
- **安全**：作业提交加密存储，题目访问控制，防止作弊（题目乱序、题库切换、IP 监控）。  
- **可扩展**：激励、题库、任务模块均需支持插件化/配置化，方便后续迭代。

## 8. 推进建议

1. 基于本设计输出低保真原型，验证教师/学生端主要流程。  
2. 定义 MVP 范围（建议优先实现课程-任务-发布-答题闭环 + 基础激励 + 数据看板）。  
3. 组织试点课程，对任务配置、奖励策略进行验证并迭代。  
4. 逐步扩展高级功能（活动、副本任务、AI 题目）并强化运营手段。


