# 社交协作模块实现说明

## 概述

社交协作模块包含三个核心功能：小队系统、助攻中心和班级大厅，旨在增强学生之间的协作与互动，提升学习体验。

## 一、小队系统

### 功能特性
- **小队创建**：学生可以创建小队，设置名称、描述、最大成员数
- **加入/退出**：学生可以加入或退出小队
- **成员管理**：支持成员角色（队长、成员）、贡献值统计
- **小队解散**：队长退出时自动转移或解散小队

### 数据模型
- `Team`: 小队基本信息（课程ID、名称、描述、创建者、状态等）
- `TeamMember`: 小队成员关系（角色、贡献值）

### API 接口
- `POST /api/v1/teams` - 创建小队
- `GET /api/v1/teams` - 获取小队列表（支持筛选）
- `GET /api/v1/teams/{id}` - 获取小队详情
- `PUT /api/v1/teams/{id}` - 更新小队信息
- `DELETE /api/v1/teams/{id}` - 解散小队
- `POST /api/v1/teams/{id}/join` - 加入小队
- `POST /api/v1/teams/{id}/leave` - 退出小队
- `GET /api/v1/teams/{id}/members` - 获取成员列表

### 前端页面
- `SquadHall.vue` - 小队大厅（列表、创建、加入）
- `CreateTeamModal.vue` - 创建小队弹窗

## 二、助攻中心

### 功能特性
- **发布求助**：学生可以发布求助，设置奖励经验值
- **响应求助**：其他学生可以响应求助，提供帮助
- **采纳响应**：求助者可以采纳响应，发放奖励
- **评价系统**：支持1-5星评价
- **统计功能**：显示求助和助攻统计数据

### 数据模型
- `AssistRequest`: 求助请求（任务ID、内容、类型、状态、奖励）
- `AssistRecord`: 助攻记录（响应内容、是否采纳、奖励、评价）

### API 接口
- `POST /api/v1/assist/requests` - 发布求助
- `GET /api/v1/assist/requests` - 获取求助列表
- `GET /api/v1/assist/requests/{id}` - 获取求助详情
- `POST /api/v1/assist/requests/{id}/respond` - 响应求助
- `POST /api/v1/assist/requests/{id}/accept` - 采纳响应
- `POST /api/v1/assist/requests/{id}/close` - 关闭求助
- `GET /api/v1/assist/my-requests` - 我的求助列表
- `GET /api/v1/assist/my-responses` - 我的助攻记录
- `GET /api/v1/assist/stats` - 助攻统计
- `POST /api/v1/assist/records/{id}/rate` - 评价响应

### 前端页面
- `AssistCenter.vue` - 助攻中心（全部求助、我的求助、我的助攻、统计）
- `AssistRequestList.vue` - 求助列表组件
- `AssistRecordList.vue` - 助攻记录列表组件
- `AssistStatsPanel.vue` - 统计面板组件
- `CreateAssistRequestModal.vue` - 创建求助弹窗

## 三、班级大厅

### 功能特性
- **动态发布**：学生可以发布动态（普通动态、成就分享、战报）
- **点赞功能**：支持点赞和取消点赞
- **评论系统**：支持评论和回复
- **公告管理**：教师可以发布公告（支持置顶、优先级）
- **统计展示**：显示动态和公告统计

### 数据模型
- `ClassFeed`: 班级动态（内容、类型、元数据、点赞数、评论数）
- `ClassAnnouncement`: 班级公告（标题、内容、置顶、优先级）
- `FeedLike`: 点赞记录
- `FeedComment`: 评论记录（支持回复）

### API 接口
- `POST /api/v1/class/{classId}/feeds` - 发布动态
- `GET /api/v1/class/{classId}/feeds` - 获取动态列表
- `GET /api/v1/class/{classId}/hall` - 获取班级大厅数据
- `POST /api/v1/class/{classId}/feeds/{id}/like` - 点赞动态
- `POST /api/v1/class/{classId}/feeds/{id}/unlike` - 取消点赞
- `POST /api/v1/class/{classId}/feeds/{id}/comments` - 添加评论
- `GET /api/v1/class/{classId}/feeds/{id}/comments` - 获取评论列表
- `POST /api/v1/class/{classId}/announcements` - 发布公告
- `GET /api/v1/class/{classId}/announcements` - 获取公告列表

### 前端页面
- `ClassHall.vue` - 班级大厅（动态流、公告、统计）
- `ClassFeedList.vue` - 动态列表组件
- `AnnouncementList.vue` - 公告列表组件
- `CreateFeedModal.vue` - 发布动态弹窗

## 技术实现

### 后端
- **服务层**：`TeamService`、`AssistService`、`ClassHallService`
- **数据访问**：使用 SQLAlchemy 2.0 语法（`select()` 替代 `.query()`）
- **数据验证**：使用 Pydantic 进行请求/响应验证

### 前端
- **API 客户端**：`team.ts`、`assist.ts`、`classHall.ts`
- **组件化设计**：可复用的列表、表单、统计组件
- **路由配置**：已添加到 Vue Router

### 测试
- 已添加基础 API 集成测试（`test_teams.py`、`test_assist.py`、`test_class_hall.py`）

## 注意事项

1. **认证集成**：当前 API 使用硬编码的 `user_id`，后续需要集成 JWT 认证
2. **权限控制**：部分操作（如发布公告）需要教师权限，需要添加权限校验
3. **实时通知**：可以考虑使用 WebSocket 推送新动态、新求助等通知
4. **性能优化**：动态列表和评论列表支持分页，避免数据量过大

## 后续优化建议

1. 添加小队聊天功能
2. 实现助攻排行榜
3. 支持动态的图片/视频上传
4. 添加动态的转发功能
5. 实现更丰富的统计图表


